use correlation::*;




#[test]
fn pearson_int_2_0() {
	let x = vec![1.0,1.0];
	    let y = vec![0.0,0.0];
	    let r : f64 = f64::NAN;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_2_1() {
	let x = vec![1.0,0.0];
	    let y = vec![0.0,0.0];
	    let r : f64 = f64::NAN;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_2_2() {
	let x = vec![0.0,0.0];
	    let y = vec![0.0,0.0];
	    let r : f64 = f64::NAN;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_2_3() {
	let x = vec![1.0,1.0];
	    let y = vec![1.0,1.0];
	    let r : f64 = f64::NAN;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_2_4() {
	let x = vec![0.0,1.0];
	    let y = vec![0.0,1.0];
	    let r : f64 = 1.0;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn pearson_int_5_0() {
	let x = vec![0.0,3.0,1.0,2.0,0.0];
	    let y = vec![3.0,2.0,4.0,0.0,1.0];
	    let r : f64 = -0.24253562503633294;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_1() {
	let x = vec![2.0,2.0,4.0,4.0,0.0];
	    let y = vec![4.0,1.0,1.0,3.0,0.0];
	    let r : f64 = 0.40006613209931924;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_2() {
	let x = vec![0.0,4.0,4.0,3.0,1.0];
	    let y = vec![0.0,1.0,4.0,0.0,3.0];
	    let r : f64 = 0.28787878787878785;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_3() {
	let x = vec![2.0,3.0,3.0,1.0,4.0];
	    let y = vec![3.0,1.0,3.0,0.0,3.0];
	    let r : f64 = 0.6201736729460421;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_4() {
	let x = vec![4.0,0.0,1.0,4.0,4.0];
	    let y = vec![3.0,1.0,4.0,3.0,4.0];
	    let r : f64 = 0.5235673853646193;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_5() {
	let x = vec![0.0,4.0,0.0,3.0,4.0];
	    let y = vec![0.0,4.0,0.0,1.0,1.0];
	    let r : f64 = 0.727544491872711;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_6() {
	let x = vec![4.0,4.0,3.0,2.0,3.0];
	    let y = vec![3.0,4.0,0.0,2.0,3.0];
	    let r : f64 = 0.5122717640554154;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_7() {
	let x = vec![2.0,4.0,4.0,4.0,1.0];
	    let y = vec![3.0,4.0,0.0,0.0,1.0];
	    let r : f64 = -0.09731236802019033;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_8() {
	let x = vec![0.0,3.0,1.0,1.0,1.0];
	    let y = vec![1.0,3.0,2.0,4.0,4.0];
	    let r : f64 = 0.38507702310770275;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_5_9() {
	let x = vec![3.0,2.0,0.0,0.0,4.0];
	    let y = vec![4.0,0.0,4.0,4.0,3.0];
	    let r : f64 = -0.2420614591379635;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn pearson_int_50_0() {
	let x = vec![22.0,38.0,14.0,48.0,26.0,36.0,21.0,14.0,4.0,8.0,31.0,5.0,24.0,9.0,1.0,33.0,28.0,18.0,3.0,6.0,5.0,0.0,34.0,25.0,10.0,18.0,25.0,30.0,2.0,21.0,24.0,40.0,19.0,37.0,5.0,43.0,20.0,7.0,41.0,1.0,18.0,6.0,17.0,36.0,31.0,25.0,31.0,28.0,23.0,9.0];
	    let y = vec![16.0,26.0,1.0,46.0,28.0,1.0,44.0,5.0,41.0,2.0,23.0,42.0,21.0,32.0,17.0,44.0,0.0,14.0,7.0,11.0,0.0,11.0,45.0,44.0,15.0,9.0,31.0,37.0,45.0,0.0,6.0,42.0,18.0,40.0,17.0,48.0,15.0,36.0,34.0,37.0,9.0,8.0,19.0,49.0,30.0,49.0,25.0,9.0,29.0,27.0];
	    let r : f64 = 0.3500500459615627;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_1() {
	let x = vec![12.0,33.0,23.0,43.0,44.0,35.0,40.0,17.0,4.0,28.0,40.0,9.0,23.0,21.0,20.0,40.0,25.0,19.0,47.0,38.0,48.0,17.0,24.0,35.0,17.0,32.0,0.0,28.0,15.0,40.0,5.0,22.0,32.0,23.0,19.0,8.0,7.0,27.0,26.0,32.0,40.0,18.0,32.0,27.0,37.0,21.0,21.0,28.0,19.0,43.0];
	    let y = vec![26.0,32.0,18.0,19.0,16.0,14.0,17.0,49.0,4.0,19.0,5.0,16.0,44.0,23.0,28.0,34.0,15.0,34.0,11.0,43.0,36.0,20.0,20.0,37.0,38.0,48.0,21.0,22.0,36.0,16.0,13.0,32.0,7.0,12.0,33.0,41.0,36.0,15.0,15.0,0.0,35.0,41.0,33.0,22.0,17.0,28.0,1.0,16.0,26.0,17.0];
	    let r : f64 = -0.10365453111376863;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_2() {
	let x = vec![26.0,24.0,9.0,20.0,6.0,3.0,14.0,30.0,49.0,12.0,42.0,37.0,26.0,17.0,33.0,26.0,39.0,29.0,34.0,43.0,21.0,15.0,1.0,24.0,28.0,11.0,17.0,29.0,7.0,4.0,13.0,11.0,5.0,39.0,48.0,45.0,6.0,21.0,19.0,35.0,46.0,14.0,25.0,37.0,9.0,21.0,43.0,14.0,34.0,30.0];
	    let y = vec![40.0,16.0,35.0,7.0,14.0,17.0,42.0,7.0,2.0,18.0,47.0,29.0,22.0,5.0,23.0,45.0,35.0,10.0,34.0,5.0,17.0,31.0,9.0,12.0,0.0,34.0,11.0,28.0,14.0,34.0,36.0,44.0,5.0,18.0,23.0,12.0,2.0,14.0,40.0,14.0,48.0,7.0,31.0,48.0,18.0,34.0,49.0,44.0,2.0,36.0];
	    let r : f64 = 0.11948395963308003;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_3() {
	let x = vec![14.0,19.0,13.0,17.0,32.0,13.0,15.0,14.0,36.0,38.0,38.0,38.0,25.0,27.0,3.0,18.0,31.0,17.0,24.0,36.0,14.0,11.0,20.0,7.0,9.0,12.0,20.0,33.0,19.0,42.0,41.0,29.0,39.0,8.0,2.0,44.0,31.0,34.0,10.0,35.0,35.0,17.0,35.0,7.0,5.0,1.0,27.0,26.0,32.0,31.0];
	    let y = vec![17.0,18.0,36.0,31.0,19.0,36.0,26.0,40.0,20.0,0.0,42.0,16.0,45.0,10.0,26.0,38.0,23.0,42.0,5.0,26.0,25.0,6.0,42.0,36.0,4.0,44.0,10.0,25.0,31.0,28.0,3.0,35.0,20.0,41.0,43.0,9.0,11.0,36.0,28.0,0.0,21.0,35.0,20.0,10.0,20.0,32.0,23.0,11.0,19.0,17.0];
	    let r : f64 = -0.3415000633204665;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_4() {
	let x = vec![41.0,16.0,0.0,29.0,6.0,49.0,33.0,38.0,2.0,40.0,3.0,21.0,21.0,0.0,21.0,26.0,44.0,47.0,42.0,10.0,16.0,21.0,11.0,17.0,16.0,24.0,22.0,6.0,26.0,5.0,18.0,29.0,9.0,8.0,27.0,19.0,19.0,48.0,40.0,26.0,29.0,36.0,43.0,24.0,39.0,7.0,42.0,18.0,38.0,12.0];
	    let y = vec![39.0,10.0,1.0,38.0,37.0,23.0,31.0,21.0,19.0,28.0,41.0,6.0,26.0,27.0,44.0,1.0,4.0,30.0,16.0,31.0,15.0,41.0,17.0,46.0,15.0,47.0,16.0,39.0,27.0,35.0,47.0,44.0,16.0,40.0,0.0,11.0,25.0,36.0,19.0,21.0,41.0,40.0,8.0,16.0,49.0,20.0,43.0,9.0,6.0,14.0];
	    let r : f64 = 0.026785180722315408;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_5() {
	let x = vec![42.0,24.0,15.0,22.0,11.0,45.0,38.0,38.0,32.0,0.0,39.0,30.0,0.0,28.0,40.0,15.0,5.0,28.0,4.0,5.0,29.0,33.0,2.0,32.0,2.0,11.0,10.0,11.0,0.0,4.0,10.0,30.0,30.0,36.0,10.0,18.0,33.0,36.0,49.0,4.0,30.0,37.0,7.0,46.0,32.0,49.0,20.0,20.0,26.0,22.0];
	    let y = vec![30.0,29.0,10.0,19.0,1.0,1.0,31.0,31.0,44.0,40.0,0.0,49.0,15.0,16.0,8.0,44.0,49.0,8.0,15.0,3.0,45.0,1.0,38.0,25.0,32.0,22.0,27.0,30.0,29.0,4.0,20.0,0.0,40.0,27.0,5.0,7.0,39.0,3.0,24.0,37.0,31.0,5.0,27.0,21.0,35.0,46.0,38.0,46.0,8.0,44.0];
	    let r : f64 = -0.05779798222058305;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_6() {
	let x = vec![3.0,12.0,36.0,13.0,24.0,20.0,18.0,19.0,3.0,23.0,15.0,5.0,42.0,35.0,44.0,17.0,1.0,39.0,16.0,15.0,43.0,33.0,11.0,24.0,41.0,20.0,33.0,20.0,14.0,44.0,29.0,3.0,15.0,8.0,43.0,29.0,3.0,23.0,24.0,22.0,33.0,34.0,7.0,36.0,24.0,22.0,11.0,13.0,20.0,18.0];
	    let y = vec![36.0,28.0,4.0,38.0,45.0,22.0,24.0,19.0,42.0,1.0,14.0,22.0,32.0,43.0,15.0,8.0,33.0,47.0,11.0,13.0,5.0,0.0,27.0,27.0,0.0,15.0,23.0,8.0,31.0,46.0,5.0,37.0,34.0,37.0,28.0,38.0,4.0,8.0,13.0,13.0,9.0,28.0,35.0,47.0,13.0,20.0,2.0,44.0,12.0,26.0];
	    let r : f64 = -0.1053833376363236;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_7() {
	let x = vec![34.0,27.0,34.0,37.0,34.0,30.0,19.0,31.0,45.0,7.0,44.0,47.0,2.0,19.0,22.0,1.0,35.0,35.0,29.0,22.0,34.0,9.0,24.0,22.0,40.0,4.0,29.0,24.0,37.0,11.0,5.0,37.0,32.0,12.0,1.0,18.0,31.0,16.0,36.0,42.0,31.0,32.0,23.0,23.0,12.0,17.0,25.0,9.0,14.0,32.0];
	    let y = vec![26.0,21.0,27.0,38.0,3.0,33.0,21.0,42.0,47.0,28.0,10.0,14.0,30.0,42.0,30.0,41.0,33.0,14.0,44.0,31.0,22.0,20.0,46.0,26.0,24.0,45.0,7.0,31.0,30.0,49.0,29.0,31.0,47.0,33.0,16.0,46.0,23.0,48.0,33.0,38.0,34.0,8.0,31.0,28.0,36.0,31.0,20.0,19.0,45.0,44.0];
	    let r : f64 = -0.18785150239626486;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_8() {
	let x = vec![32.0,14.0,14.0,21.0,43.0,49.0,40.0,21.0,15.0,4.0,4.0,22.0,16.0,16.0,39.0,23.0,34.0,23.0,16.0,9.0,8.0,7.0,19.0,43.0,46.0,22.0,32.0,32.0,26.0,28.0,7.0,39.0,1.0,44.0,20.0,16.0,7.0,32.0,48.0,19.0,1.0,2.0,42.0,22.0,27.0,8.0,20.0,42.0,2.0,20.0];
	    let y = vec![26.0,48.0,42.0,20.0,1.0,8.0,22.0,24.0,22.0,39.0,5.0,48.0,25.0,34.0,48.0,7.0,0.0,0.0,28.0,12.0,14.0,4.0,16.0,10.0,16.0,22.0,47.0,17.0,11.0,11.0,15.0,4.0,22.0,17.0,10.0,10.0,0.0,44.0,14.0,17.0,13.0,38.0,3.0,48.0,11.0,27.0,40.0,4.0,13.0,0.0];
	    let r : f64 = -0.14579486204289924;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_50_9() {
	let x = vec![22.0,39.0,45.0,23.0,28.0,37.0,43.0,10.0,49.0,34.0,45.0,35.0,22.0,8.0,13.0,12.0,21.0,9.0,21.0,38.0,35.0,24.0,46.0,38.0,28.0,30.0,41.0,25.0,40.0,43.0,3.0,49.0,46.0,25.0,0.0,8.0,38.0,10.0,28.0,8.0,17.0,49.0,0.0,37.0,19.0,6.0,2.0,5.0,47.0,15.0];
	    let y = vec![45.0,7.0,18.0,24.0,44.0,46.0,10.0,49.0,25.0,40.0,7.0,19.0,17.0,9.0,18.0,1.0,29.0,31.0,37.0,49.0,42.0,32.0,14.0,10.0,29.0,30.0,47.0,8.0,20.0,3.0,8.0,42.0,24.0,28.0,10.0,30.0,26.0,26.0,2.0,43.0,4.0,29.0,22.0,41.0,28.0,2.0,25.0,19.0,12.0,23.0];
	    let r : f64 = 0.09275193036065783;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn pearson_int_200_0() {
	let x = vec![148.0,131.0,7.0,59.0,18.0,157.0,56.0,188.0,158.0,21.0,199.0,91.0,106.0,122.0,88.0,186.0,97.0,41.0,109.0,24.0,132.0,108.0,189.0,85.0,99.0,130.0,128.0,16.0,125.0,142.0,67.0,139.0,150.0,197.0,93.0,24.0,68.0,71.0,108.0,97.0,55.0,115.0,63.0,108.0,70.0,121.0,129.0,175.0,9.0,167.0,53.0,163.0,104.0,185.0,32.0,165.0,61.0,105.0,3.0,179.0,37.0,63.0,5.0,35.0,168.0,40.0,144.0,44.0,28.0,181.0,33.0,50.0,164.0,81.0,114.0,162.0,143.0,71.0,102.0,19.0,153.0,153.0,41.0,139.0,195.0,43.0,45.0,113.0,154.0,118.0,95.0,66.0,89.0,146.0,184.0,45.0,83.0,94.0,33.0,40.0,162.0,112.0,195.0,151.0,145.0,128.0,187.0,102.0,24.0,58.0,73.0,187.0,54.0,176.0,129.0,170.0,7.0,102.0,109.0,118.0,23.0,83.0,91.0,176.0,106.0,16.0,71.0,138.0,131.0,111.0,88.0,154.0,43.0,134.0,12.0,140.0,150.0,15.0,162.0,194.0,192.0,34.0,98.0,189.0,2.0,146.0,147.0,29.0,164.0,134.0,39.0,115.0,150.0,193.0,72.0,196.0,152.0,171.0,82.0,47.0,78.0,105.0,68.0,31.0,8.0,80.0,106.0,132.0,176.0,6.0,170.0,73.0,47.0,127.0,84.0,109.0,192.0,163.0,116.0,70.0,116.0,181.0,142.0,95.0,48.0,193.0,61.0,38.0,187.0,130.0,168.0,196.0,54.0,131.0,27.0,172.0,76.0,3.0,151.0,196.0];
	    let y = vec![76.0,150.0,45.0,154.0,145.0,116.0,149.0,187.0,177.0,166.0,47.0,28.0,169.0,146.0,68.0,125.0,83.0,163.0,165.0,43.0,142.0,199.0,164.0,23.0,49.0,110.0,125.0,71.0,56.0,130.0,79.0,41.0,121.0,170.0,34.0,19.0,84.0,10.0,167.0,158.0,89.0,151.0,107.0,50.0,5.0,184.0,181.0,21.0,31.0,37.0,192.0,56.0,185.0,158.0,139.0,0.0,52.0,40.0,116.0,68.0,146.0,176.0,68.0,106.0,28.0,81.0,129.0,142.0,163.0,76.0,151.0,153.0,139.0,171.0,147.0,65.0,188.0,60.0,98.0,11.0,112.0,110.0,36.0,165.0,138.0,162.0,91.0,73.0,134.0,77.0,44.0,155.0,58.0,34.0,129.0,125.0,50.0,33.0,143.0,16.0,59.0,61.0,112.0,197.0,171.0,194.0,130.0,163.0,161.0,67.0,86.0,137.0,40.0,156.0,123.0,191.0,31.0,110.0,88.0,179.0,141.0,190.0,37.0,9.0,97.0,69.0,166.0,133.0,186.0,176.0,195.0,43.0,47.0,153.0,125.0,126.0,110.0,109.0,130.0,171.0,52.0,86.0,160.0,173.0,18.0,17.0,168.0,139.0,113.0,113.0,102.0,120.0,170.0,124.0,192.0,46.0,29.0,152.0,97.0,17.0,51.0,38.0,135.0,17.0,132.0,172.0,17.0,55.0,82.0,170.0,109.0,75.0,189.0,88.0,5.0,0.0,75.0,59.0,94.0,13.0,110.0,166.0,193.0,88.0,67.0,37.0,32.0,75.0,76.0,136.0,75.0,195.0,184.0,191.0,7.0,86.0,34.0,164.0,101.0,95.0];
	    let r : f64 = 0.10844666026921379;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_1() {
	let x = vec![170.0,178.0,59.0,52.0,62.0,126.0,114.0,130.0,148.0,64.0,123.0,109.0,69.0,96.0,50.0,49.0,116.0,2.0,77.0,146.0,69.0,64.0,16.0,13.0,58.0,114.0,136.0,161.0,199.0,29.0,85.0,150.0,24.0,4.0,135.0,61.0,62.0,188.0,38.0,132.0,20.0,79.0,18.0,151.0,147.0,111.0,12.0,123.0,92.0,18.0,193.0,0.0,193.0,2.0,62.0,166.0,29.0,159.0,195.0,59.0,1.0,49.0,115.0,21.0,1.0,121.0,50.0,39.0,11.0,50.0,13.0,170.0,134.0,154.0,181.0,64.0,87.0,159.0,74.0,170.0,64.0,29.0,79.0,142.0,133.0,147.0,32.0,89.0,66.0,19.0,97.0,95.0,100.0,185.0,8.0,31.0,137.0,152.0,102.0,149.0,17.0,97.0,103.0,55.0,20.0,3.0,46.0,27.0,1.0,184.0,76.0,75.0,49.0,71.0,179.0,73.0,160.0,159.0,187.0,67.0,10.0,9.0,189.0,147.0,70.0,53.0,179.0,115.0,98.0,176.0,86.0,94.0,27.0,97.0,106.0,161.0,136.0,184.0,35.0,148.0,128.0,166.0,83.0,68.0,76.0,93.0,122.0,104.0,28.0,129.0,132.0,23.0,145.0,129.0,45.0,50.0,195.0,111.0,3.0,41.0,172.0,141.0,120.0,57.0,31.0,7.0,181.0,78.0,150.0,116.0,16.0,106.0,121.0,88.0,145.0,102.0,64.0,17.0,8.0,93.0,118.0,132.0,9.0,103.0,25.0,15.0,23.0,157.0,73.0,139.0,38.0,62.0,120.0,116.0,196.0,128.0,118.0,131.0,167.0,103.0];
	    let y = vec![77.0,1.0,156.0,150.0,2.0,128.0,117.0,140.0,154.0,3.0,96.0,99.0,61.0,194.0,10.0,162.0,185.0,145.0,105.0,110.0,8.0,49.0,163.0,183.0,54.0,50.0,108.0,40.0,59.0,5.0,73.0,87.0,149.0,73.0,85.0,180.0,67.0,152.0,178.0,40.0,172.0,15.0,41.0,144.0,114.0,116.0,72.0,134.0,102.0,182.0,189.0,181.0,51.0,185.0,75.0,17.0,133.0,81.0,154.0,134.0,75.0,7.0,42.0,88.0,47.0,77.0,3.0,29.0,187.0,58.0,3.0,129.0,61.0,58.0,25.0,126.0,194.0,176.0,108.0,60.0,114.0,29.0,163.0,197.0,36.0,63.0,135.0,113.0,80.0,142.0,124.0,168.0,191.0,91.0,150.0,42.0,154.0,46.0,14.0,25.0,156.0,94.0,148.0,115.0,184.0,162.0,176.0,45.0,87.0,143.0,21.0,45.0,122.0,167.0,131.0,97.0,58.0,26.0,163.0,13.0,50.0,179.0,9.0,199.0,176.0,133.0,18.0,180.0,12.0,134.0,118.0,196.0,108.0,11.0,175.0,164.0,128.0,122.0,11.0,157.0,2.0,123.0,150.0,26.0,80.0,27.0,186.0,181.0,43.0,101.0,108.0,43.0,54.0,55.0,3.0,70.0,18.0,66.0,68.0,28.0,64.0,101.0,23.0,89.0,114.0,11.0,177.0,65.0,171.0,54.0,39.0,61.0,52.0,35.0,199.0,21.0,31.0,174.0,80.0,177.0,33.0,6.0,66.0,111.0,62.0,188.0,153.0,55.0,157.0,165.0,131.0,84.0,133.0,92.0,196.0,4.0,163.0,171.0,108.0,72.0];
	    let r : f64 = -0.0027240861417235154;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_2() {
	let x = vec![23.0,74.0,0.0,167.0,129.0,110.0,29.0,187.0,15.0,107.0,104.0,37.0,189.0,3.0,35.0,148.0,51.0,115.0,170.0,155.0,111.0,144.0,81.0,115.0,197.0,167.0,121.0,163.0,162.0,54.0,138.0,50.0,70.0,117.0,193.0,83.0,29.0,60.0,117.0,40.0,159.0,7.0,155.0,29.0,34.0,87.0,53.0,157.0,86.0,89.0,178.0,2.0,3.0,161.0,193.0,151.0,70.0,40.0,2.0,198.0,26.0,115.0,169.0,126.0,14.0,125.0,124.0,46.0,124.0,114.0,48.0,34.0,166.0,88.0,103.0,134.0,83.0,178.0,99.0,133.0,99.0,195.0,96.0,12.0,51.0,35.0,67.0,172.0,162.0,56.0,102.0,140.0,79.0,135.0,60.0,138.0,184.0,39.0,62.0,103.0,45.0,97.0,68.0,133.0,49.0,112.0,129.0,31.0,25.0,17.0,131.0,23.0,0.0,89.0,128.0,113.0,199.0,112.0,88.0,57.0,127.0,52.0,144.0,180.0,168.0,139.0,40.0,16.0,85.0,32.0,154.0,42.0,85.0,23.0,128.0,116.0,185.0,6.0,111.0,96.0,134.0,70.0,154.0,60.0,143.0,192.0,133.0,99.0,193.0,139.0,151.0,187.0,186.0,133.0,142.0,69.0,178.0,34.0,48.0,1.0,30.0,130.0,136.0,37.0,125.0,111.0,68.0,112.0,143.0,185.0,60.0,176.0,183.0,5.0,64.0,84.0,9.0,62.0,93.0,160.0,146.0,55.0,109.0,147.0,191.0,168.0,117.0,61.0,7.0,187.0,143.0,95.0,126.0,47.0,75.0,16.0,36.0,183.0,9.0,80.0];
	    let y = vec![20.0,168.0,52.0,14.0,146.0,158.0,31.0,141.0,122.0,150.0,198.0,116.0,120.0,82.0,101.0,63.0,103.0,3.0,101.0,91.0,137.0,131.0,189.0,145.0,175.0,10.0,173.0,153.0,73.0,98.0,64.0,109.0,11.0,91.0,17.0,140.0,62.0,6.0,165.0,37.0,59.0,179.0,111.0,0.0,55.0,108.0,130.0,45.0,33.0,16.0,111.0,4.0,149.0,165.0,172.0,105.0,162.0,51.0,153.0,68.0,42.0,153.0,31.0,136.0,88.0,90.0,62.0,66.0,169.0,21.0,79.0,46.0,16.0,73.0,179.0,62.0,102.0,142.0,40.0,183.0,127.0,151.0,166.0,14.0,59.0,121.0,189.0,123.0,167.0,143.0,74.0,168.0,161.0,194.0,153.0,57.0,153.0,28.0,130.0,11.0,20.0,191.0,185.0,143.0,116.0,161.0,142.0,176.0,56.0,192.0,144.0,45.0,12.0,146.0,101.0,139.0,98.0,131.0,181.0,158.0,39.0,136.0,163.0,185.0,176.0,133.0,85.0,31.0,146.0,158.0,3.0,115.0,56.0,62.0,93.0,50.0,97.0,154.0,140.0,138.0,20.0,7.0,70.0,119.0,3.0,113.0,153.0,96.0,136.0,186.0,174.0,0.0,120.0,75.0,55.0,82.0,52.0,20.0,196.0,97.0,85.0,160.0,58.0,93.0,123.0,142.0,176.0,168.0,147.0,117.0,17.0,14.0,121.0,64.0,34.0,163.0,77.0,47.0,195.0,15.0,58.0,79.0,11.0,133.0,49.0,172.0,14.0,121.0,12.0,74.0,12.0,3.0,168.0,181.0,167.0,123.0,32.0,145.0,157.0,70.0];
	    let r : f64 = 0.10355848257124706;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_3() {
	let x = vec![170.0,185.0,164.0,100.0,199.0,194.0,129.0,58.0,77.0,24.0,71.0,110.0,89.0,63.0,39.0,116.0,35.0,179.0,1.0,80.0,57.0,53.0,111.0,156.0,7.0,54.0,49.0,58.0,28.0,128.0,124.0,63.0,67.0,105.0,174.0,111.0,196.0,113.0,16.0,138.0,74.0,99.0,133.0,128.0,23.0,134.0,118.0,116.0,199.0,143.0,141.0,181.0,124.0,160.0,42.0,179.0,121.0,115.0,150.0,22.0,163.0,35.0,62.0,182.0,24.0,6.0,42.0,121.0,78.0,159.0,79.0,157.0,15.0,164.0,93.0,117.0,195.0,101.0,156.0,2.0,101.0,116.0,35.0,94.0,172.0,87.0,170.0,70.0,73.0,35.0,114.0,132.0,32.0,12.0,38.0,188.0,73.0,79.0,141.0,119.0,192.0,22.0,174.0,108.0,4.0,177.0,183.0,121.0,24.0,145.0,178.0,137.0,53.0,87.0,117.0,140.0,71.0,112.0,112.0,187.0,179.0,195.0,88.0,7.0,21.0,25.0,39.0,187.0,199.0,53.0,127.0,92.0,147.0,128.0,52.0,110.0,101.0,78.0,72.0,112.0,1.0,25.0,101.0,6.0,119.0,194.0,5.0,118.0,67.0,34.0,170.0,184.0,60.0,38.0,12.0,84.0,73.0,44.0,164.0,90.0,176.0,61.0,25.0,188.0,138.0,166.0,64.0,54.0,136.0,44.0,4.0,11.0,88.0,0.0,81.0,52.0,150.0,35.0,197.0,60.0,177.0,128.0,12.0,35.0,110.0,7.0,149.0,108.0,140.0,0.0,128.0,15.0,6.0,138.0,195.0,130.0,26.0,179.0,23.0,111.0];
	    let y = vec![22.0,147.0,25.0,161.0,54.0,68.0,76.0,106.0,71.0,166.0,173.0,180.0,22.0,150.0,132.0,9.0,161.0,75.0,80.0,100.0,33.0,3.0,4.0,187.0,102.0,57.0,137.0,175.0,104.0,150.0,50.0,9.0,181.0,199.0,76.0,114.0,100.0,156.0,183.0,54.0,52.0,13.0,53.0,44.0,166.0,153.0,29.0,100.0,122.0,198.0,86.0,6.0,131.0,114.0,101.0,35.0,18.0,21.0,111.0,51.0,14.0,173.0,103.0,168.0,128.0,178.0,52.0,30.0,22.0,131.0,51.0,68.0,144.0,163.0,88.0,50.0,83.0,85.0,95.0,148.0,191.0,123.0,74.0,22.0,96.0,53.0,130.0,159.0,199.0,156.0,18.0,56.0,132.0,144.0,131.0,10.0,33.0,7.0,116.0,128.0,146.0,65.0,199.0,188.0,183.0,175.0,30.0,130.0,46.0,111.0,104.0,37.0,36.0,82.0,107.0,191.0,130.0,2.0,99.0,2.0,33.0,103.0,20.0,91.0,44.0,153.0,46.0,148.0,77.0,93.0,42.0,105.0,112.0,108.0,44.0,123.0,61.0,197.0,130.0,38.0,22.0,132.0,134.0,65.0,148.0,135.0,122.0,163.0,9.0,14.0,39.0,157.0,76.0,69.0,128.0,44.0,174.0,27.0,73.0,117.0,111.0,77.0,78.0,139.0,186.0,25.0,70.0,94.0,6.0,188.0,150.0,154.0,193.0,99.0,124.0,133.0,38.0,127.0,30.0,83.0,197.0,23.0,130.0,139.0,1.0,7.0,105.0,146.0,48.0,135.0,4.0,104.0,193.0,191.0,158.0,21.0,118.0,103.0,32.0,70.0];
	    let r : f64 = -0.1013478648251757;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_4() {
	let x = vec![83.0,9.0,55.0,34.0,140.0,163.0,146.0,74.0,168.0,55.0,58.0,46.0,0.0,7.0,6.0,186.0,172.0,66.0,18.0,108.0,123.0,188.0,129.0,59.0,81.0,132.0,9.0,107.0,194.0,140.0,176.0,143.0,10.0,46.0,114.0,31.0,130.0,88.0,155.0,15.0,16.0,40.0,76.0,193.0,143.0,76.0,194.0,191.0,191.0,77.0,15.0,25.0,128.0,19.0,22.0,40.0,151.0,36.0,81.0,162.0,69.0,97.0,47.0,24.0,103.0,133.0,88.0,138.0,95.0,132.0,156.0,13.0,152.0,42.0,185.0,148.0,178.0,25.0,97.0,168.0,58.0,177.0,162.0,140.0,193.0,48.0,36.0,184.0,14.0,2.0,55.0,15.0,108.0,171.0,45.0,23.0,171.0,15.0,64.0,165.0,102.0,33.0,118.0,141.0,127.0,77.0,28.0,46.0,180.0,17.0,22.0,139.0,30.0,6.0,124.0,144.0,121.0,141.0,126.0,61.0,179.0,35.0,4.0,178.0,53.0,19.0,15.0,101.0,194.0,132.0,162.0,155.0,176.0,31.0,84.0,192.0,117.0,125.0,23.0,15.0,121.0,4.0,12.0,60.0,57.0,172.0,158.0,59.0,0.0,147.0,41.0,1.0,127.0,145.0,186.0,164.0,59.0,50.0,145.0,178.0,175.0,128.0,112.0,191.0,89.0,29.0,108.0,99.0,29.0,5.0,113.0,21.0,117.0,105.0,70.0,162.0,56.0,168.0,32.0,135.0,19.0,32.0,136.0,98.0,194.0,27.0,114.0,2.0,11.0,33.0,163.0,136.0,122.0,131.0,60.0,199.0,65.0,194.0,46.0,151.0];
	    let y = vec![110.0,75.0,139.0,96.0,57.0,139.0,51.0,2.0,99.0,17.0,159.0,33.0,196.0,70.0,103.0,17.0,59.0,77.0,105.0,162.0,91.0,141.0,115.0,165.0,94.0,100.0,76.0,110.0,139.0,36.0,13.0,179.0,174.0,72.0,123.0,112.0,40.0,122.0,160.0,82.0,179.0,157.0,68.0,41.0,39.0,94.0,132.0,16.0,8.0,84.0,149.0,5.0,76.0,28.0,156.0,177.0,155.0,194.0,89.0,199.0,100.0,100.0,45.0,53.0,14.0,99.0,72.0,18.0,159.0,43.0,163.0,104.0,190.0,106.0,82.0,74.0,93.0,65.0,15.0,64.0,64.0,195.0,160.0,29.0,174.0,49.0,69.0,73.0,41.0,127.0,153.0,129.0,44.0,157.0,138.0,13.0,168.0,58.0,50.0,160.0,82.0,56.0,37.0,160.0,58.0,65.0,43.0,136.0,56.0,91.0,87.0,135.0,100.0,3.0,49.0,4.0,76.0,167.0,23.0,153.0,140.0,71.0,144.0,58.0,143.0,134.0,190.0,137.0,18.0,163.0,125.0,199.0,197.0,145.0,152.0,196.0,1.0,136.0,73.0,4.0,41.0,197.0,106.0,39.0,43.0,41.0,4.0,6.0,83.0,187.0,96.0,62.0,163.0,167.0,104.0,199.0,94.0,89.0,36.0,125.0,167.0,151.0,106.0,25.0,43.0,31.0,49.0,132.0,165.0,33.0,57.0,58.0,80.0,91.0,44.0,28.0,139.0,185.0,77.0,55.0,161.0,186.0,153.0,165.0,124.0,47.0,35.0,100.0,35.0,94.0,39.0,121.0,20.0,199.0,22.0,66.0,4.0,119.0,54.0,59.0];
	    let r : f64 = 0.060731731876889156;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_5() {
	let x = vec![158.0,199.0,56.0,116.0,179.0,164.0,16.0,134.0,187.0,163.0,58.0,71.0,128.0,92.0,46.0,162.0,114.0,132.0,12.0,8.0,46.0,57.0,198.0,122.0,84.0,146.0,24.0,25.0,50.0,123.0,4.0,125.0,75.0,157.0,186.0,12.0,38.0,9.0,97.0,56.0,117.0,116.0,97.0,142.0,88.0,82.0,142.0,35.0,55.0,146.0,187.0,160.0,185.0,117.0,166.0,150.0,145.0,42.0,77.0,103.0,56.0,68.0,31.0,31.0,159.0,134.0,37.0,167.0,187.0,143.0,105.0,68.0,177.0,164.0,114.0,127.0,167.0,140.0,35.0,21.0,94.0,15.0,174.0,167.0,24.0,149.0,138.0,186.0,47.0,11.0,6.0,146.0,155.0,100.0,136.0,31.0,41.0,184.0,167.0,106.0,154.0,86.0,98.0,198.0,55.0,96.0,21.0,56.0,156.0,31.0,161.0,1.0,127.0,188.0,64.0,70.0,8.0,119.0,92.0,61.0,61.0,2.0,176.0,123.0,67.0,76.0,27.0,79.0,149.0,8.0,106.0,37.0,125.0,88.0,87.0,60.0,192.0,49.0,54.0,15.0,59.0,156.0,151.0,90.0,175.0,44.0,122.0,61.0,135.0,83.0,1.0,22.0,36.0,160.0,38.0,89.0,57.0,105.0,67.0,19.0,1.0,168.0,3.0,171.0,64.0,155.0,17.0,11.0,105.0,114.0,198.0,59.0,62.0,182.0,6.0,88.0,163.0,69.0,151.0,181.0,159.0,49.0,70.0,156.0,186.0,16.0,78.0,198.0,7.0,63.0,194.0,143.0,89.0,172.0,172.0,89.0,4.0,73.0,38.0,197.0];
	    let y = vec![173.0,93.0,149.0,174.0,140.0,25.0,187.0,65.0,197.0,79.0,181.0,170.0,197.0,22.0,150.0,99.0,178.0,6.0,163.0,116.0,86.0,16.0,16.0,142.0,192.0,99.0,175.0,77.0,4.0,158.0,60.0,74.0,69.0,78.0,114.0,140.0,184.0,97.0,148.0,21.0,22.0,99.0,26.0,122.0,33.0,6.0,107.0,133.0,93.0,144.0,85.0,62.0,162.0,14.0,104.0,153.0,61.0,56.0,164.0,112.0,145.0,176.0,8.0,29.0,35.0,108.0,185.0,38.0,136.0,82.0,98.0,27.0,27.0,180.0,71.0,144.0,79.0,71.0,0.0,73.0,89.0,110.0,195.0,39.0,131.0,190.0,9.0,164.0,165.0,36.0,5.0,115.0,165.0,42.0,57.0,36.0,196.0,179.0,24.0,22.0,25.0,66.0,127.0,37.0,85.0,58.0,38.0,63.0,102.0,50.0,97.0,51.0,40.0,97.0,94.0,2.0,66.0,161.0,55.0,96.0,188.0,155.0,126.0,128.0,89.0,113.0,99.0,143.0,152.0,172.0,6.0,4.0,186.0,53.0,35.0,196.0,171.0,0.0,85.0,23.0,122.0,125.0,138.0,160.0,67.0,178.0,64.0,34.0,83.0,129.0,76.0,68.0,67.0,3.0,70.0,180.0,7.0,183.0,166.0,99.0,97.0,165.0,137.0,64.0,181.0,166.0,92.0,169.0,177.0,59.0,28.0,151.0,99.0,198.0,146.0,163.0,145.0,135.0,99.0,139.0,139.0,143.0,72.0,87.0,110.0,193.0,35.0,152.0,48.0,4.0,152.0,12.0,183.0,190.0,188.0,118.0,183.0,10.0,93.0,78.0];
	    let r : f64 = 0.06320559796991435;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_6() {
	let x = vec![4.0,44.0,168.0,124.0,163.0,92.0,196.0,138.0,176.0,41.0,159.0,137.0,179.0,12.0,106.0,172.0,92.0,60.0,109.0,130.0,149.0,123.0,119.0,141.0,24.0,80.0,8.0,176.0,137.0,80.0,2.0,20.0,48.0,178.0,112.0,159.0,65.0,39.0,170.0,165.0,141.0,115.0,22.0,185.0,171.0,171.0,194.0,113.0,43.0,143.0,115.0,14.0,55.0,152.0,73.0,13.0,172.0,199.0,98.0,79.0,21.0,184.0,61.0,110.0,23.0,191.0,86.0,155.0,94.0,81.0,53.0,60.0,169.0,173.0,129.0,52.0,102.0,18.0,162.0,18.0,129.0,39.0,93.0,126.0,135.0,30.0,103.0,87.0,145.0,104.0,5.0,51.0,52.0,26.0,101.0,0.0,143.0,151.0,114.0,71.0,131.0,79.0,100.0,12.0,189.0,107.0,96.0,121.0,82.0,58.0,89.0,186.0,64.0,120.0,39.0,158.0,141.0,95.0,149.0,33.0,190.0,27.0,45.0,190.0,86.0,197.0,103.0,183.0,31.0,138.0,36.0,9.0,97.0,114.0,95.0,162.0,157.0,71.0,48.0,144.0,58.0,140.0,81.0,67.0,14.0,71.0,72.0,131.0,197.0,86.0,31.0,182.0,3.0,90.0,138.0,127.0,182.0,70.0,119.0,137.0,31.0,3.0,198.0,191.0,81.0,23.0,119.0,152.0,122.0,73.0,102.0,182.0,113.0,61.0,134.0,101.0,180.0,95.0,181.0,0.0,22.0,82.0,174.0,143.0,171.0,191.0,98.0,174.0,119.0,107.0,110.0,41.0,165.0,50.0,31.0,52.0,181.0,182.0,9.0,175.0];
	    let y = vec![97.0,151.0,55.0,178.0,194.0,141.0,147.0,48.0,199.0,31.0,46.0,89.0,52.0,52.0,56.0,145.0,193.0,199.0,93.0,106.0,33.0,8.0,142.0,46.0,40.0,34.0,135.0,128.0,125.0,30.0,150.0,24.0,194.0,99.0,186.0,154.0,156.0,186.0,178.0,160.0,71.0,129.0,185.0,5.0,163.0,114.0,147.0,29.0,12.0,72.0,105.0,171.0,64.0,91.0,54.0,54.0,64.0,156.0,83.0,142.0,16.0,22.0,199.0,18.0,39.0,91.0,164.0,86.0,174.0,176.0,3.0,132.0,182.0,68.0,99.0,105.0,63.0,75.0,6.0,5.0,147.0,188.0,13.0,119.0,101.0,145.0,35.0,149.0,151.0,67.0,121.0,47.0,25.0,3.0,135.0,102.0,110.0,62.0,114.0,16.0,134.0,38.0,83.0,17.0,50.0,187.0,173.0,147.0,39.0,130.0,150.0,72.0,175.0,176.0,92.0,53.0,52.0,153.0,133.0,17.0,97.0,167.0,194.0,9.0,19.0,11.0,64.0,168.0,44.0,26.0,122.0,22.0,10.0,151.0,159.0,180.0,85.0,145.0,126.0,193.0,66.0,8.0,17.0,2.0,27.0,116.0,121.0,38.0,0.0,180.0,91.0,2.0,56.0,128.0,142.0,30.0,184.0,132.0,12.0,22.0,58.0,102.0,33.0,18.0,140.0,185.0,173.0,35.0,148.0,189.0,33.0,151.0,186.0,68.0,114.0,173.0,179.0,121.0,93.0,1.0,105.0,138.0,142.0,184.0,9.0,97.0,123.0,109.0,60.0,66.0,67.0,190.0,92.0,109.0,86.0,195.0,47.0,82.0,135.0,154.0];
	    let r : f64 = 0.0035136964304974816;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_7() {
	let x = vec![159.0,13.0,193.0,56.0,24.0,167.0,118.0,38.0,59.0,22.0,134.0,0.0,143.0,181.0,59.0,95.0,196.0,154.0,165.0,155.0,113.0,73.0,146.0,140.0,196.0,66.0,182.0,32.0,1.0,23.0,8.0,172.0,63.0,114.0,102.0,91.0,166.0,197.0,164.0,18.0,65.0,3.0,144.0,182.0,59.0,48.0,111.0,121.0,161.0,56.0,183.0,66.0,178.0,4.0,139.0,159.0,126.0,32.0,15.0,79.0,45.0,144.0,159.0,106.0,68.0,183.0,164.0,150.0,120.0,88.0,105.0,138.0,7.0,151.0,178.0,121.0,23.0,19.0,118.0,110.0,163.0,39.0,147.0,75.0,4.0,154.0,182.0,146.0,98.0,185.0,43.0,164.0,71.0,11.0,150.0,68.0,169.0,43.0,171.0,60.0,75.0,98.0,54.0,167.0,96.0,74.0,7.0,6.0,40.0,115.0,66.0,135.0,139.0,65.0,162.0,19.0,145.0,76.0,89.0,122.0,68.0,52.0,189.0,143.0,130.0,178.0,98.0,114.0,33.0,137.0,176.0,175.0,2.0,64.0,127.0,175.0,73.0,66.0,61.0,164.0,185.0,67.0,158.0,121.0,7.0,103.0,11.0,93.0,180.0,35.0,15.0,118.0,113.0,58.0,117.0,168.0,129.0,123.0,145.0,67.0,189.0,133.0,51.0,199.0,90.0,121.0,42.0,11.0,84.0,189.0,176.0,79.0,128.0,185.0,86.0,192.0,44.0,118.0,157.0,43.0,124.0,23.0,167.0,134.0,68.0,144.0,83.0,61.0,11.0,35.0,18.0,46.0,51.0,10.0,149.0,79.0,37.0,90.0,60.0,160.0];
	    let y = vec![19.0,195.0,127.0,177.0,7.0,199.0,144.0,0.0,120.0,189.0,12.0,177.0,79.0,79.0,87.0,74.0,194.0,85.0,168.0,45.0,65.0,53.0,160.0,100.0,62.0,173.0,64.0,77.0,128.0,174.0,134.0,30.0,79.0,181.0,126.0,160.0,100.0,115.0,118.0,74.0,167.0,151.0,141.0,58.0,129.0,109.0,153.0,171.0,146.0,149.0,100.0,133.0,46.0,22.0,73.0,188.0,52.0,147.0,68.0,98.0,83.0,188.0,92.0,140.0,25.0,7.0,159.0,28.0,76.0,75.0,65.0,199.0,110.0,24.0,132.0,110.0,174.0,194.0,26.0,145.0,148.0,167.0,76.0,60.0,54.0,5.0,99.0,87.0,101.0,8.0,107.0,115.0,30.0,36.0,22.0,105.0,44.0,102.0,164.0,151.0,178.0,193.0,137.0,28.0,78.0,168.0,43.0,135.0,56.0,27.0,151.0,2.0,187.0,63.0,69.0,180.0,166.0,168.0,96.0,74.0,136.0,8.0,129.0,78.0,145.0,67.0,125.0,196.0,101.0,110.0,52.0,159.0,158.0,16.0,138.0,191.0,148.0,65.0,17.0,194.0,57.0,70.0,31.0,135.0,98.0,162.0,38.0,76.0,142.0,66.0,153.0,130.0,182.0,137.0,178.0,38.0,30.0,176.0,22.0,148.0,163.0,191.0,85.0,95.0,61.0,27.0,165.0,12.0,165.0,170.0,93.0,182.0,151.0,133.0,179.0,129.0,130.0,10.0,16.0,34.0,83.0,130.0,196.0,178.0,55.0,80.0,118.0,43.0,115.0,118.0,6.0,165.0,93.0,164.0,154.0,14.0,55.0,16.0,133.0,53.0];
	    let r : f64 = -0.031342408349630924;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_8() {
	let x = vec![144.0,156.0,27.0,103.0,113.0,158.0,166.0,122.0,39.0,138.0,32.0,34.0,30.0,76.0,139.0,22.0,35.0,170.0,152.0,83.0,40.0,97.0,165.0,16.0,63.0,40.0,13.0,75.0,187.0,133.0,102.0,54.0,110.0,139.0,152.0,197.0,15.0,198.0,131.0,3.0,118.0,3.0,29.0,74.0,41.0,104.0,176.0,22.0,68.0,188.0,95.0,164.0,119.0,86.0,94.0,3.0,1.0,10.0,93.0,148.0,80.0,65.0,177.0,197.0,148.0,156.0,15.0,186.0,46.0,95.0,86.0,110.0,119.0,120.0,113.0,163.0,76.0,196.0,143.0,149.0,144.0,123.0,138.0,77.0,190.0,45.0,181.0,198.0,21.0,118.0,61.0,152.0,142.0,67.0,105.0,126.0,1.0,161.0,99.0,7.0,38.0,79.0,184.0,117.0,161.0,101.0,136.0,183.0,136.0,71.0,179.0,175.0,70.0,5.0,157.0,100.0,83.0,124.0,37.0,0.0,126.0,71.0,123.0,76.0,121.0,62.0,140.0,63.0,96.0,101.0,76.0,81.0,165.0,145.0,93.0,176.0,5.0,12.0,39.0,145.0,48.0,105.0,114.0,67.0,196.0,52.0,194.0,49.0,106.0,27.0,137.0,6.0,55.0,61.0,23.0,19.0,97.0,114.0,27.0,28.0,12.0,113.0,117.0,156.0,136.0,115.0,12.0,39.0,176.0,197.0,183.0,189.0,110.0,90.0,60.0,46.0,45.0,184.0,166.0,73.0,117.0,70.0,34.0,169.0,113.0,101.0,155.0,29.0,107.0,105.0,110.0,94.0,47.0,55.0,70.0,130.0,105.0,84.0,23.0,86.0];
	    let y = vec![48.0,106.0,163.0,120.0,114.0,53.0,57.0,14.0,176.0,79.0,19.0,58.0,153.0,88.0,92.0,133.0,28.0,99.0,8.0,175.0,20.0,82.0,177.0,20.0,39.0,58.0,187.0,62.0,64.0,148.0,21.0,79.0,144.0,93.0,43.0,130.0,189.0,179.0,144.0,56.0,196.0,176.0,2.0,123.0,17.0,28.0,176.0,75.0,130.0,164.0,99.0,191.0,89.0,45.0,93.0,158.0,26.0,113.0,21.0,38.0,130.0,33.0,51.0,66.0,36.0,32.0,79.0,7.0,77.0,166.0,188.0,155.0,101.0,134.0,183.0,78.0,163.0,72.0,17.0,159.0,199.0,80.0,49.0,18.0,114.0,175.0,119.0,70.0,97.0,117.0,55.0,105.0,142.0,40.0,171.0,101.0,101.0,180.0,123.0,67.0,146.0,66.0,162.0,96.0,73.0,13.0,10.0,71.0,127.0,185.0,56.0,64.0,49.0,2.0,70.0,21.0,70.0,46.0,5.0,158.0,117.0,122.0,113.0,128.0,63.0,6.0,46.0,193.0,112.0,19.0,198.0,173.0,189.0,9.0,109.0,82.0,81.0,189.0,71.0,183.0,57.0,129.0,179.0,131.0,56.0,0.0,34.0,188.0,33.0,80.0,152.0,18.0,149.0,92.0,76.0,27.0,35.0,159.0,119.0,120.0,60.0,22.0,151.0,4.0,118.0,190.0,194.0,109.0,85.0,182.0,28.0,128.0,82.0,164.0,112.0,63.0,16.0,130.0,133.0,58.0,158.0,119.0,120.0,134.0,37.0,45.0,85.0,170.0,12.0,34.0,135.0,128.0,186.0,98.0,7.0,31.0,42.0,158.0,141.0,81.0];
	    let r : f64 = 0.002518862972386045;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_int_200_9() {
	let x = vec![60.0,119.0,43.0,140.0,188.0,168.0,87.0,136.0,190.0,131.0,70.0,169.0,35.0,68.0,5.0,107.0,137.0,131.0,6.0,10.0,90.0,192.0,5.0,1.0,91.0,185.0,106.0,99.0,38.0,154.0,148.0,196.0,111.0,123.0,44.0,167.0,0.0,45.0,170.0,79.0,62.0,198.0,42.0,60.0,168.0,160.0,121.0,134.0,9.0,99.0,24.0,140.0,61.0,80.0,18.0,180.0,115.0,121.0,11.0,138.0,43.0,77.0,10.0,69.0,157.0,97.0,157.0,69.0,72.0,158.0,23.0,141.0,33.0,196.0,165.0,157.0,54.0,26.0,46.0,198.0,40.0,192.0,169.0,181.0,172.0,173.0,7.0,92.0,105.0,165.0,19.0,161.0,7.0,130.0,57.0,159.0,67.0,178.0,64.0,79.0,157.0,41.0,111.0,66.0,144.0,33.0,11.0,157.0,82.0,83.0,37.0,167.0,145.0,147.0,71.0,144.0,118.0,177.0,155.0,82.0,87.0,165.0,106.0,98.0,24.0,113.0,17.0,33.0,106.0,163.0,173.0,18.0,1.0,110.0,127.0,99.0,0.0,56.0,5.0,98.0,180.0,6.0,193.0,104.0,124.0,74.0,25.0,9.0,126.0,91.0,159.0,194.0,16.0,198.0,7.0,107.0,145.0,135.0,162.0,106.0,89.0,138.0,132.0,41.0,33.0,196.0,76.0,24.0,153.0,123.0,12.0,43.0,62.0,17.0,176.0,96.0,126.0,5.0,174.0,120.0,48.0,183.0,26.0,21.0,158.0,32.0,67.0,147.0,84.0,73.0,161.0,92.0,69.0,75.0,118.0,78.0,64.0,74.0,56.0,133.0];
	    let y = vec![164.0,122.0,32.0,44.0,40.0,27.0,113.0,152.0,10.0,3.0,101.0,192.0,153.0,158.0,4.0,196.0,42.0,138.0,0.0,67.0,59.0,151.0,198.0,93.0,183.0,66.0,146.0,103.0,5.0,146.0,154.0,88.0,35.0,69.0,161.0,138.0,158.0,32.0,71.0,45.0,124.0,194.0,106.0,157.0,76.0,136.0,186.0,30.0,119.0,21.0,179.0,166.0,186.0,5.0,133.0,190.0,169.0,125.0,56.0,184.0,4.0,171.0,162.0,102.0,9.0,112.0,67.0,13.0,123.0,181.0,21.0,103.0,14.0,50.0,7.0,34.0,45.0,112.0,194.0,84.0,82.0,163.0,182.0,125.0,133.0,122.0,172.0,88.0,56.0,175.0,59.0,68.0,125.0,26.0,111.0,37.0,19.0,16.0,95.0,156.0,98.0,48.0,80.0,70.0,119.0,75.0,115.0,183.0,131.0,99.0,95.0,144.0,188.0,139.0,37.0,153.0,0.0,1.0,25.0,179.0,28.0,112.0,155.0,137.0,75.0,48.0,192.0,109.0,88.0,150.0,89.0,154.0,39.0,75.0,97.0,114.0,133.0,177.0,121.0,156.0,54.0,179.0,101.0,57.0,27.0,46.0,194.0,152.0,17.0,72.0,121.0,118.0,38.0,96.0,65.0,120.0,102.0,49.0,17.0,145.0,55.0,2.0,165.0,178.0,47.0,138.0,195.0,50.0,188.0,160.0,1.0,44.0,51.0,109.0,73.0,64.0,92.0,88.0,90.0,158.0,39.0,188.0,82.0,133.0,70.0,7.0,40.0,22.0,157.0,1.0,184.0,165.0,23.0,74.0,174.0,117.0,107.0,44.0,141.0,123.0];
	    let r : f64 = 0.039288839723661886;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn pearson_float_200_0() {
	let x = vec![0.33341075897073336,0.5773843827078096,0.4630634659216001,0.5585017084831249,0.4786060359418718,0.1786381475632065,0.4070647683035541,0.7621780594993128,0.07088435530643811,0.4191390635028309,0.4133383019586637,0.26341587676330613,0.44561779711419836,0.7580273549848946,0.5665613795476871,0.9377790128842727,0.4119214803953546,0.7956706624308655,0.3834473514380432,0.7031633406907298,0.7273458720884362,0.13442774056353002,0.21372467259339434,0.1799357645773314,0.0938337441833782,0.21263424032431377,0.09840838277560937,0.3974347412117103,0.7771216436216011,0.8673457946708862,0.4481131773040956,0.4375109851049547,0.2571692122411351,0.41820074591648204,0.765675225032326,0.17452122069764897,0.24322167156250485,0.8147947903363797,0.7088402439264769,0.4720378587096782,0.030551355746354925,0.2275818645037776,0.4358173339580024,0.9161166293560223,0.25669356999774484,0.7850325400399231,0.5384769112095938,0.2188235943873187,0.8717253437980208,0.1185711722584668,0.6579365558669288,0.07876793498211776,0.8726918113699247,0.5738037730894436,0.9362850188515426,0.25290199339065866,0.2720823606088604,0.15393565060960646,0.17272143061430278,0.5662255606499716,0.15975852422188896,0.285458745908858,0.0642670494348554,0.7169861103601786,0.9428671039240719,0.2297338523333161,0.6037196606573823,0.8009939509229539,0.4046031989509097,0.7225497199143438,0.5023843640231274,0.09104279214785793,0.6950765079659712,0.665094034957328,0.7756034163421948,0.57706398679476,0.9792382003564527,0.4639493021050958,0.49989946643794025,0.292508725018926,0.05620286537956953,0.10842927263261404,0.3418133317042743,0.8012980359850507,0.9297306389883456,0.5769018386066029,0.9634905233785869,0.9677487886275278,0.3322574904323067,0.12024971113504457,0.9387727898667733,0.2682778289358225,0.7820703975743476,0.5317692022176046,0.02833015836067565,0.47471953623368635,0.48935501281138793,0.97908211571301,0.9080852966993845,0.13357192968980813,0.6945229334571443,0.3212679467651651,0.3853087300697605,0.8097608648653605,0.6446811460643668,0.9718519877637285,0.5672792404348039,0.590353799973372,0.6409117946645811,0.10171191401923785,0.39857788008349493,0.37589188472519963,0.25154297060555153,0.27955968854365365,0.7100318941963775,0.7794301285169238,0.8017261836118754,0.4677243633700381,0.4913575327156696,0.8233036544037592,0.24209568756954125,0.19972141237049768,0.9671916738247481,0.1928151245765004,0.5243234850781923,0.5733671863101749,0.3815397696563615,0.2559264197447416,0.2872562923131754,0.6416092420975062,0.24636864085970445,0.8827657249683933,0.34640207244923604,0.8051825528030738,0.7483112158523592,0.7845556656135296,0.1656965117548751,0.06024213976573778,0.9207083072730256,0.07930412248171459,0.35547769262320095,0.5718134599320499,0.9138793684385506,0.18333306019208762,0.5173387655964282,0.940913292687889,0.8024561973021751,0.4081740838645992,0.48375810435903643,0.2759996838441824,0.46586734934622875,0.505552171159679,0.2722077439649906,0.5611311931971591,0.7358287280735766,0.09501091398366046,0.7042716949930552,0.6082081375754896,0.32760619104799915,0.31551028236831324,0.632956916522745,0.4184092067213008,0.37644945057165713,0.07386794815817266,0.7114194359535079,0.768983993132886,0.4206159827113799,0.39406950381095973,0.016866280568392233,7.16620267267043e-05,0.7942282947940604,0.7588845139549139,0.08223699391711936,0.7018397309993841,0.45813634921054436,0.10540838676033704,0.6866150807857084,0.3674144053612839,0.2246031270532911,0.389093052157639,0.398210668044213,0.5042919476566395,0.4753079082458198,0.3376348639482104,0.10851747643509824,0.3941553656234954,0.473718275712545,0.16259098124851445,0.7236773206086613,0.21713412317946967,0.5156277366422283,0.7690550332514642,0.8103958819967285,0.6031648063195767,0.2116391080516602,0.4265385387083316,0.2659597281674385,0.4430745523032479,0.2706004894402687,0.04041800950109431];
	    let y = vec![0.671044431271752,0.8909794004488218,0.36220926522956565,0.9833487911405819,0.0722578743841985,0.6308978266299887,0.05681365011591344,0.2925844585279911,0.9906146404017164,0.4202830300635645,0.7637336441522785,0.39656233042909117,0.2114716581127305,0.9475032820322037,0.2131887665423593,0.8971760130133801,0.20881961802057214,0.46925492943833946,0.7607309357570883,0.5452160723595079,0.15262547315066266,0.24754863335091148,0.8239068742352244,0.518563897481109,0.49174175077985494,0.2484626438989087,0.05937194541488866,0.6753691573457445,0.1462750692014585,0.2746123396578205,0.044863638836558084,0.8423669172241489,0.6577855027180176,0.15676910620479534,0.9885043214381619,0.016131112930806712,0.3564413543718793,0.012759800314297132,0.4710249026738741,0.2790941611607636,0.06950953690331141,0.8825915958250271,0.6551926805932035,0.8287930666045124,0.5000989996552955,0.5545746124002753,0.21200115300944367,0.710225310185654,0.8684945328651169,0.5027361052125455,0.7349110073801846,0.7128843092026536,0.954099437277846,0.8622083320663669,0.8657818953847506,0.4971698345526999,0.9121183524709073,0.13828387201396786,0.5619172633290819,0.48767877401414905,0.561648967872312,0.2682109478235375,0.8885011333642724,0.775541251490887,0.29864986168685637,0.7280474018199515,0.8217106140914592,0.23919080265305637,0.7715102469453363,0.8765368253176604,0.8867880522430289,0.2449302362510849,0.5170063969735569,0.038956495730404384,0.5896902277589524,0.1352244909080872,0.23631174457981707,0.21790646669454206,0.7735956112728829,0.298012188068984,0.17992223919880412,0.7725173146646396,0.18537917645915447,0.5018257899745012,0.12755746569693782,0.23864299674400968,0.5295090065211132,0.08172201226317843,0.14154411773586684,0.11262725825114228,0.4166255430967848,0.3778976660011457,0.650957814586812,0.44017864189635725,0.7850721855833991,0.09892989241563843,0.7845408431353065,0.6870094494352187,0.4944552954477559,0.28575035379321445,0.1318270648285037,0.17054673637759532,0.13712166814585824,0.5446221282437205,0.08330723348793612,0.14290067495751824,0.8955455977450458,0.81311695634361,0.2881911171699785,0.9258440150089084,0.3718161442078578,0.3111434319999222,0.17544343174795962,0.42988847415133447,0.38833813299469355,0.1702440867959022,0.7502697568861193,0.9330858062473243,0.8695853142297504,0.4932740724461644,0.7878437456938991,0.5194600143118763,0.9925980115812417,0.7915775596187314,0.021932514058095265,0.36593722104909887,0.4691968704972752,0.7310793426728162,0.3478871434552018,0.30235559819773816,0.8900833159521485,0.19874974482616026,0.5001940323091059,0.6185500333197659,0.3455309637420675,0.42217603024700023,0.5988875804525231,0.2776611669124194,0.16759335826948418,0.9629781363983808,0.8650045293590061,0.5165876970284233,0.5625558534205162,0.2156425245394148,0.06622962064611582,0.3641107857346557,0.8767889308413749,0.4827237500312316,0.28136704132952695,0.01645937789336993,0.26952135815872136,0.18091042196923934,0.25424298799283906,0.2705982763110818,0.2851408899177904,0.23465582967369913,0.979517005296215,0.5407255479743833,0.5290203062747729,0.6722812578776323,0.9733553356414547,0.16326606541854172,0.8925594980903582,0.030878615742439663,0.30456454046910664,0.102499748644303,0.06696429210512767,0.6289138212181212,0.6783001821440049,0.04930188749532194,0.22229739969755935,0.38569400071167903,0.25512692228629974,0.8669589758287606,0.41191814036950547,0.2174919313454754,0.9683828784459522,0.15755321695386937,0.17976754490460267,0.6321503672567481,0.061033847331132374,0.12915896816351902,0.1738363759277899,0.6771551575851714,0.21129011242892326,0.6814407613502713,0.9358715278668195,0.6763065605840956,0.8659712510388506,0.4441387737077147,0.5926375518079737,0.42797823990781625,0.21964271285455084,0.19957319280790442,0.0907361997879168,0.48273455683564037,0.6707180527982395,0.3464511121623277,0.4955570631979106,0.6562863820906054];
	    let r : f64 = 0.045628248330628826;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_1() {
	let x = vec![0.053201881419585706,0.9839635201341366,0.19890798188566405,0.8065777340639756,0.4214574659935334,0.021744853827082133,0.45828275420036135,0.4306527059802906,0.09294611250347062,0.6946426859051278,0.043482111040992644,0.8354416232365168,0.0472272281703876,0.3478267602365305,0.7666398374227146,0.01857343048586324,0.9823820671715652,0.16002407005033403,0.6551158103215587,0.9978705346168295,0.008479928774106416,0.9221749782656532,0.3793416139984286,0.04144269016978541,0.6083743177102414,0.702743667903544,0.20690670993638072,0.8351869931011792,0.12148502517650828,0.23699859275942914,0.021487606180227714,0.6273964582045589,0.16261841703315727,0.31624917235750627,0.11280849909743862,0.5422157623726533,0.08739360885219427,0.9625599431382973,0.20249067760096584,0.5855469404298547,0.011044778228911256,0.26836994280425164,0.8561208217576015,0.4850643046791747,0.5437883788881329,0.4273843866260071,0.500441002227977,0.4344186321517416,0.8331188459952322,0.7993093320928367,0.89401200116047,0.43833967961540643,0.5446965219926169,0.43208192722674843,0.6991164375507392,0.9335153475608603,0.5729646297438767,0.5881608727522672,0.9239493598433592,0.7973318458632436,0.3605952448354287,0.2486826850228132,0.18070810641404644,0.23304918543424769,0.8621533538002735,0.4553410744488672,0.3850661588498159,0.37784909153923607,0.4637130774717865,0.5082827509863636,0.5894290458116521,0.12474279888947648,0.13013974873019718,0.5983012780716296,0.17898219608267307,0.24555182686900434,0.47118527798592735,0.2979547857794299,0.413917797063559,0.3335401000750683,0.5387725896264497,0.8029471317979717,0.4280489877962067,0.817120022985457,0.8005287078356034,0.21104828030870293,0.3468672316939414,0.32165048526400186,0.9676957439515508,0.7101189519083047,0.7692669164275034,0.6510448221656797,0.49843467149685505,0.7056489067075962,0.43685488597214195,0.04836152584143927,0.23013172642121293,0.32067067040537245,0.12447071117660591,0.8759582632042243,0.7279597853716915,0.8921714108659495,0.6811882553070194,0.30723630610744146,0.5954362948776245,0.08680770491551926,0.22599132919877807,0.053745709643095996,0.9351169866566149,0.3771108581100515,0.38857326082474153,0.8770465365075436,0.7881702909473948,0.8225146843101728,0.9631269332877465,0.13754802826673407,0.3267837559618686,0.502019430858886,0.5421948124641833,0.641965934571718,0.19412716971396238,0.917896420941295,0.17560476751492493,0.08994294465547059,0.6537397199069577,0.8980570351768659,0.6797911680898021,0.38809814000240384,0.6027148147922854,0.8478256703119391,0.2938557012506099,0.8311114925741316,0.517878036911655,0.5745608775961311,0.8337749281333388,0.5186907926584009,0.9843749220589495,0.08019968300685498,0.5945317392962797,0.04204138179287398,0.12284502458667645,0.736515408495114,0.8233089780753277,0.31188064677097826,0.8967605581447722,0.6334944285024942,0.32375127528055636,0.7014867726190428,0.21107454383763813,0.5735688657697654,0.4567676228837383,0.8522690175918657,0.6702985367918515,0.42400524802651984,0.44602945178663,0.8946559510021197,0.7506575214705674,0.9601364463405453,0.7002516071328965,0.6748064810224753,0.5044678259576708,0.20658142693518644,0.647358237005947,0.9786784400998038,0.07491532648761645,0.22632370967028648,0.511228940947877,0.5779263829211975,0.9936059990595292,0.02297931383850571,0.12458747736950326,0.5144351216890052,0.7324050147872956,0.16719842266173512,0.4762911548142075,0.40018594421304676,0.7273383955042138,0.5310220012770517,0.6156461053846236,0.7296918021657987,0.5544511454660711,0.6640097535519445,0.8358979910277373,0.586271726150314,0.7803623531360745,0.6843371441256741,0.30753431351643434,0.22483373597192713,0.5620869231598705,0.10027876781825296,0.05398632580728879,0.017528467786104285,0.5538580041642415,0.6021318958295414,0.8394114604431719,0.4345038801601693,0.41537479526812526,0.3053516166497625,0.710458615648409,0.3526917723086065];
	    let y = vec![0.28587057909451274,0.29016911693509295,0.6979716046213861,0.2323246606597431,0.8462997049891907,0.29699455264436714,0.5210591927194712,0.028324797920489808,0.6955020303187924,0.5953515365808489,0.32792775187855205,0.5764664837864298,0.2961634722283838,0.16150615038689076,0.3942813104784846,0.47038920381302674,0.022548577841058237,0.36135852509729094,0.8306617944777898,0.8615942611426278,0.9797807560989557,0.4811781650393301,0.8333174115326302,0.12801075827598885,0.36902644619139324,0.29895946824221853,0.3948538965226607,0.4127203499548173,0.6249622147399296,0.4486382016880013,0.6722213747900454,0.8447308517203639,0.6014492245233073,0.8985683131604627,0.9430043477063609,0.49379750326152994,0.6246769719418379,0.7800496420027924,0.14703306616320233,0.2935089024734694,0.47328117181846774,0.44369969019737854,0.008133366587786739,0.05421126931710141,0.12323199723185752,0.38494109935635723,0.12159501748056234,0.2012705806671553,0.5267322036175595,0.661802829937739,0.7039965271849956,0.830313711320254,0.37510617662628176,0.27318010150460326,0.5116331459770742,0.5559119358878657,0.5822681800568107,0.713978788415156,0.6654288973321297,0.16744935909774272,0.038611974867492016,0.34853604589944664,0.8583856445349742,0.02681654381184806,0.4653212397057911,0.9169490191594502,0.7078139672496799,0.7321259211330372,0.7399204157169581,0.15524979345809153,0.31236006646303005,0.767748474640098,0.17251508901268076,0.9203461188051835,0.28856039759903696,0.6786034348224753,0.9431023388381236,0.9678750720145328,0.7797012119158166,0.800558925547404,0.3132933043723335,0.27792238273624637,0.14952425849672846,0.12132657075546482,0.00873158615514702,0.4254564772555822,0.37644257528454095,0.4183783481249178,0.9430760521958054,0.1419052403570038,0.24675334869628573,0.8944983033824692,0.9286544630087059,0.26539543790757036,0.30248266663849877,0.38936648167008214,0.8869235185071752,0.4944169368759488,0.056261186276001296,0.9367978591339121,0.11311314471823808,0.9825778916653206,0.8258015441565294,0.08810111648063534,0.7092921204164195,0.8075466937402526,0.48632092473350685,0.13682242425306257,0.6971147962796638,0.5671496437657072,0.7805871070860958,0.5178229419184532,0.05708176853458069,0.5885461133242335,0.7375251052461356,0.04649995735848378,0.2322908334957342,0.20568437110065108,0.3386496494414931,0.42140061160697617,0.836291247839374,0.710880598052055,0.33017367742641746,0.6083960935277999,0.9841179414616762,0.9510808451308922,0.4426487803929804,0.2712534794884418,0.046114229458934286,0.5352833999017202,0.7611615586446518,0.4429982791123307,0.5023546884657512,0.158727569301658,0.9014165749396764,0.7727670521616995,0.8119539409987956,0.7012103642792953,0.9409252752130176,0.050824850512919295,0.40586507983883724,0.1055633797792358,0.6734028211064861,0.7533997208836347,0.005327029100802072,0.5432994269854656,0.18347628418509432,0.4607431093244039,0.688688086415372,0.5199811650977031,0.27295474933662955,0.23983667328584135,0.30286899879150586,0.8892366164300409,0.6408253011442985,0.28676781418511477,0.4204290844530979,0.9889543621632629,0.8126886668682795,0.04077548305734502,0.08234454822245829,0.2686589777751447,0.028054706843790966,0.933858281965533,0.42712668182354063,0.5607314541811201,0.5458554003777175,0.3815515408536999,0.5354294010419045,0.7510468275579244,0.44804363535048475,0.850878988226082,0.3098938696143422,0.8305612674448294,0.33833927243208295,0.13576857556894983,0.42884194368412654,0.9880157887617158,0.1836282511201336,0.4976846215190427,0.3313735221339148,0.02898152918627228,0.7154675846784736,0.9623885211199765,0.5543698284647762,0.08786332767529492,0.7890941124672315,0.7684096961586053,0.1533907600709853,0.8375870001252287,0.9199122204975679,0.9890528221351615,0.6775828266619794,0.6069991848814923,0.9526175681821815,0.1978737077214786,0.6986332868559207,0.3747616216798083,0.7403186225757179,0.7010747873201056];
	    let r : f64 = 0.009435667667326307;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_2() {
	let x = vec![0.014601317822200754,0.47651397231570325,0.45321147649414306,0.3033515614548856,0.42203037400722154,0.5760430947169454,0.9404007911142998,0.9798459204452071,0.39198217071130736,0.20527643094152304,0.49878128958056833,0.8644774757892889,0.8227529024999213,0.15596442845454883,0.9583470145823287,0.654147507089152,0.11836744928090226,0.2781861621285614,0.6771465580844107,0.5275881592952433,0.12255049837576815,0.9286523351108102,0.8655877395281083,0.20835324696383772,0.22343075792062161,0.8573033455629654,0.25147105814323123,0.17825337487875847,0.7976876821680284,0.9325528501486346,0.5073379770906914,0.28608043681470263,0.21438905471750913,0.03353958606533203,0.7369829192975255,0.2708755566861011,0.3650811425000935,0.02945567051090725,0.4120924576391064,0.13074545474383925,0.34481811061862244,0.3820660380616777,0.23942031116242646,0.9795383638652697,0.926729101445166,0.9043114853026212,0.7816024969941713,0.49423899266117144,0.5583848591960718,0.5018420561351773,0.6592188500813437,0.28284134375960224,0.6932696843004746,0.16035437738925584,0.5891667916363532,0.5106151108421976,0.4649004983499889,0.37159965468437284,0.5242202610971461,0.07679835911117505,0.39329004997249073,0.6887313189948538,0.8501817643960048,0.8121658142461718,0.5767575828994952,0.028726103098200784,0.3537448404798237,0.29152637234382683,0.9621977445645995,0.49843118192213187,0.875552869083706,0.6647102027960066,0.06662726758587856,0.17314238610270583,0.6167244657753931,0.8489650063149008,0.13700688640542247,0.43083220873801076,0.6774562066641615,0.9627377916123336,0.6503778480187042,0.777294800344351,0.2896720564966744,0.44686700463579,0.715447591158885,0.41998758102438927,0.2996460625912789,0.8116698177421537,0.7688373469273583,0.40288822973526095,0.9241620894985182,0.7834173010019825,0.9293064035485332,0.23670380590916962,0.6048416552509475,0.9370776853586303,0.5943309039733002,0.2740773441718565,0.4118510780028347,0.7603325045137423,0.315719686475588,0.6579968342088878,0.6180690075667675,0.5282423087379976,0.38399394707005485,0.1073961869782476,0.9330805954487356,0.2981623788494431,0.5200140315847191,0.15803705207486907,0.0012549233849058483,0.5132042873047095,0.5967345734940852,0.5216654400504823,0.6167190780630145,0.40976383018687723,0.1009797276629193,0.9346392249135947,0.3367791491372647,0.608352350766069,0.26341689114063116,0.8896539802371514,0.435030735499629,0.21772884065314635,0.32556110452059905,0.8302621429820165,0.008813301082400748,0.6126353438982465,0.12291363405809808,0.9587700980851885,0.4177872595516091,0.5277177611348469,0.830394119052125,0.08208228338926782,0.16582290092802687,0.4832052320477671,0.41492570176376964,0.3026990670377242,0.5895823991199858,0.5694186413030814,0.10844693192038479,0.2138405374862592,0.26379609253475866,0.42814523405959437,0.6998424088824032,0.7022615661190655,0.46805351029365716,0.5968389748623112,0.14773852986985125,0.13615984250395563,0.9016878525121577,0.44184976600894066,0.9652490630486424,0.8088717101617434,0.32719588421738877,0.44220413618412024,0.10557008884265673,0.9471339412707809,0.6592266091828117,0.030586465989481226,0.5954067652522692,0.3909281622045738,0.0019649273206630014,0.3131205929573102,0.9188848299789865,0.16532729830333603,0.06086807606806033,0.9395177279577018,0.6867227007286663,0.8109571795934352,0.5945887410960097,0.002321593982161807,0.1324220665596677,0.5599958131151068,0.5302998560436422,0.8549365333454196,0.5158936264408662,0.02850164102799624,0.3616517282745152,0.036921125002222555,0.7725332701698356,0.2807914792540175,0.9882028640983491,0.6977767938797456,0.0031373600232963428,0.9245588469167529,0.7899071036855776,0.40891213875768884,0.9664033459683392,0.590077378862363,0.4496420093466622,0.20934651819158956,0.5639200318564651,0.40781851880523234,0.8173193346814288,0.3141470522065538,0.3828803086574539,0.25659162476211017,0.5246633967959342,0.683691380062805];
	    let y = vec![0.08018259398395688,0.17264456985529808,0.5572882210371366,0.9333435351507622,0.6058331423580845,0.20512994868285073,0.8117965004986568,0.019140474801605523,0.8472383220981449,0.6716137959864477,0.6111379137889168,0.9328368006989973,0.09840714312062093,0.770353315864225,0.9797527336184814,0.8359122262257638,0.6130350207567233,0.7387251253274455,0.6178402615880114,0.2527681474951986,0.9452799926867761,0.1490550501944763,0.2192616691142808,0.7853600919353962,0.7737086341341017,0.8189037565567043,0.16707852421430158,0.5457407162826104,0.1265191995369509,0.8585147670328916,0.7741171972803191,0.15229265334858255,0.48037279814488787,0.22176873494678684,0.1403523607583087,0.019915910808897874,0.9595885085313748,0.7371016063473602,0.6685390666033451,0.5404924307690224,0.0765959762871733,0.966935687313334,0.5039350129362329,0.37472823498414887,0.9281762664385655,0.2408136564600174,0.4737902861028711,0.7145630664894903,0.9587767983177059,0.40024860399416706,0.5612560629691475,0.8646779722184877,0.4530468081648993,0.882565316397714,0.5437047118697806,0.5469824425170479,0.13919482412613127,0.6165499372207432,0.4058133367520099,0.921654865145421,0.7572171786901535,0.228821307881802,0.9879287729754074,0.6599604611984845,0.39270141692707494,0.6024304196327716,0.6121024097491617,0.29495668787727536,0.36430446844417297,0.23930380123917738,0.9419067409805935,0.9513556716399502,0.21748282972716138,0.7954926777477742,0.6716660555898927,0.8685839666669093,0.22539062588350578,0.8893943506402411,0.7111665415140719,0.9457875657683487,0.8042750178615738,0.8552749585701902,0.8908851103846526,0.2851002800425825,0.09503219996269296,0.8554142973256652,0.29883618451332117,0.7327157925286532,0.9110851461404179,0.08319992288490519,0.1960159861352606,0.6898397041760227,0.733964874217932,0.04598505080791426,0.48003688771791453,0.4630750171286262,0.8935743761292152,0.6001099643583124,0.38597915762408286,0.262693229666512,0.1934724574079003,0.41293172792911814,0.8796074775386427,0.472177905937158,0.27620989906750815,0.9993247033066025,0.6128473930297899,0.8216349540088768,0.7514695405003823,0.2533897184242143,0.21200675285494663,0.009128947335250603,0.6230076429820344,0.9389996686968156,0.09656588986682635,0.8109944555919902,0.6912464465956556,0.28272826556525255,0.20702326368299961,0.005124143496189282,0.08852909875338,0.7686870041079152,0.928035199498258,0.45084063471415314,0.366302302965514,0.5531521736608741,0.12809385727185418,0.8532302189957021,0.1644225144499476,0.3166903692997356,0.2188471377768728,0.48001521929007385,0.32125539894446287,0.35121999685088523,0.43173662110862043,0.46044149455203853,0.45810725534351193,0.6328473247331409,0.8368194811520858,0.1759446159526934,0.18821606430266313,0.14680761436043432,0.5065010552199992,0.9293351985243674,0.7081352453111224,0.8479427181516983,0.1567022309406142,0.3662683419519479,0.6183443694456429,0.026818912254969907,0.5530048673854414,0.45302272920082465,0.7371679680644345,0.9071986753655412,0.6048946200510968,0.17026369178559397,0.6552684073076015,0.24503502071262173,0.7891804434706577,0.6295320440773682,0.6697428651054728,0.6038807174186899,0.39866312811688265,0.2149227400451531,0.25856722052150216,0.005483631405631906,0.5733104400900626,0.40596657066597364,0.9348265816534446,0.8214994603979886,0.3672828700033185,0.9006794971599752,0.6992673007985103,0.758344626503398,0.09270562285554496,0.05951829694552235,0.456652723117125,0.8505436542768658,0.13283234155559476,0.17824387256030427,0.11154749020431187,0.5576414196902651,0.17958493712876922,0.21668364795604866,0.8006552182180806,0.9167839768342786,0.6723030876797856,0.40726128019707775,0.5889951126687254,0.4005841730601173,0.935343792181741,0.031491672201885645,0.8775706548584746,0.5506754631799043,0.7507049550061463,0.6520231129017838,0.12263070805927134,0.2384469002316053,0.7269203281944804,0.7508997874278142];
	    let r : f64 = 0.08615350892160151;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_3() {
	let x = vec![0.11852274719117395,0.43601500023082973,0.4613522949677824,0.4313511660247821,0.5314674253113982,0.9227905588852262,0.9133371923273871,0.2749924865017709,0.34886970661302774,0.9679744225502198,0.9693123793169334,0.7065557236846128,0.4907364456453567,0.8621108062365795,0.8157368214514653,0.40251148416828264,0.9586112327084774,0.2655990971503709,0.04037988244876001,0.39757023760244414,0.5766339959768227,0.27985478080601345,0.7583971206647458,0.8911434111906695,0.25589452267371016,0.6567274393623704,0.02708813688827827,0.7685653739325085,0.5298221476259253,0.9815700236413587,0.3088184085889122,0.013570290429459897,0.7696935813486229,0.10529895379518872,0.28201283056248627,0.18025438347231748,0.3375908910516735,0.8162785064373753,0.9251437232181501,0.5026343240605023,0.22465979811200132,0.4343559647488535,0.4389223959729358,0.5466344097596045,0.5621049164520556,0.06160601611241967,0.4328838472927278,0.7712695947924332,0.49213915004423847,0.22105122869548055,0.2211330545933824,0.947543765828319,0.0809202878758789,0.08805866934605577,0.048253502919280766,0.08499462483883147,0.8893618800585563,0.38277136970679293,0.05310120508499094,0.08795352715929317,0.9292138329477726,0.15265304224529186,0.4810022148058333,0.8773598560882899,0.9587727616333842,0.6941894989560825,0.9558068179673128,0.5077765693452958,0.8121117494499956,0.17311735037568465,0.041328181632796834,0.9744995599519833,0.2555587376074908,0.7550466322431719,0.7783750800536869,0.8384909902520866,0.1551005877359919,0.6413632732928154,0.021669603972921614,0.9746320528232418,0.04984915139552071,0.9063089658920684,0.8553951766632164,0.3011603356752558,0.9169895224870683,0.2280264198833687,0.24456300041635348,0.5618968896642537,0.86546299045916,0.38193589146028417,0.8716751300386608,0.7290482970615945,0.16226309859830212,0.01238608671571173,0.9714040444308165,0.6442834290049247,0.2924068078080695,0.011947589746113207,0.8178198083162441,0.14680455290784977,0.6742707345912492,0.33848464963501856,0.22436893077356068,0.31355843864732824,0.4863251386085773,0.5121003726688049,0.7151979838106277,0.1445168016993431,0.32463172406485896,0.9892372211662313,0.18422996633456235,0.8706088060590232,0.81278311246537,0.26663768395826526,0.44774810004129606,0.8894448548099656,0.9594766095797569,0.13452087189580209,0.029877206219915187,0.39312621342969345,0.26487189330940786,0.2151014807821976,0.8707435952340569,0.6304076391553735,0.9887482534030434,0.9444054639219549,0.3053730067818383,0.4540889566627929,0.5035750305829639,0.8826947406346426,0.13977956421328197,0.19190570062853196,0.08850363084710611,0.825553236729719,0.6302741004625902,0.5476339893387998,0.6599032290255941,0.050942636457246726,0.5722568852133978,0.9016829450775252,0.848807711926968,0.554516427667847,0.8763294356781659,0.05386947478730986,0.3520353873834846,0.3313058366911601,0.4964049864392711,0.5494756614857818,0.07320472933963007,0.5185493381525034,0.9639595327549255,0.43844845005067423,0.018204256308149147,0.8794817176856827,0.5501914673689801,0.2836435974566618,0.5090086848192202,0.6959481873774922,0.6370532296729382,0.5814583531086169,0.9832626826614019,0.40392841705118765,0.9757421668067321,0.6376195314136875,0.31644648763699235,0.21842926843423416,0.9211003283472889,0.3374773740370193,0.8673919331542074,0.09427091967186041,0.9517499672052088,0.20011997667469084,0.9158137009150009,0.8854949659407712,0.8655407873797459,0.7950459371999716,0.17069658834586088,0.9372205405552505,0.23164661861908475,0.5257079843104558,0.5837701647094392,0.2505401501879232,0.12290549047179877,0.3555088399096604,0.19503224377054196,0.2571169134670881,0.9966025771244641,0.23841825855975596,0.3897138127877806,0.7585012088438344,0.7000239455897861,0.49872700862605324,0.023041407523568314,0.6743745568130278,0.2789138171170581,0.5821234803558234,0.46196088590137774,0.2944653811893311,0.6402479017186729,0.05340013916156505];
	    let y = vec![0.14731681817067743,0.033985328084884525,0.1282279486594602,0.940008399183389,0.48679780322046795,0.5139245183329687,0.7619025053630375,0.7990584732401448,0.7231497508131959,0.46251080701954506,0.30484855136065014,0.2373236660146837,0.30989029896683074,0.7098667243419918,0.523618315400831,0.5892743300032899,0.877674870555999,0.9746335620648953,0.9581188147193149,0.7974184489821542,0.4395776419699896,0.8137599281059039,0.9471720597931287,0.6183460529731503,0.04677067769386989,0.5858017133815291,0.9932668143649294,0.6366608484286863,0.9125542386077896,0.8035785481937027,0.5670039080305089,0.025606482704483735,0.8934958518747547,0.7984000219533811,0.7599079201292936,0.2814136926861506,0.1774041321100689,0.0738941850296374,0.9563573259126046,0.43791945324974124,0.4911674855296184,0.3543830944653116,0.06053507637967015,0.019121648092103705,0.4236158730442141,0.5197562961536404,0.7881659885311497,0.06302382556369412,0.7381612705369663,0.11855892066414109,0.7707581118978045,0.5894685771486884,0.23196454506592745,0.596977110468423,0.039920178952402297,0.38178754515208935,0.8511954617860309,0.5345021255529256,0.95730900415474,0.051074150359993964,0.4624841214508938,0.30196542654620584,0.317493592516509,0.7564358690759985,0.04438565487043988,0.4535061652239266,0.8471780875309471,0.06695256064705601,0.6177275463497431,0.777173761757851,0.9913506302510317,0.9825533930113716,0.15555675310587613,0.2650839110830552,0.6069477243886016,0.6941589501845226,0.40265615381266284,0.4000945841417143,0.47478059245852877,0.4803288392845888,0.7268550388616387,0.9999871948964685,0.0021697151893125266,0.4171590572992121,0.8434147766970453,0.5649617998195323,0.2917493318223764,0.1551567760508965,0.4923473298743316,0.16275022450742793,0.719316890713999,0.8809395769675847,0.09742739253212529,0.6685042848875383,0.2075926309147028,0.9342017917008757,0.7143365275488089,0.3234078731381038,0.9807355644340159,0.7848397920802195,0.12410876651181979,0.5568573296578193,0.18430865734865287,0.3684638802138709,0.5397503606585312,0.8470822850062644,0.8335538070155194,0.5196631209464958,0.44055771583106307,0.913968002201733,0.8273098783222137,0.7493843065747662,0.4712068118025,0.8817632012753901,0.11357987795824864,0.164902218730277,0.058832421986588446,0.5804131613588723,0.7829730616198173,0.2974672893504866,0.21535575303843413,0.7903576362662417,0.7656902222743514,0.3064420963039468,0.41332990264666924,0.5877589930690834,0.02127531433168839,0.6015704479335521,0.7195671649410403,0.9524513654371958,0.05796574616660799,0.4740100197270738,0.876622210554995,0.3448296370813727,0.707030672528079,0.7054027261142097,0.17017951854591462,0.79443765567149,0.6490241258040401,0.4544348027576388,0.7542970187610326,0.9306888943845862,0.22624428659858797,0.6318512425648669,0.9893004964299233,0.6008141871207321,0.7267952361040502,0.6785529482006767,0.6720582184986289,0.11142045567523073,0.29968239555294973,0.5231560540384813,0.5711196410533633,0.42863763411718203,0.9117269266656304,0.9925951762853421,0.8289844591344342,0.02820276539154165,0.21924448655466755,0.44766709205349986,0.03198203351494411,0.5056849210956963,0.15995595419260433,0.40268040804268734,0.39913194833374754,0.7668819796747516,0.9792562147675197,0.850449244856876,0.662666874934745,0.035927243369497264,0.8023921893949274,0.5529193055508238,0.8728638054369738,0.48799050071080396,0.8520503228747109,0.13011050330081886,0.5082040659752157,0.9512031703972134,0.7057853747712376,0.01661190844114291,0.8271290898703312,0.18168485411819102,0.15383379125093555,0.38096499134963346,0.3426545239650748,0.3449694774915534,0.5730751943239605,0.7688530812732703,0.4907366738313981,0.38703297604653075,0.5370840744070461,0.16723566445449334,0.5255376305586505,0.3857221128674716,0.5289002403696733,0.4100587710007192,0.5427075067588993,0.5909504125720084,0.49812417486729965,0.5200377373033156];
	    let r : f64 = 0.06518765175716525;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_4() {
	let x = vec![0.23522313260103123,0.7375757927876095,0.33590517623114824,0.37911817077057997,0.3742085150965667,0.4276058497003309,0.815452679246087,0.9864207274055821,0.6230811606188984,0.6013802275678118,0.6422176323864632,0.37074176033385897,0.507165523551005,0.08811981171794125,0.9989965805034344,0.21447413566408735,0.5572477178673019,0.005352584378481184,0.7306153553173516,0.908262761561734,0.42873803694365753,0.9842873581336209,0.006659646666559715,0.45562987733345117,0.654539920533252,0.24503228458478843,0.5098215938977898,0.17641054919758636,0.7921470415450711,0.03969165134596642,0.9944714646762708,0.471967809240746,0.6886092726544131,0.2206279307282748,0.41394677898627263,0.24477278622887821,0.6490723802099421,0.6735980211150101,0.7339901352971442,0.8459660759496168,0.12038007080154756,0.9565910687083039,0.28378339319668766,0.38272871689223487,0.9843234005304304,0.5417286901367279,0.9052132409124275,0.09615474954717584,0.2941568618658855,0.3626788247593352,0.9345746780282983,0.23446722857625202,0.7296292421803748,0.09357779774884523,0.3180296257350226,0.41477793140096564,0.032899607635621275,0.5436469639397393,0.9473587819735325,0.5806055269178048,0.13291373650290483,0.39550268769664376,0.27921748071369434,0.4651526827974448,0.06330089884870449,0.5542789499749465,0.4317732500479762,0.9520755621795302,0.92401554387479,0.6478234808255317,0.43924349991991285,0.7546652621773798,0.0633771677350764,0.22613692239432415,0.8652239621927552,0.9855246812908316,0.8448939616322879,0.4703148249664697,0.3021553738820216,0.6998667236738553,0.5055236028583128,0.1563179736069109,0.5609555844298738,0.7586000667805383,0.2920815982083741,0.5734079701392968,0.6591874224834193,0.5566708803784299,0.5067001494077479,0.5010691076122809,0.5432131222200044,0.0754364575173192,0.8799334279834756,0.47547528317604004,0.04947311433837198,0.6830605237114119,0.911138212456,0.13190945134442345,0.39965945928509217,0.9335240135659584,0.9527968979032334,0.23861324425098152,0.3868421095888033,0.4351441963280219,0.5659359789143404,0.05613238758735839,0.7658500625011125,0.42082386522990023,0.8786424689734386,0.5705477382857767,0.6654260792807078,0.1081277334944627,0.09105872697329076,0.8993107824650101,0.7284610967448452,0.44409108620931004,0.26837931311350793,0.9532710534436124,0.21863373897376281,0.3220901911108558,0.07402814057885598,0.18938006045135214,0.0785874348003951,0.8519072886660456,0.48851351336112614,0.7326130669170494,0.07233585095762363,0.2319408168143886,0.3445768465527902,0.7707533101307643,0.6993553675003052,0.3752592175381114,0.5880416398611681,0.8635000609206246,0.7346866601667918,0.15159859903411388,0.9737367205738451,0.995937280483387,0.4655584132636348,0.16144478350855496,0.49267926550270813,0.25673005848681474,0.7710347388499545,0.8053126556038525,0.482515581248008,0.17260250781605868,0.514173566291026,0.04569951062199262,0.8563068988504656,0.10410441719275842,0.14713254836985623,0.9871749764219023,0.7413929178185023,0.19879242401758768,0.8578046090648425,0.25833926791060313,0.43558252407624,0.43035627789774067,0.19511257958599404,0.06671203232805734,0.151074133939345,0.9927673979954156,0.198273680434793,0.0820238204418059,0.3286654039286314,0.04681509020083119,0.5142611564605318,0.8400203550907552,0.2961153353232018,0.06693291940176005,0.9814220418744186,0.07010440735962387,0.903634540187606,0.5465571688409743,0.030030894491583915,0.7318001327780485,0.754001431736466,0.24402874643563388,0.02535595491640885,0.027995411012822102,0.906299101751855,0.8289115700099747,0.8657376310139189,0.931889295056435,0.3527820868064073,0.6393117113791861,0.9075573837275147,0.9665569059371154,0.4622441846195112,0.548198235691349,0.823934566009154,0.9360559394948333,0.26253417299166326,0.41927605654287803,0.14679807081890228,0.7695934174698696,0.848492634801663,0.4480671792003603,0.957334976593598,0.6473237539490504];
	    let y = vec![0.8186455797843696,0.7812825049724482,0.448226578013445,0.22853528072919693,0.32128939380626464,0.25780057879257356,0.9172236730580186,0.6138475010551823,0.22105735999523857,0.39830314230470887,0.9229512689810982,0.8266162180451414,0.053131720712668695,0.9019076392699553,0.3978593888655807,0.32827676863876964,0.002915323174034312,0.3248470003567977,0.4812171528745386,0.9706350345241941,0.9690460174547239,0.28533040846333557,0.5360848723407936,0.4657768059351004,0.08593164699601585,0.657126045142581,0.8245297046535869,0.10135780279231643,0.1528149216820156,0.9944205088014635,0.06321487746829602,0.8133567472764918,0.2837314233471756,0.9411681104154592,0.6834286074247911,0.602479288480233,0.027564761016400485,0.5148058066415112,0.8084321935471871,0.7845535075572335,0.4985103227608513,0.24558656542527102,0.36976354269513,0.14190490761938734,0.9675499806435199,0.8609860491927279,0.7691546436511558,0.6937660443070404,0.3245345769703363,0.11150183013842563,0.20173384056546495,0.47591197912152383,0.49772531029396594,0.922683826875663,0.6621897604701961,0.1652828296399218,0.756620974488191,0.14664345586956473,0.26060860227316585,0.4950350038446947,0.5438972471288148,0.34543460831017236,0.20061567918880963,0.13273146297566774,0.006742714481717926,0.3336481679433726,0.44062941184737414,0.6435966573576417,0.2404863046889959,0.6795334605494007,0.46480088493531124,0.4220470135131211,0.3872668863943983,0.3195671363967042,0.8977800194500508,0.241906599597273,0.7656575068458575,0.14009357494700125,0.2664582391400533,0.522470707148757,0.9257091584133005,0.9207244011134652,0.44897804480081827,0.8533901601869261,0.05162830270200491,0.6879225035685969,0.6967186208609473,0.8595748488484417,0.06849535399634554,0.4774510611723496,0.7832781881034169,0.82403762004053,0.8007073441526111,0.20991845081353244,0.7967387676083589,0.5567676787165586,0.3022920795999795,0.29744189419287514,0.9912629277948416,0.7652951349430072,0.7585286600010163,0.13004904036065246,0.21341148501967866,0.5183526587463552,0.09897443560422026,0.8055189089531545,0.6383568097002715,0.37835685855410106,0.024525461874851162,0.4938677029171026,0.2882726802904576,0.06493964717709622,0.8196091196277022,0.8974164551301634,0.6205522175337532,0.3354911141919702,0.8464838059580162,0.874117738820403,0.15359316120180655,0.3523482661325955,0.06597524515333697,0.2508010510365303,0.548427271735364,0.014736047331326163,0.3371299521156006,0.8495250597458229,0.9324643784616395,0.007594638322330205,0.7337599411064017,0.47670136583081024,0.31036778426529354,0.5153303869819319,0.6203218521870882,0.9839724738657958,0.6460831594946568,0.6423076185098968,0.8733398171965452,0.919158612441278,0.46389640963091594,0.3077253974261517,0.4691876997553124,0.6770232936827997,0.9219507689680978,0.2800389989719675,0.9495421138208792,0.31635231848469936,0.9690120945362902,0.6275645386560942,0.6038154047310369,0.5273260486768944,0.01490354279568018,0.5696387488273699,0.2414991753321698,0.219957533758252,0.9282219477180742,0.5256272809137558,0.6322223121713726,0.5474755051912137,0.2604983248638638,0.3318484675067773,0.13794032327546601,0.6702953219816741,0.1705645617261924,0.2776590088838957,0.7483799548227245,0.6420311192764234,0.37707071525194746,0.0672238989532149,0.24041550003366385,0.7801818903308162,0.564922318195772,0.03715917675917091,0.3725934786052696,0.06921427385501733,0.16846316713129406,0.8249506018223175,0.24493629995948185,0.6150899610184333,0.6940172603162987,0.18124528640518345,0.21815810836693772,0.5390953896630882,0.7159519792207047,0.7898243511925319,0.824940360384969,0.9033704083441674,0.35673954559557985,0.7890369275339073,0.4106300024762477,0.4467018573864222,0.3274264359686616,0.6377488493913428,0.8099327012395531,0.26639643562428195,0.060141952990988234,0.15043360921188098,0.8516848895608379,0.9700582062966506,0.08374103441716085,0.9931178517210987];
	    let r : f64 = 0.11439709520033575;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_5() {
	let x = vec![0.08559668487842254,0.13533086145690065,0.8695902072327407,0.04086894455360668,0.4183063611458191,0.9932623832052988,0.2554554973543778,0.9527371034548932,0.7248158343957716,0.4130835942679638,0.9623106733050756,0.14125368782219128,0.052045217821766965,0.5887423801316882,0.11160312012820561,0.9524574379713967,0.5790524888296316,0.5373768385331881,0.5572137421736245,0.40806900125538315,0.46850194804046796,0.5390432202709078,0.5559449620487859,0.6164006155753514,0.8411177337014107,0.91935879193778,0.3090650833770455,0.6244342041186296,0.3132396783724707,0.9917793412602258,0.8688381489855158,0.8797791699835089,0.17116901539133256,0.9219789348538454,0.48285549043215803,0.46701160802429176,0.5438112504044201,0.9702253867319947,0.8013973519301554,0.16067926237690167,0.8713012110864623,0.2515537491445812,0.8920996035626138,0.028508021243003223,0.7226407565308811,0.04600887613128135,0.5661076608297728,0.06745982757652869,0.3737636534395088,0.5444408092009752,0.4945672266907447,0.7424339707354863,0.04521634940864805,0.8623347069386281,0.3926393121163593,0.9370080809379975,0.6373580233019221,0.2168902673288735,0.7887324595749162,0.31991727929243674,0.6498343270285794,0.10023466072686782,0.43894471199978935,0.3367138958306457,0.6518926836611959,0.23038636248283417,0.1047753652950636,0.5652109388668578,0.26174897080259374,0.6415286029213595,0.6217319988344723,0.3849562024331954,0.3095706257321176,0.37134516653461136,0.07800029799107366,0.21734604271377356,0.8512997485217487,0.82920398186849,0.5112271409597566,0.35176628346943484,0.7120363644291678,0.7332892621566939,0.881318227329426,0.46687477451903536,0.4449890632306943,0.3231958580776082,0.9650612807907172,0.736800459135383,0.8287726827221856,0.29450183271574526,0.9499571301535338,0.7335209475885677,0.6973788749756641,0.6318193094885566,0.4951671635816426,0.3260801477649625,0.4828294293506783,0.9366065877968093,0.3820587837670405,0.31921735692880704,0.9702218341253025,0.8898373439156712,0.21739076790468115,0.23651303075401153,0.04090846677203308,0.8231530108192493,0.975243392395536,0.6475006027765023,0.017733633130185056,0.8600506552628358,0.5789262856364618,0.9067758723071837,0.0999551884073604,0.2080401750181442,0.09103368392914146,0.08856813433886934,0.059282591718401,0.24444440433240167,0.7067391207824173,0.40693931125800487,0.9883183869662685,0.11828551126942743,0.4617307840493712,0.3894718910454168,0.1444124750260839,0.9985240910917251,0.8364949714899084,0.46551903912361214,0.29773573373553386,0.42164674806732083,0.37830882051605386,0.2709224043539825,0.17744345106146076,0.7682440479616696,0.473926737944392,0.4088368827695702,0.46362038571287767,0.031819398973361834,0.6834654936680921,0.2552297440698844,0.7316544801162945,0.16095867008375786,0.9435683148508617,0.22968521284301002,0.21754410824291048,0.9748195033710335,0.856719850700689,0.9249965146917362,0.6907050338647757,0.8579352317556616,0.9682958931872646,0.6578023914224104,0.011149280558863661,0.8878217950603384,0.12432261316109494,0.5449547180992091,0.12259121194474099,0.9032335353811644,0.9371971097880747,0.07102112090923429,0.5876740296396376,0.7842655272308194,0.7714345138091296,0.7633597558490961,0.13332572879008964,0.5795441259760965,0.713504471628043,0.5819625829858099,0.21601417159168002,0.36609403595181644,0.18250055329763837,0.32004988188002204,0.027826395478023236,0.00854099454709667,0.889694129480345,0.8627183727023512,0.5065813768212811,0.7736586003132851,0.5265108870053878,0.6855433116221071,0.4780576163713589,0.7374830006874701,0.6879212287273755,0.4737062328985011,0.1531491076992496,0.12338622305259273,0.5315956151256918,0.7444886585491498,0.05202665822418795,0.4536544154705884,0.3129075492238309,0.9791089441231223,0.6174128370132649,0.31246704647943113,0.0022708394175573465,0.3112426386917604,0.020531722197576152,0.22176353107501567,0.1165199078906336,0.6837212833386954];
	    let y = vec![0.35580573483564704,0.6481374982920133,0.13291507394535484,0.9561679709516641,0.7910384174685456,0.7048983470245771,0.8156485969199306,0.2669048948899616,0.1666829680923737,0.42607666277697887,0.2680966288882106,0.21802675423138473,0.9737961804504022,0.6876621446982553,0.543951278218028,0.2037083295366825,0.5461850395607468,0.732487270285166,0.007629850686363349,0.015261740084529518,0.5493211476353342,0.5598183950400535,0.9765085412036173,0.21958238754447934,0.32565507330024424,0.5154814063217396,0.38616524606155156,0.4125242192573054,0.18931026315656996,0.8676492692958493,0.049067143533342183,0.08065378031735237,0.10596238091085908,0.0862053626324295,0.3660013050622082,0.5798982179383624,0.4572222431268316,0.5370781461021257,0.5431327805821847,0.7603762959409901,0.3860059445771311,0.21861606445275172,0.7293764019594887,0.7511518441794308,0.7218870999305125,0.7242968654716903,0.527280117965037,0.24919174577583636,0.2040149090579918,0.40997169362636476,0.2661362244102736,0.9352247450898046,0.18249759643169938,0.22570549042277688,0.8407649183372409,0.5501204613020054,0.4725378564324828,0.8223754926575847,0.3960893127115559,0.4632582994992448,0.6329380493037636,0.6272261902283727,0.8079817545648736,0.43400976644167266,0.7712345510385307,0.8787265452990446,0.4794148256843499,0.8874129446898936,0.7683029534518991,0.19917451406148945,0.538418167578546,0.18149056922526452,0.4392820812306726,0.4351929290135239,0.8551201334373567,0.8542973397917688,0.9427577088179944,0.7564364263591179,0.8163277661374586,0.2774785529543895,0.7572319340772743,0.5358764230135494,0.2444970574005575,0.8397379492582382,0.5362605232038302,0.6380601658252717,0.9709009596896763,0.5479373026797918,0.20788385738153192,0.6116285439404102,0.7696079827465632,0.8476664867962476,0.6765078454770278,0.8658968756282458,0.30196246747697164,0.37108928550231246,0.3349838551962693,0.02863560516327124,0.7295535162425282,0.5066622324617635,0.3003326091968668,0.22134463597826926,0.3851812602966116,0.2832616612019716,0.5068312945562861,0.44177650828182036,0.9800427100778114,0.6481389615419947,0.4193580139977571,0.23268592835578017,0.3340363070000564,0.39128543163072027,0.8388306849221178,0.7590197492248894,0.5661557885166492,0.7920972780697826,0.9367962774983569,0.641452694684909,0.5810671006120567,0.9672157264314136,0.31189592743826,0.3744139942144925,0.21056355626149115,0.013654869653865087,0.2686333612246925,0.2853361507705249,0.8141164341891047,0.12823636763975943,0.660107833428408,0.272683824407417,0.33019284400032467,0.874659902658151,0.03587037483016753,0.12705972733547566,0.6247868473197986,0.6136003653019962,0.44443465271405247,0.33855334030219464,0.811513075660724,0.6558742735191146,0.052358674233373814,0.7118700606785406,0.5245233868354948,0.5726917689854609,0.9712004368693947,0.6097997093877127,0.6990836804122755,0.7429761782889243,0.2298547354522127,0.9805104089689517,0.8901919978026341,0.9539000915746358,0.7627343006920997,0.3992969920121894,0.2092771580035041,0.7135763364247151,0.8888396648452251,0.19048737651674585,0.17366743513479488,0.5181002357059511,0.12355794965019173,0.6621569579355528,0.30410410375837915,0.4389511178461346,0.8396792677829377,0.4649315519577132,0.8768036022905212,0.4700938439244572,0.7503825404232861,0.9344417209350441,0.12625982466744023,0.906061310247571,0.8241486884366336,0.3583985586832873,0.09279494650393372,0.2168328100764616,0.9488399629357706,0.819445208316865,0.780656109108356,0.7927933969761676,0.8329877057768815,0.35367048101568654,0.7882759691647906,0.7455670708084384,0.6683007582196844,0.30361970440953834,0.3606200990184125,0.29694991326299036,0.3298990246600063,0.2728341179868339,0.16338487856051487,0.2845907837144107,0.8711798477390322,0.6174298135237272,0.8507412043593319,0.08130020452226772,0.3229492892088035,0.9503120900338474,0.43839656019495143,0.24722172628533423];
	    let r : f64 = -0.128934661635517;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_6() {
	let x = vec![0.13755464257364525,0.8689624497397429,0.64319167792802,0.3986998487879029,0.4532087802554523,0.5598616140267209,0.47267120713568656,0.03524799148616553,0.1653394627111211,0.8326247625731017,0.9605978374954006,0.07818200861590396,0.6579763441008124,0.9659268721959543,0.35603308120702726,0.7294145544059011,0.9321587418549452,0.27739057017675606,0.6572938618428323,0.5175699018588443,0.7476097139303326,0.0249427736094171,0.6462203559901271,0.33564310236688544,0.8813326144430917,0.8284528149067047,0.2675807043348575,0.7143998520035179,0.5762187639686025,0.6898156350343643,0.735601842673135,0.014707178120630382,0.47791418779815376,0.3077855167100906,0.9006921674005414,0.5810360614362396,0.8546324515428968,0.6071555972062204,0.8595208864485411,0.647787840085874,0.4104043825783027,0.39752332320696204,0.2136766153857692,0.9466950242382124,0.43236428930142623,0.6972558306838215,0.8973850010690912,0.07007756952634081,0.14631592991561626,0.294701521915841,0.7883577027113328,0.11271392508556743,0.16582866969222165,0.7931899104757015,0.47246132668291096,0.3411485146509561,0.5805072351268603,0.046199751711262116,0.8046470722348654,0.5228719337502207,0.029713538286443297,0.31745603883825235,0.8732678022905263,0.9156212111028569,0.025183784417428634,0.700985800712301,0.2926837664225471,0.005551435208179245,0.7680619425845682,0.48283533894886355,0.027338900728177573,0.12403992468489256,0.24666070604031987,0.030980637870352212,0.22897844017544244,0.0005410195577499888,0.8896411813985775,0.8260457874388875,0.44635335437505896,0.13103665095960015,0.11165653904632278,0.18361899753549815,0.9041805215489809,0.26473014235140147,0.4880755375046769,0.924805636117174,0.041490798630666514,0.484720996407789,0.20299038028014849,0.8487885191740108,0.3772878307180083,0.6862076604598629,0.5925066179494648,0.96422678873407,0.9141387355315101,0.10813550666956628,0.8014486939772094,0.6477158842826237,0.40942043695762864,0.35269232213136437,0.5442038409791836,0.35118325057513444,0.6252186077048072,0.28747904936263025,0.7912242613794085,0.8635653740775562,0.05410665378958801,0.2950820123405711,0.9645319269870637,0.5271375149352437,0.6550762079456672,0.7743831615078223,0.7071977525353866,0.6307006846710367,0.5037244385803752,0.7871643654434977,0.4844142138682884,0.2327597512948626,0.4190827578514962,0.10758141457640513,0.9687032214384411,0.2525469244191738,0.5945895044566583,0.21099668135869254,0.5006635727025024,0.42957629420380794,0.748244355736742,0.5838382711617143,0.48698919431710386,0.05892760666498842,0.5335586038247261,0.7615759865436241,0.31138749087276696,0.6462942967596896,0.4851412736201717,0.6223649737546799,0.38416708042871206,0.4611293444257516,0.6180769287299873,0.5405780978580697,0.29486411002542745,0.5243941283327519,0.482114280969551,0.4385395644650074,0.2656215837122099,0.591551674987629,0.30471288054196843,0.682079622598417,0.04962594146948551,0.6921838222691692,0.2443245224167181,0.6526789244386936,0.23960516977236002,0.10926614976736304,0.4318692392880197,0.0360868048756815,0.21811192026204784,0.1011300955019726,0.048131312923260006,0.09570361150479256,0.9878910826688513,0.052407339081279036,0.37896732470744887,0.926402228587217,0.725716326026306,0.26851295655475893,0.1417192071083886,0.681561016112668,0.32696026928779653,0.9308960986124877,0.21338767792893665,0.39291103191743193,0.39700335211789817,0.34126656786966403,0.18742965928705757,0.2843767746204394,0.9498633244601896,0.06434040735460944,0.15977572171644927,0.8073137676688087,0.47471729746846825,0.8018077985834565,0.9744033424755513,0.9819367550710548,0.043141110533110316,0.5057425986718806,0.6930656759178587,0.6915205410100962,0.673618891241153,0.2649722552368281,0.8551301701305839,0.020177846210750583,0.4670350059919949,0.7422578232074224,0.42918838775627355,0.4501906909544484,0.5561387564048573,0.4310966713916663,0.9397430614264504,0.010262307401877502];
	    let y = vec![0.8890994550522505,0.7543161931011354,0.11589513191167222,0.8741019232084631,0.26474120380187005,0.6452426957973958,0.9964468064717644,0.8722709934756194,0.7002258304614238,0.1521005145847738,0.49696448509538593,0.9069596014775915,0.944183076737536,0.004502430732486906,0.2948353761339858,0.7595984427955081,0.021897107987051023,0.34300366777059743,0.3255469964104092,0.06733478198781251,0.3530030931502961,0.550528895306254,0.9255730973960984,0.08304038812914816,0.70154083246523,0.3806160140500998,0.6857305675903825,0.6589811995594086,0.4506210650395335,0.6978165930932324,0.6092437558831281,0.758203726926586,0.003861118607554559,0.4866961965536625,0.7874512319610466,0.105737095782649,0.3286164088763195,0.3238388134161402,0.4947124603281937,0.6523720963419649,0.3867329516499445,0.9176736425410051,0.6720759519362559,0.013229297893486702,0.6116379759566899,0.0590862809650442,0.32007243617316783,0.8826718255830742,0.4427756049570206,0.755585934034326,0.010784582665973375,0.5823903966423224,0.5255266719248308,0.07200453563494869,0.7369943449252562,0.593798858933139,0.5349577353403104,0.06782218921694727,0.2503222675767467,0.6265976050656973,0.7573559046928231,0.99519528704251,0.3273314669995161,0.2004578642857161,0.16506647459769386,0.43405256413130655,0.7315281915479134,0.16069640618173386,0.12813372667135614,0.1370977372550649,0.5062758100349782,0.9878564452775014,0.257125114943194,0.29240561050163516,0.08548895395455547,0.7787906145706475,0.5132615239977502,0.9011812114459679,0.47427695557290495,0.04554405293010588,0.34805735781600433,0.7312779768900296,0.19271545693326386,0.9508509346708509,0.6440797914199169,0.4384048691083585,0.2656245863774249,0.7938910038132336,0.6046455955926414,0.6764192808615334,0.3019938154279973,0.8909453861825655,0.45657162348027214,0.37778327005558987,0.8105577740468353,0.45196948451307517,0.3277746859452958,0.4760950953867016,0.33948720057363546,0.7651047827120905,0.7707309634507483,0.6117137872783123,0.4232202586163193,0.6359141691546837,0.4252620135944779,0.22090854765765477,0.15414858308830204,0.08433829993472697,0.7747752582606596,0.12905500917999613,0.8753405570156357,0.524619851803787,0.2010951823922622,0.2270571951951107,0.40629141485801157,0.8661968545082156,0.8466612632348984,0.8818601328056717,0.48884205565057326,0.7683817718436119,0.761299167632573,0.428572240468059,0.7897790444200633,0.5787119165560031,0.7245825522589047,0.5157870305784816,0.6904939836169971,0.5007097252181515,0.4199327094085722,0.8192360554016599,0.45163102219452156,0.23733209298820124,0.8495452586158639,0.8714514523466358,0.3834329522378209,0.8070361775693882,0.9965114838752613,0.4835219693270417,0.48703537803974684,0.6490552826087073,0.6161110797682172,0.22449154458845044,0.0006324190394129126,0.9049909026635349,0.36991240082313637,0.5541283802652781,0.5245896447257187,0.10249085921664713,0.8181844688881761,0.09300400419292998,0.6159601640441765,0.07331954729481582,0.7993751316904106,0.6323856424838457,0.38654371724861214,0.541848437231727,0.9374427351670933,0.4283293631369738,0.4531739468764283,0.5076637480046973,0.7925090020299088,0.020326465463873622,0.8616976378839966,0.3254086837153417,0.8101616033590677,0.16365874877542852,0.2505619444227154,0.1153606173670143,0.8017276767096266,0.972302619570733,0.42346967697817717,0.5336212131933347,0.7478460068262135,0.860273011578951,0.41800495299642404,0.9222044800552434,0.44688882112325157,0.5051852428068144,0.1753816143950283,0.8757201032758897,0.013055312785699269,0.7893793388970106,0.15902205626175436,0.7104220124184896,0.8998399312916429,0.6363147868201195,0.01747465651641178,0.37399500070438674,0.6040380377904477,0.46172786600131765,0.6192722879369484,0.2085612365529056,0.225151828711879,0.6936510271893294,0.8110044944926745,0.44950278907768104,0.6773469914763771,0.22515772852081195,0.5248402208012962,0.004617651479883023];
	    let r : f64 = -0.0896924429730351;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_7() {
	let x = vec![0.05727973050073909,0.2775064155864174,0.3761344801173503,0.10516997778174364,0.9930766441828865,0.2598248281411948,0.9411544389691984,0.7190440444032159,0.4150417648254705,0.0933676139530617,0.8528177924202985,0.7384352171369813,0.8459570587211576,0.5655436479473979,0.11332212949645859,0.440514568851756,0.3431024529447153,0.5983153092177067,0.890291247888666,0.44212209982082673,0.6028725348864749,0.5308442414808755,0.9897284046807363,0.6703232812267013,0.527744083181596,0.8419753767149737,0.37770173675349406,0.9107826820347502,0.039438843621696806,0.5242423310807116,0.706533186343613,0.6286790289250699,0.92206539370839,0.31887416781310196,0.2746034376934112,0.7223927191538162,0.9826927529558609,0.24111280156504822,0.23719615113847858,0.6837579078332917,0.7364222648683049,0.17819716736717484,0.5668123377033947,0.24524692787764013,0.09502127787116421,0.25505586568386474,0.992040223701924,0.08209879697311095,0.7398085822898083,0.16806794781223433,0.7292453894681095,0.9404382016524843,0.23556706404975558,0.6168049082731478,0.2332517057722393,0.6312997615380623,0.6033208449891819,0.8848488851440758,0.022786584271562327,0.27687756583595546,0.22837725126067787,0.6835037977825302,0.27460188061410773,0.45942295807832534,0.4437425786762904,0.6179666658743296,0.07390063591043095,0.987506696750769,0.8312538788062318,0.641912133609379,0.8133664734558818,0.22321543889752304,0.13537846238441353,0.19609341127498015,0.1378342311325197,0.9684602368039361,0.7285995057002022,0.9950479244887438,0.9379680961748968,0.3541686691799445,0.441150144992025,0.13104388113999532,0.6136612245696967,0.5366933109909489,0.2918766151339445,0.6191837258626793,0.39050055018864327,0.5825520646238251,0.94788078841307,0.1351015683591802,0.7967659983828687,0.010093173291040092,0.6759679712305544,0.18365736955262002,0.9203000525963446,0.9889423487821348,0.020190282988563624,0.8246957989749344,0.4762273787341058,0.47927594529480577,0.19004312787961175,0.2531621242854184,0.6002270876193162,0.1457482631902257,0.8939330135623282,0.8583543957291254,0.5456410379283769,0.8557390505475383,0.054799748947137794,0.629510353761702,0.523934472622644,0.2910491756195671,0.12535470373185365,0.03578810067373761,0.5635263558424009,0.8105235976797042,0.1719810376176074,0.24660441222705498,0.9560513728124671,0.4014830036080159,0.6415469018922535,0.7211873103306222,0.3435168003129726,0.1752657846434711,0.08064720232088307,0.7265703770292022,0.16655998935670635,0.8878967043410396,0.9811064813172508,0.3443524522685746,0.9672599115029464,0.7166675177129862,0.6609130962264963,0.2409633062062464,0.8612756158531499,0.31329722528439474,0.684387358806474,0.07847745440356724,0.6083717370785671,0.5668973955157569,0.6210333098264703,0.8171842217641443,0.7266960218648953,0.1009009627896168,0.3592462492229226,0.8671101835091046,0.00466474539749917,0.609784365147357,0.9434192450094677,0.6607521674115512,0.6759941261484205,0.35313303045047484,0.7793560365468793,0.3510657204109835,0.22105188395983455,0.45239339075090446,0.48924987013442567,0.3343367628888756,0.9922542346145885,0.7368444700626874,0.3136482561432917,0.9833840468645614,0.15270028891207943,0.5487440539635705,0.3049786328212277,0.587710834369199,0.20460430088156478,0.8963826696409865,0.5496147876006904,0.13810322719788337,0.14092632898581736,0.10260294544647941,0.4885227016846482,0.6704998829485254,0.8452468136117214,0.9303359111876416,0.6733738057311622,0.6775987970132148,0.014506940363449017,0.9493356075261152,0.09584951706464584,0.8267130771243364,0.5359056998888797,0.6252357251600081,0.32724985204924883,0.15490731226215138,0.04141189038181847,0.025645835044440735,0.6319008773217387,0.6041586496451564,0.619370557388362,0.6182567918474333,0.16934105174716907,0.034861724766635405,0.03742079039548296,0.8446771769819151,0.002429811085520983,0.6297408927517711,0.47968437393900343,0.1010964913021557];
	    let y = vec![0.36756764351146853,0.5277921862660769,0.38873431437008854,0.552700921488577,0.29549308420050524,0.5096920660116565,0.9579067318365387,0.1782138265821962,0.5394943932289186,0.6285734904320401,0.6926540652546815,0.2796249675318965,0.31001139421720403,0.16786720643660602,0.16381954320433856,0.9962356438632117,0.7170768740984986,0.6013129766737962,0.6891887501507525,0.49136659357101276,0.8277120499427453,0.7646235047689263,0.6533398480189947,0.027488990892899356,0.9303330642508566,0.5374397038257961,0.5759646424371283,0.12855520117157826,0.9043593270501034,0.9855701453874274,0.21431281887321418,0.2480778437089446,0.276989910580939,0.12222910149620592,0.11121901971478854,0.7697040210182404,0.9278326664611951,0.34151143792875405,0.9837667406739579,0.03422434416514675,0.2663155097197317,0.9183898845895632,0.5599057107329318,0.0649530043699853,0.7383434050789234,0.7748688539412885,0.44240727115932454,0.3022978008115724,0.7372119542055496,0.484727866281647,0.23206334595642308,0.07642488387108204,0.0027121558891231023,0.23076677138859447,0.42988664500349316,0.769377519211871,0.044503675453709146,0.7367429773275225,0.811526807234488,0.728205632666415,0.03944560661638252,0.07786221404509386,0.9615270280438462,0.944793730377316,0.5046729076407191,0.9848823128404723,0.7129857246183218,0.6209547914933095,0.7446665574601845,0.3012649700659644,0.1396058898795911,0.5257613205031186,0.5568975051508029,0.5448374391134266,0.45721597602566133,0.5699499953225655,0.6672080362098358,0.5142487902591182,0.7420800283511944,0.681373100624989,0.05195846382985292,0.6475344183971021,0.0421999077236862,0.5623497444560362,0.9881864074043115,0.446561452662132,0.5571300315420088,0.9304437656099163,0.4308208240701311,0.5345638153947992,0.058799846373065234,0.3630139116689921,0.7024689359457673,0.8258047600600313,0.6992021425723592,0.49620371808060115,0.4126342782861203,0.6978804201917758,0.9422428299278142,0.31393452932693167,0.5271863445996084,0.8411624524578087,0.24339006815470465,0.9107327280980664,0.10214856185607268,0.3848887899215424,0.8420929463138394,0.28067885366881906,0.8133842585804427,0.6022968384658225,0.23873092977981902,0.022864683539287056,0.8757527345502447,0.9067232685325338,0.047043537548808856,0.05054903858251936,0.6373674126995531,0.7417096673399673,0.895488510729844,0.2251346938117842,0.28897231466547835,0.46282671232252615,0.3753645533059772,0.6063260597500477,0.07077698068503879,0.4683013829787046,0.6265165880167094,0.710536670411891,0.47362319478626747,0.3071767080947806,0.1112899913255806,0.4091186563587875,0.6218655823434981,0.7419644383178052,0.2371824503505291,0.6726578003065056,0.9389095626367063,0.3552970208792815,0.7954935467259601,0.514800347636376,0.2918585207237263,0.9505557095766966,0.27398354790825663,0.42909397925569304,0.9152793025002796,0.6104028113252575,0.5567525270575963,0.21181993786989028,0.099769133878849,0.8079215964970553,0.38251320930832966,0.6536820599680145,0.2651345177737845,0.6405190857584997,0.3622242266609961,0.08730565128913192,0.544731068002998,0.9911746570568416,0.49563909193532885,0.6356038260100969,0.7550561246315738,0.3537885880480932,0.4394110457985365,0.5884671090378503,0.3890133419803512,0.5208003607494188,0.32608197786350746,0.8748852806342875,0.808111033038532,0.6119673962982958,0.47240875703314933,0.9424763152112081,0.9686744167712563,0.6614041721204378,0.455822931305901,0.4122845820646124,0.31625792033160105,0.9483645752147383,0.8092149352326743,0.25485718511521915,0.7578338722362673,0.9319179815020427,0.7462492968151675,0.18372163273790987,0.308248741859128,0.07828470712881752,0.024625368190793973,0.9564870354427922,0.4164841077362822,0.6205866374274093,0.8721545292196013,0.3748575246663626,0.08302380789962238,0.06637238243591981,0.6470051403732869,0.2227362004908825,0.19800142056672598,0.8166099314995515,0.6792182424662925,0.7158845470679831];
	    let r : f64 = -0.09713215357585069;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_8() {
	let x = vec![0.9688344870671282,0.8214280398075774,0.3746083260233446,0.3286867522229102,0.5452320215644618,0.13870444243862534,0.01308219286708423,0.7059925792569637,0.4587288769863457,0.3357858957062919,0.028604097300261033,0.732053592471124,0.6635007961117689,0.5039825047837133,0.6759266580280667,0.7910299005541822,0.7327660300811907,0.06857941260210987,0.8646537106588859,0.49452911622043316,0.7264527842852636,0.010547551073343264,0.486210917878131,0.7327709068322363,0.8763284440768913,0.7472676488348073,0.1385939207341288,0.1470279803154121,0.5856143246503107,0.5755686356655834,0.5269208062031384,0.25888812257026717,0.9901454060542116,0.8508941647583843,0.8363361980359771,0.35647249156128114,0.35348555733578413,0.9074097964380923,0.7462676067813,0.3779368608999456,0.44589742523245623,0.8543922757534986,0.8367232680158381,0.5514924921862973,0.4460918277999386,0.09593376586066338,0.03517898730127744,0.9819779952436507,0.14419906100796842,0.2354994604534839,0.4125999390357007,0.2839584448916328,0.3732457722714311,0.6512978365626937,0.33941305835624336,0.45529481851398534,0.6920242573092953,0.3667328635984628,0.28121164749454186,0.6379394318131031,0.4037350165465142,0.41119872708548666,0.8860460751529862,0.05212716749075985,0.7562376401170297,0.8068716390231334,0.5402816690784309,0.6437831130406774,0.6289726435137099,0.8824800022739899,0.12224796211080269,0.7628234176559581,0.7300568195768851,0.6204723141951044,0.3696301352057476,0.515759184311351,0.9443455492018739,0.18745726898425918,0.9455794532862434,0.15422958682309162,0.8862317260399867,0.9539971437414257,0.9998175677409783,0.8754602905144514,0.8628153299681022,0.537671987229725,0.2628140549161778,0.32602237657394617,0.08196742017411385,0.5107365957876329,0.25543416855848844,0.3804861457354466,0.1804464750153315,0.4276741199699471,0.49580854510709194,0.8437775503026655,0.46735303150964547,0.7166323551190943,0.044034791156738806,0.9959354243129082,0.8328532253268895,0.44176128001968495,0.8824672490558396,0.19526685564426494,0.808220806177908,0.09578679943435575,0.516698519199389,0.2947340981471488,0.19119920393228407,0.40888590379589573,0.9936513914018025,0.1746198693220159,0.27353264810852485,0.3333776117173224,0.9796091438381996,0.5293061691214112,0.602183287463868,0.9225769617989363,0.6015211734839564,0.1472730342829779,0.8106410062260393,0.5907028767214065,0.7133087421528148,0.33788438459730186,0.5913927197238309,0.29964743481191103,0.8834248709772741,0.6697352202933913,0.5495871430219125,0.23415440226995154,0.5537622593159998,0.41573121708177696,0.8483486106933749,0.8297271012942576,0.01594175162819511,0.6205080543439603,0.12538284030094093,0.5066481153434678,0.8265018123002581,0.3874743423708791,0.9971144882029432,0.0036110938574415163,0.48522411273752697,0.23387579880158305,0.6315888817513415,0.7846952090717936,0.5076873590552193,0.7901023422557398,0.2000794889392492,0.48906945657521617,0.7444771455145722,0.9043760544352966,0.8127094681048119,0.7031192840104791,0.623250678872544,0.41593429418594896,0.6563777637440981,0.9646164991246612,0.7730486622923977,0.35211482755878754,0.382726403571358,0.25179654672506135,0.5572185073217553,0.6517514879754922,0.7083206303012832,0.31078020107538107,0.5563429892751087,0.11264459699677332,0.5086787924029729,0.6176579003513348,0.37804362270361125,0.24094624616005822,0.6501505573967389,0.81967870344601,0.8801834133817709,0.6821817688213541,0.5386008751165019,0.9357260565839077,0.1911990149261592,0.8151423761185097,0.4236681855369535,0.019033684567250964,0.4225911726615462,0.9174586665607094,0.28741424868679144,0.38224646797401185,0.0033484359062846414,0.913856218413313,0.3454263069460911,0.5519172914396759,0.5923134459030894,0.9714221398724677,0.5942081495457633,0.7294051311293864,0.4316294866131145,0.9837182962439336,0.9272629595391921,0.6265247540795814,0.1913372819524678,0.41783349782377954];
	    let y = vec![0.04681806213175188,0.050139392641554426,0.6412668611429897,0.016416782365575755,0.1485837657810105,0.2981249730453961,0.630567731529829,0.6677097889477723,0.04262775625169257,0.6272349994713562,0.6061798977478102,0.593789139492842,0.3845484493833571,0.0805840284876207,0.7859388375082031,0.33738763573243635,0.5849118556873399,0.18509015531457573,0.3000344137857315,0.7432643608312852,0.8510720455687669,0.35640666498246243,0.7580783348938,0.17254809687079076,0.5239781359534356,0.32529483669341974,0.05602788524562008,0.9270832250674544,0.9959896109219292,0.0603375918754494,0.7823975399557773,0.8938846306697621,0.9809519769812305,0.32511584182474096,0.6244040025078293,0.39113965351285895,0.8290862322419321,0.09738424778401356,0.5560288824260957,0.32039119367432745,0.2870486450593336,0.1977987404167033,0.27018203987205514,0.36352961381203874,0.22249142019197865,0.5285878635703043,0.18707630505146644,0.7234959317222438,0.610529820515457,0.41813013017202627,0.9721770953034963,0.5072654951071288,0.27625483524826167,0.7370967540873337,0.08153860998203788,0.601623575171437,0.16457229777072513,0.19629101908726887,0.7852421911180311,0.9797264641304075,0.721303287773571,0.7678003354441685,0.9852231302595059,0.020012934557744888,0.6200489334088275,0.8847472487153233,0.201100745665855,0.9614939698925377,0.16294912342784384,0.7170065716596656,0.054407456573051016,0.3950616741196086,0.43676960326020475,0.7454216628424569,0.11696156768056731,0.43712497976648024,0.7882529635374945,0.38438320586740804,0.3871987347157999,0.24283337787046277,0.18201241106711563,0.663038985857981,0.451319107149053,0.45056940817991653,0.8896766324701849,0.573551572305728,0.3013758201780683,0.7602932406055296,0.6827846575157561,0.1291735421284832,0.42005817350757657,0.26686694086403506,0.5550824125183365,0.6386416646750659,0.1100984720793956,0.7010665982330299,0.6055103982888215,0.8710223871934446,0.5902274344924566,0.028452730479719635,0.5509340793240299,0.881393719215858,0.26808320954591924,0.6055258313582356,0.9878133792179048,0.13018749445387057,0.24281648023880764,0.14119619670718786,0.26790900630476866,0.24908875954878507,0.5927311193231439,0.9204019650159287,0.10190932825551002,0.7627422453958776,0.740353923205948,0.22454566731407088,0.996352720650776,0.48887690450489785,0.9767260372919015,0.5345166950003792,0.9216566937581436,0.8976130446039947,0.8258619759545605,0.9073855826292408,0.9003478656135843,0.9288513017055319,0.6181707140506301,0.8867443373491773,0.7994024736387465,0.9750335296030791,0.4201146306772243,0.8727579601282777,0.33219554127604156,0.8311519923539914,0.9454155377173139,0.19984018143573523,0.6531074481793135,0.7260198200692676,0.1534041547255085,0.8876175108680378,0.9483920434014647,0.18770212130010033,0.3686880949831902,0.801237707146584,0.7032043781408569,0.7780369763193614,0.026880610020465823,0.9457582568784719,0.9769698757820253,0.01044743124476355,0.27608920024137673,0.8811909117179743,0.45909374961158544,0.44087265885660953,0.40129569736506365,0.6965952997243311,0.9603471802310408,0.12965029109179738,0.7141259258653513,0.2506854003558616,0.1756788115368264,0.4736727616046351,0.2499567962729925,0.5271512619943216,0.3468701337020814,0.27259828816101683,0.5212708439587869,0.9294254537661671,0.3975733981901248,0.003961098773817007,0.24689806841474082,0.2762120081311208,0.10377392906539473,0.8572114850044742,0.9743512115410335,0.16115649380186114,0.8538475439654691,0.024789307108517233,0.941229523311349,0.05763649406585902,0.8686974360091502,0.495413677366773,0.35111243583479024,0.3852532281697374,0.2494163369093514,0.061590249447313616,0.8517359970351915,0.29737575293233853,0.8357549069256962,0.7602677503046628,0.5244323500914903,0.12882323387054473,0.5742662426193282,0.306589874303252,0.8489218955291836,0.805495486565317,0.8278829956014154,0.27170390344601847,0.8433126324005331,0.5748954971843185];
	    let r : f64 = 0.03184710562193975;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_9() {
	let x = vec![0.6668997747539446,0.2920101090829942,0.7201920783151712,0.0621143026028107,0.9834091184149677,0.8023772640230354,0.19081908712836515,0.17557101976071132,0.8080002090140792,0.3540196539671554,0.5719216166172221,0.01787102217114378,0.018522805121382047,0.839680888067835,0.10007122435096072,0.9537435011764165,0.4587663377934128,0.7031345089835729,0.5736415717208622,0.25062437627228107,0.7156902533267486,0.8197637483940733,0.09753515750191544,0.6782946270915656,0.38632719362613566,0.16057424149534927,0.4211998008237613,0.4207696484244413,0.5375648828798719,0.4437598072211786,0.3064918013536546,0.0705048929448302,0.211283179852241,0.0066297757655015,0.2271237818823647,0.5077929242258243,0.13485100431301145,0.19831740491516336,0.2021888841386349,0.34409456881654854,0.0969934514661599,0.431725437158905,0.05984651718760037,0.987548759694579,0.512022822645787,0.9236602551306726,0.10461573465891516,0.5341814795305715,0.13549536391488992,0.6651906151719673,0.8380057198654098,0.31532858485854476,0.5066748186480642,0.7659331528426752,0.9248101902676835,0.23729165075950243,0.5991013999693809,0.9056643077725284,0.09009068879312421,0.9318685809451269,0.6401197345944735,0.5101463655174163,0.37564593184247486,0.8879687107647772,0.33697667687845045,0.3539419363342461,0.8951360202473791,0.7277673884892547,0.6067910253219273,0.3807806385338318,0.6867864485726624,0.7512244841652339,0.7968224741486455,0.274071945551697,0.6313691225098234,0.7295766851807662,0.5971276359687517,0.29233855549377463,0.7257814428232556,0.9083622093337697,0.1916539033038861,0.3172975157026021,0.31032342357170906,0.6627631309658009,0.5132545676818754,0.6664897973126227,0.15447505525399796,0.8740854636623346,0.12839737817706098,0.9951557057759592,0.13520026878435243,0.9782184594967197,0.23734684772804582,0.14511666077435847,0.8268684334167108,0.9640250053745938,0.4028796788385052,0.4359199489699115,0.39910571971267605,0.3746892627799493,0.35090211270662564,0.12538242952774614,0.715348916659318,0.5872868116292943,0.7456852432392354,0.07156898300360004,0.04564676161783132,0.4918270667860526,0.8540269730626114,0.5690426948694114,0.9014518158201262,0.3405869744273926,0.09925708107031306,0.9805942271298966,0.44158533749692197,0.5162463402412397,0.9526069414130945,0.06198999472754407,0.18146794455213022,0.6051854388706563,0.7725306355766339,0.3455781169715447,0.5937626692655893,0.22335693045983507,0.346132662806954,0.9950982872107761,0.8142469523443033,0.4687799006427731,0.2336028625753348,0.4172685265693523,0.8753411478189318,0.5416523364084963,0.7842339471874563,0.15011795289891694,0.16010663253500623,0.575851589900617,0.2765549326636033,0.9061038301488806,0.6721459016497402,0.11432307456434565,0.5042643606900309,0.11460985495111209,0.9524899476134578,0.6052496176996102,0.018309484249905195,0.18534347690305653,0.4582472325432835,0.5527185072189917,0.6120077112330666,0.5917193366208222,0.8272451110447449,0.157684643372479,0.06536946482092976,0.4126929665700986,0.0701409608434338,0.4186355385480445,0.5052758791726369,0.6357907784605304,0.338546033741273,0.9346655499804536,0.8413179038601769,0.1770475461056531,0.6299345982938834,0.2575714247541263,0.9078220044384953,0.4571086535074521,0.8036482261412751,0.41749574492202823,0.465365521335125,0.9796398260317303,0.3628381206063701,0.11121859072627305,0.46752073691222273,0.7104149914947764,0.5909502656417227,0.5942268461318682,0.33634414333242935,0.6557671447557901,0.6269048115195137,0.9695871763793994,0.05365236551112951,0.986681344742976,0.2642370689500879,0.3332807943578535,0.981683521186074,0.8966285763775566,0.623312587011625,0.6105222138907006,0.5109922004825396,0.04586276370876263,0.01212030603083114,0.25417204572633856,0.5285036253885652,0.42037662210394156,0.0845133425135548,0.9027281883557156,0.8879865179635337,0.8368295074331941,0.258912601803695,0.8923090729598423];
	    let y = vec![0.8884310421627792,0.6084588988716222,0.6316711546585879,0.2032071982941418,0.6387349809736235,0.6294811091199404,0.7677178901796514,0.4170233041531949,0.22997104041774385,0.7181260581869138,0.09242484515186844,0.2999895941144709,0.6206076447637018,0.7722613819420215,0.08293820566627086,0.532238333720205,0.3198761750580804,0.10944369100456319,0.3784718353227674,0.5503819093817692,0.06517345386423423,0.05666374348237346,0.9452847520265493,0.9075065937491713,0.6757321532469758,0.1576061791097585,0.542891867211605,0.7632592728477448,0.12241605872134098,0.8277786052605298,0.8247323897704191,0.6644273159923705,0.3759331012363988,0.761616070028432,0.38559475590495096,0.37645545324539054,0.2286324421854854,0.8687479408074685,0.21978937845341395,0.8489178097266571,0.3968798561027297,0.7435270146146992,0.5246696545866383,0.6476460342716654,0.22339617954730806,0.4429137341180772,0.13752129997974794,0.598392457742878,0.2976957665455825,0.38319659261246974,0.6890985186778532,0.5163196247560603,0.38253725641135694,0.06761280523343749,0.13347802698156996,0.22478395892905123,0.28520109607856425,0.5649499620175291,0.5710374818279355,0.23066296640102035,0.28400750296197474,0.6229919389280693,0.022652546645517524,0.7644186827605083,0.2593479473312351,0.08325194133444558,0.5330863797582527,0.02726490083423072,0.6263181827073344,0.22294685660063263,0.49607010168200816,0.8105378917205628,0.3752730709921608,0.8296645467460059,0.7788084879832751,0.7101279414630455,0.7815472813251926,0.5859941201390485,0.703162091505131,0.09520192590478971,0.5183319868700389,0.8416258068653142,0.5145478367169207,0.9352020112212306,0.03399602878025276,0.20070075206424154,0.768442232802094,0.8076749715108308,0.12228041658975508,0.16383696374100143,0.42661969301910463,0.6532473800735883,0.5248339869854993,0.7579705536182016,0.2537656525813441,0.590788602959598,0.9943845792435693,0.9736014698147772,0.7092376768029011,0.3283691988690681,0.8545173905545719,0.2546661551652488,0.6474829441132934,0.37173738692979585,0.7427600595632065,0.9343432645260321,0.34091976981214966,0.6448455791487414,0.36248555087583756,0.41932136187187563,0.9056818086731064,0.197478498120906,0.6456710204591971,0.3757285223545702,0.7287782740092338,0.06465326392549298,0.16480519767985913,0.21305814153451708,0.4902664857984136,0.3539022500708652,0.09533457881952967,0.5619817996994364,0.26408122958532343,0.04239954954016578,0.6660172796824121,0.6419558517542268,0.41244444072571895,0.705625553689574,0.7902515023824072,0.7588782780231221,0.7940340653786356,0.7124736575473106,0.5308358024423963,0.4684781040793744,0.18731070052708854,0.3381792025126985,0.14276096214573653,0.6376791058504678,0.2883154438324791,0.08771622849790583,0.4890148827014478,0.017328324241626225,0.2605764496573446,0.5992519238891658,0.9085799131865222,0.6326526484292163,0.21937162121600862,0.33272736392863456,0.7483150575446054,0.18700698550057948,0.48177082158916384,0.5517342939878542,0.8768987748909538,0.3091891187414174,0.383512711246082,0.18122030123977306,0.12814259162262642,0.9023271729411793,0.2187533123808496,0.330122195832214,0.800659118516807,0.2759069313851342,0.990394479722776,0.15983546376907654,0.6846820486616148,0.9461889003228775,0.6795903820465969,0.9009866398219621,0.1575726486294493,0.5286456899154363,0.8351434876288223,0.6682018692398166,0.6656378059699692,0.03470845007693235,0.1487012046413022,0.008077193074989553,0.014346684057251258,0.03302990698331254,0.1813925444831037,0.40592330354002604,0.650955465693442,0.8895762957658553,0.6362117648818124,0.645626969734422,0.7190325122769735,0.6009392658848415,0.8119031250822247,0.2901079903205981,0.2706564685779558,0.020176756457857548,0.39387819411027836,0.4544190649369627,0.48664033405441975,0.43790556877458453,0.4936289793501579,0.702992689597873,0.11691711060421361,0.16492533505403562,0.9506683336822682,0.4660607736980411];
	    let r : f64 = 0.011499567705165806;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_10() {
	let x = vec![0.5476872148545031,0.04159476598491052,0.7521062628594876,0.6939271092306487,0.4639531616880719,0.8069482465597861,0.11883178191733279,0.31905772634654095,0.3027975457547305,0.07671449106855122,0.38044973015172423,0.671985202445397,0.5127295162828357,0.5811133578673865,0.7759390450529691,0.8997832959009299,0.06879390615281511,0.8548074266537818,0.7206480528468243,0.1754756645819574,0.1689785215904721,0.8098045178444391,0.649085362741309,0.37921001007942534,0.1321639451250275,0.44625239422176843,0.2720223891676138,0.37616954898133437,0.21224951718132068,0.6234337331243799,0.6206285298884814,0.4334325660411683,0.315804137694884,0.546788658159277,0.17056991584732462,0.9608939892594031,0.4318221303879285,0.6028290290197258,0.7437157374101083,0.8746049380178912,0.22262576961578884,0.28966101396467014,0.5575319299169689,0.3064282836655632,0.7630954224295329,0.09806446187669238,0.7550253743839281,0.5354934540380986,0.6762824678784232,0.45243719646582203,0.05833714374538923,0.9731788659345931,0.3093604254326465,0.77507257593248,0.8662796912297147,0.3158192822247017,0.8114267336403637,0.9567414073664117,0.28382053829411136,0.6061927781963552,0.08150448267509458,0.703439619521785,0.3473684415279107,0.9249931685626241,0.8955214854776036,0.6636937454206588,0.9306393101222898,0.9005939119233615,0.440495648325011,0.08355962751074286,0.6932634673515958,0.006837785657553885,0.32941764986483213,0.48028470606839446,0.05947508742357166,0.4474741841136657,0.005576883715339376,0.012931978025483293,0.3611134902436387,0.042612948453406685,0.08033530795216048,0.6396650995792372,0.3554369333506039,0.4053839409883939,0.4580730492815154,0.4834300872495232,0.4108167261347534,0.7809743991702275,0.047008358110400494,0.1167723782828003,0.4870950746135868,0.9068469303277465,0.7519406825504807,0.7918760371408831,0.5826732056182918,0.5181755317209084,0.7668740025119954,0.2209606516353243,0.5785085783628023,0.8948972071951952,0.4757528302293512,0.6121817784317475,0.5972934485145869,0.5426202410898409,0.8968442741904407,0.10556772176214968,0.17432415480321906,0.5883841367233725,0.09028172806912194,0.14438205646122215,0.8202450894538281,0.7900572259984863,0.7127391187361881,0.6024180781236269,0.35266723813840006,0.563427149147088,0.8211530668257818,0.8456236017296536,0.45907356787288967,0.18529551029851044,0.6195381967515421,0.4554950874908783,0.05528451855208805,0.7182528290801855,0.15471685824707415,0.1120247860017235,0.8254740737250876,0.8257319712422556,0.43143815355026527,0.8544980401391988,0.3204224516387185,0.9511059083142294,0.23553807186566778,0.2622881661791119,0.2846481691642162,0.08629916558704775,0.20809836602354892,0.9963596188076556,0.7020950095072107,0.5982942543531946,0.3924935788393119,0.7673422867189519,0.32485338023755617,0.3629626371042458,0.6679715849365581,0.9428139568481828,0.4185004960977572,0.6233731644855327,0.06821709227471362,0.9651371642852838,0.880685942402603,0.8283750647787065,0.7785533642102325,0.5135799032466571,0.7293573111321421,0.14187505463941608,0.3268004129241503,0.3621485429297917,0.8560448134582562,0.5086078240558182,0.4666594926084604,0.502336660974882,0.014833226087380691,0.475151861170637,0.49294719263625364,0.5327439138426945,0.9022080457920288,0.1139879312169979,0.9680142169998602,0.4342537632958402,0.3640431021240841,0.2680201716527346,0.8585533060095151,0.18656699727540038,0.3168479685724067,0.4264166925549254,0.3077565169652997,0.26595785289493046,0.8943509980549088,0.5773462368599496,0.9901787360624528,0.9152789874513614,0.23356704311825793,0.5696076810305412,0.7541481805479455,0.9832308159360399,0.7332387738659258,0.9129330296594879,0.896182432374345,0.2717598926746989,0.5898999551996306,0.410411680904906,0.7227218890964071,0.715230717189853,0.9989007101913827,0.6117740583357529,0.03713829281137693,0.684604304862988,0.40857822046280423,0.130767181440554];
	    let y = vec![0.4642567524644281,0.18696647213308681,0.6124866789279023,0.8867325748007531,0.5466015900945748,0.8716040884747654,0.988804548460166,0.3619729044910097,0.46462901222091313,0.9332596245243739,0.11652033456566735,0.918431780388891,0.8756226003806289,0.9066311893983178,0.6106958448313637,0.8819275367207013,0.7401975883542481,0.9457808940863195,0.30812835231459623,0.9044164300784303,0.29563256724277087,0.6669325696256927,0.9845818850296141,0.9970553108573061,0.39181609150046226,0.7234923789490606,0.20919273171623576,0.34447059856350115,0.2592370485923411,0.07446321034748604,0.34820563509973346,0.009818074261593424,0.6280968279648071,0.6434319862071415,0.33452029002009487,0.5551940107879206,0.1328139206487985,0.1392772148820981,0.899918641817542,0.09363399001217021,0.26638950259032745,0.10084951875930459,0.6729709723921727,0.7677320819641237,0.1427092578950382,0.48415564001078504,0.8893082163779057,0.42029901182566454,0.5678711610461192,0.23097083336000457,0.23073717262587812,0.5183632192985099,0.11695584097902134,0.8126443509333672,0.7519600259859318,0.42848768806567183,0.15097646485660188,0.23369339954659785,0.24158890229114505,0.4158542776770915,0.3687339073034227,0.6654577670831764,0.5101063744758619,0.9918624175647095,0.9422263121746575,0.5361690710268256,0.3178760341823331,0.9464354840968937,0.901884103936332,0.5457249734419822,0.9409550383293925,0.3345359711395919,0.5632822885152481,0.01866630422360349,0.6581281208573635,0.8274656827844394,0.7842065298431552,0.3504888357130902,0.38148782265688463,0.4551699115951747,0.3332670420510958,0.9431738228133483,0.7124915578260247,0.7059673431282188,0.3606845327478887,0.4053555137497884,0.7352116440830894,0.5828224395428026,0.2983589845901623,0.6472088580354964,0.7663027977911471,0.7895065804872398,0.4949117036410313,0.2054179755150679,0.033545676387043866,0.30170349903651983,0.19941805302406024,0.21436788797020667,0.7005197746261083,0.862420239194514,0.2668167376042603,0.5896313850649503,0.4161256028232614,0.2781544097860761,0.594039524728345,0.4080683478688204,0.9975237902792873,0.5891770559077361,0.36148694973643836,0.7558585119054531,0.8862472671670035,0.14388984547151595,0.6708377740644834,0.48420384704558306,0.6579251203800605,0.06303592009925996,0.3440985573176768,0.11859053195307878,0.03307572452484875,0.9434415495354022,0.4199609885841661,0.5368291717768351,0.3090205995555113,0.041509135995873914,0.6734403835442019,0.6874077542099124,0.7935443488151311,0.4678795207540428,0.376625868187089,0.683239736415821,0.5394588472564208,0.842661820139281,0.3725637374031192,0.27739299526248773,0.2416847865695292,0.3988893054096697,0.9044386703983514,0.9584987718861713,0.9215259378929382,0.11604590276823112,0.6580650879046506,0.608873767889483,0.06626346806735472,0.8116030720609305,0.14905630231297062,0.1649919616069041,0.4955390367548652,0.01760346512118438,0.8660639854590899,0.508161352370856,0.751511992227882,0.1417813187200906,0.9399534742877156,0.4182929701615892,0.9905223814924643,0.7924223940178712,0.7841092457916488,0.4303636008417481,0.2486809504742964,0.30916068619374815,0.6278517667704132,0.5470959591212676,0.602723080110201,0.41096844132242993,0.00785199738849951,0.6480891996523697,0.4952927370768898,0.6811630415879177,0.5636508840108106,0.5436596902265642,0.053751393095877065,0.019312787107057416,0.35999805530803386,0.2969783601015006,0.43509845590415464,0.8545498043827275,0.7870505897264994,0.9393859056259537,0.24928524707507405,0.6949559432612938,0.3059469029783144,0.8049783447888542,0.15998276733000805,0.3640493993499596,0.9451529493465816,0.6731581765767746,0.11293703697548252,0.7608196287763674,0.6204519591854132,0.5026629815707705,0.21101020837282247,0.6552193629446323,0.4929237111180087,0.5696600796788117,0.20653809118951927,0.6001596568484356,0.12187483636338248,0.3892138961158058,0.5066463054081507,0.004836926003983222];
	    let r : f64 = 0.11115861045974819;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_11() {
	let x = vec![0.2849966854467699,0.6752279059640351,0.45368586114829657,0.13280324532726306,0.8888313341803538,0.8222074868939321,0.32004127689806017,0.09322789425347955,0.7803860632265202,0.7034440434584306,0.39156945009584765,0.3742859471658927,0.010804439721289416,0.7367595600223138,0.3189219258725542,0.25455215742050985,0.01758868415650683,0.2100445566415282,0.7162562623991674,0.25154058251261835,0.42839630598936873,0.5979673172420272,0.15558262014436286,0.13989190524440076,0.7842534553102287,0.653777770158274,0.2821262519933516,0.18740940888158242,0.9995821655623787,0.9942166912123338,0.05099108822531784,0.33320121646839573,0.3390588939802379,0.9627316267720302,0.9718649569347606,0.616799737196712,0.5358041387678304,0.5594657625205774,0.14613069403312107,0.03944013486069653,0.2042218480210123,0.816175811127895,0.6305691168968524,0.009882107112407224,0.9204460166618418,0.1581722583610562,0.9460879730799009,0.3733781139401091,0.46671445376747256,0.9844762740033552,0.7263589569838884,0.6589673646206182,0.8886994620236567,0.8046516240394356,0.6325214213653457,0.08408901043592287,0.5184402361760897,0.45138694323765194,0.7891015927677769,0.5017396358501679,0.10263229481820568,0.9204433931197517,0.1777520624177631,0.274391040724169,0.3953597776725094,0.5206327895464015,0.8853456497119568,0.20334785512771425,0.21710144636705042,0.46260601310794447,0.8642400475010956,0.4201990296886322,0.466726091764759,0.2503877865961036,0.5340148719391073,0.602698798761805,0.352687387706921,0.5931297004584609,0.187352973476845,0.855226168513402,0.20035086506888578,0.9290591661366009,0.2462004468845017,0.7416861513080955,0.8165427405034186,0.4659368434568468,0.2506460435114982,0.0504258076579317,0.8804479056836251,0.9829877798754553,0.5032509084615114,0.40203974618640526,0.025628432140254898,0.6167660371540731,0.25791507101659394,0.7226725945510764,0.8867924825531543,0.24056446433486345,0.1356354611372328,0.010706367591436172,0.5409470425387647,0.4195818977943363,0.955442284307242,0.42797748855268225,0.42653694821782995,0.8805624138488458,0.6050752385245408,0.7782693652240829,0.382403745722217,0.646173585505179,0.2611484141140251,0.9458553725621164,0.5490647058834351,0.2979517564865928,0.5966765049087503,0.7290619867279674,0.12101747912963934,0.7081650532205201,0.12343270700696651,0.9604203441504318,0.1383040062458224,0.1947458888545498,0.025958997805580086,0.42528906273832123,0.9788986290635495,0.6372724954584571,0.7127993347634776,0.23165081177529334,0.3952134204579163,0.9457843609976515,0.06188298094385403,0.03892487749697271,0.915545046726773,0.2320499878808241,0.22296269125189871,0.4877794796246123,0.2489611612416157,0.1282942255661429,0.28768016055835155,0.7446504795809292,0.583741703407398,0.4975153578707028,0.23904845085062332,0.8301248485322884,0.618896632607935,0.4325494745147692,0.790364263437837,0.10571789932458142,0.11179860051472279,0.5977436693861838,0.8020668271647051,0.568614508131608,0.23525841115665258,0.887081534407793,0.39741137449409936,0.900579298498289,0.7168368570858218,0.7118883969932751,0.6316923619060727,0.9076925829377245,0.0785005002291399,0.9517727821116507,0.7734079957710669,0.5598035451380314,0.2972399336658922,0.7033809735426649,0.41528732356362563,0.8575556650460214,0.5130022971411935,0.6413217714706645,0.8250774797160283,0.11429409036074345,0.6481958316814714,0.8226412314357086,0.2702515168411833,0.9428259818729559,0.4938683861930392,0.7389062486218534,0.24427827912202305,0.448589347892546,0.8648627525906556,0.5430996979558183,0.5064093302851392,0.033035016467963585,0.6395886213306118,0.8775812103465814,0.9621488839230826,0.4468200361950655,0.9905189252057917,0.898638357226138,0.1957081328853858,0.9457361402214967,0.25346545114358787,0.62110242100215,0.7214764178912203,0.42041852892028286,0.08041932139969188,0.2515015629273021,0.49041663995972073,0.4392977535343169];
	    let y = vec![0.8397614976284669,0.9726188982563017,0.8755552958933361,0.410825495655894,0.44299182678558435,0.19316198498178694,0.6449717539296498,0.705513955698447,0.29280375060363273,0.28640870653865014,0.39127992815828694,0.46531771449660175,0.022128679017963337,0.5389029142251516,0.6527892469163965,0.35325003022434165,0.31929048068634347,0.24613193804554856,0.40443553217037476,0.9527397350845417,0.599079466308722,0.7590061806843329,0.7440601754196284,0.6544191185294405,0.950813798072333,0.8153807347082631,0.8340924913791716,0.4801964249325178,0.7662526914835398,0.5491982387927431,0.8148874789295856,0.2820217985209622,0.40462476729509855,0.9534190816243563,0.02262179716811419,0.25146587977664925,0.1758675869117281,0.3803113205201325,0.527771908171413,0.1650326653205072,0.35336376360922883,0.18266086776713963,0.010183336558003964,0.7508638942823719,0.8991558917117396,0.5743722398756634,0.45407546475111626,0.43853262465634124,0.7025080107143327,0.5473923889968271,0.39527696431761594,0.3786023490874967,0.5444859049267763,0.19687653954661755,0.9372023378924672,0.39151420167936524,0.6221730240186164,0.12661743795947378,0.1158361106939444,0.8570442796449462,0.9792065152277897,0.3578767496507985,0.7118309935964026,0.31268704024693317,6.235017982658686e-05,0.18762235861211807,0.7184453422862926,0.31845755263049635,0.461417278847704,0.744921866130057,0.05409435048577205,0.565921544777867,0.006668321943526179,0.9007269403693671,0.7485484719793715,0.5507847982173188,0.365903198250942,0.9025697779125085,0.4290931248870442,0.4673056431220032,0.21570974292186862,0.13931732366213434,0.4144756683192743,0.8338199227540366,0.524301342273079,0.1803159702466104,0.19604425724807184,0.6057593483240831,0.8484462598232609,0.27314610997505306,0.6179358922991001,0.28395547283170564,0.6235338588013879,0.5135604926896661,0.2778862942508826,0.0110552574155518,0.9370731702442421,0.829162548274585,0.43520766747553863,0.5363336008168523,0.8885492564912992,0.35338157228976397,0.9578020721114171,0.617686334809391,0.218440999385087,0.006488592268316773,0.12071043677447013,0.5883650056352121,0.43991426354513297,0.8012094421730263,0.22016788154247047,0.13486693123504867,0.36119620586174017,0.21814020024977554,0.1445408202399726,0.4537580259653813,0.7601980318297855,0.06335686887036374,0.795405936701228,0.19213833329459573,0.3655382807346207,0.8567020045387878,0.752093335534964,0.8009702521222636,0.19155623120214316,0.5367993901479277,0.5942766172542504,0.22774987164196425,0.8938464315689736,0.9503043896579491,0.11676677137403146,0.40193092306703126,0.6671533344659929,0.05635763087817203,0.6149773490713837,0.6246087990386643,0.07677585769947237,0.8288611830423255,0.5920332378710034,0.08677572161256686,0.5296451609675705,0.45799401082893476,0.9054331130534395,0.1611072861538465,0.7675712345091981,0.8967168574655916,0.9663320073251924,0.9540087440810882,0.38553064886192834,0.3621017946062951,0.6428190894928194,0.9245144441820873,0.8524141123711627,0.7797213816056967,0.746561503351901,0.9757166485394303,0.6477889689159191,0.9604537106133237,0.7691064635815785,0.14073112219475192,0.5512098692914592,0.5334088665569503,0.4673499365320054,0.7556655720412417,0.1660507844245911,0.20945448445321124,0.40934158365429707,0.04046614394922199,0.2597530337330116,0.7103043673543689,0.13881206123939827,0.5330609050705883,0.7453072463238417,0.8205868740339566,0.4290141562759401,0.35770542403658456,0.8871352060909875,0.5314108242291155,0.051257218620542,0.39708148099532437,0.7738439330741105,0.5280969491526326,0.1403077011405598,0.09967511502486781,0.7025927374793427,0.16955942576173244,0.7251766584953729,0.73622556649321,0.7937438213582118,0.9172980028885088,0.5140657761108824,0.2620011905381078,0.9005908542953395,0.22444886489850213,0.8615264379385006,0.7708713513858079,0.9223762049176786,0.6498363235316095,0.2949181235102235,0.31538473795473887];
	    let r : f64 = -0.020539240603820688;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_12() {
	let x = vec![0.3555619008465717,0.9317528166741132,0.11056316383802245,0.7829792452561103,0.9059336150825626,0.3267526647520399,0.2813213365854975,0.9569749316401173,0.4640311693080308,0.04591111656963798,0.6143067492621836,0.2618358492847226,0.9100185709293201,0.2115390016168479,0.5800601019185891,0.21973054688712224,0.8077341300016319,0.12435614152559515,0.4428701828116348,0.5709577313786532,0.604320535331459,0.1646766512768657,0.34137209012982617,0.09469547646575693,0.8745576510697973,0.5736461105522388,0.6766936281595692,0.717138208609453,0.6974880884818077,0.8782000486457805,0.39870895883778545,0.7103754949418615,0.4531253548780301,0.5072748742203728,0.25653356953437656,0.7708267090717943,0.18981363309049526,0.32343845774782376,0.7269578747602233,0.7000644872133912,0.29606255636433754,0.6606931924292654,0.901100998213437,0.1016376097374524,0.1589358833066643,0.33241973338087716,0.203025679677443,0.20048123213610258,0.13599986402006214,0.9991622186569362,0.7007904456326424,0.7361380143514513,0.3154243463662817,0.9266554884240943,0.7339490873066985,0.9782423901423425,0.11591909019640378,0.9140651503850571,0.17126898540229907,0.5172436431490811,0.17950590804379984,0.9060086631682863,0.879420132625364,0.20780150707926293,0.39924307679880744,0.1877177551082042,0.3415109014643064,0.7801789098795384,0.421866350871101,0.4071095039019672,0.1408094803362222,0.8708540809812592,0.36047913429117695,0.43202826030674235,0.06301400539638824,0.6289056297659364,0.7325780059540796,0.3865295307432721,0.8457398541700604,0.47597539328232563,0.7607103940972676,0.06347883830639367,0.15945155955329227,0.738879843647765,0.37537429076545803,0.6680621971045719,0.024480375277474486,0.9354541518396793,0.330616427223395,0.7807555972292303,0.580417863471542,0.6564340905772249,0.9939095383030699,0.31872801786691385,0.367648441572735,0.40331621786061944,0.12989936875220076,0.6860357705712059,0.9846884642424246,0.7709046876463718,0.8536172157400732,0.6694311215262898,0.4469008246661921,0.5720498572349543,0.9253947368013946,0.6757890789982731,0.06718968696483874,0.45747653274956346,0.18841567195894993,0.04596981507720388,0.4150528910347214,0.9708798401858127,0.4409772223862597,0.6702096980405016,0.4882726054170562,0.17009453981081046,0.2020599356184224,0.2436050402567742,0.643199343935166,0.6115721117949325,0.26782181580751774,0.6953072565302351,0.9937175181121957,0.9894385223350157,0.739024883361056,0.3858544735211359,0.08488156547106074,0.366842391942538,0.971425947186994,0.20138334704738603,0.9403525833171613,0.30171952351143894,0.8025194732259168,0.06132841055942895,0.9551575083888361,0.7725107807204422,0.6143831388224444,0.07071481774718003,0.8242317513797863,0.7274226289243738,0.8928388181232636,0.04175311821210803,0.8304268823057066,0.4550896571570642,0.9854073918377929,0.13576704774889148,0.46116090487911576,0.16114558284747726,0.21979624442447732,0.888200286088648,0.6098607760910805,0.5770614662408245,0.12559376499022867,0.13717780247641742,0.24872417891824128,0.7404263092155905,0.6314234613223132,0.5207300828752458,0.45679612370220657,0.6741807682474819,0.3620745202041231,0.5565634167352917,0.9438249210796398,0.23800272970527847,0.17694638200919677,0.07872333281930766,0.004290164641946981,0.49549943768382554,0.36271147595393105,0.7528131713468867,0.5714928411210782,0.47426183723785886,0.300661536589212,0.396708076853444,0.9470038015108322,0.4813692430443064,0.668145127900822,0.45546134792978565,0.8137691342427495,0.35392208630391764,0.9340531511801846,0.7980272654942199,0.5456048532266952,0.4909695393856587,0.591897855493032,0.9104346169770002,0.47473441090252333,0.13441990963113137,0.44983011823885277,0.034737085610209606,0.01868953941189,0.30815929030979705,0.11789116256438292,0.9795544009150307,0.6352832027139281,0.9934080128865724,0.3506660512498121,0.43653223545363473,0.8242663026016034,0.5031959563678241];
	    let y = vec![0.7937775908411258,0.9968130707539852,0.6152889506497325,0.4001744963351085,0.8629657174583224,0.5982536939769229,0.18966658711413376,0.4832262439271475,0.05397257742681327,0.7199758921389098,0.17385968851677314,0.9342498086292084,0.7718525789669595,0.8523494245640963,0.21708935900203175,0.15925162872397758,0.5452691392223816,0.5393861832148155,0.5692784002540644,0.2540196871949172,0.21021457351558592,0.16079523147339492,0.9496098201186995,0.4012037012668158,0.4616279444707879,0.6672147853956834,0.4333968917657187,0.20659806007184778,0.8101823696398275,0.9084268449195753,0.04877276351053039,0.5796565686081556,0.9408842078500703,0.36549914001210293,0.39151335541169785,0.9019870214841174,0.1402377500366574,0.28434611034109203,0.3593237068594608,0.09057076506487194,0.6017245897217017,0.6469764544019194,0.4736505283155481,0.5215590943007736,0.9527052664104024,0.5588497763163113,0.41373625690428817,0.7226477469476209,0.19832628711509326,0.837990522705753,0.19271291545792624,0.19741083419208683,0.6875268677222589,0.38779566650608344,0.635722501494885,0.9458312299106348,0.7721648485545283,0.5182908436843503,0.31479897580845273,0.2070970496583293,0.017519280823101835,0.8532249739238019,0.2679664433360379,0.5394612815846647,0.04429874511391052,0.9563500355310064,0.14692197677396945,0.830591483616915,0.6489982675042689,0.10351599659281707,0.6360154498156142,0.4757688247039664,0.8723441379315899,0.6504689935724517,0.9280482456959513,0.5183026503224489,0.5480526277783699,0.26609576335931895,0.761427694280149,0.04590076740357241,0.8274661091268466,0.031457415821400714,0.06439434604677796,0.13163776998965637,0.932040979834996,0.2117244095350015,0.4640221610756796,0.1552594592575829,0.8222312252183143,0.9446906157471358,0.5565068899663134,0.5390290330167283,0.3372842906106205,0.14175677250530005,0.6270535922713355,0.25334051556918336,0.9847051468443043,0.280945151435418,0.6270104625201086,0.13277810117117772,0.6117939889332566,0.6719869512997059,0.7670731367699024,0.4419452443591534,0.48868419746048086,0.24745871793213425,0.9540541924593412,0.2547715682415017,0.9903895315868855,0.9435608686756959,0.05965995996423323,0.24051321103879064,0.4621232715483784,0.9232855186759586,0.5677245887125976,0.5585825394496075,0.6492770810300553,0.06332880942343244,0.7348494033743675,0.5548399314630504,0.5394154102245015,0.9723757832948045,0.5967473657620637,0.37804313305590687,0.49605704719336885,0.4431437128553575,0.10979491359246718,0.4304576476515747,0.9087408381265608,0.10151742102992178,0.6375143055601479,0.8025119019791407,0.6914862150472355,0.7167299210356844,0.7179623614663588,0.8378535149227496,0.8856451144321844,0.39061806307301616,0.892179876423041,0.04442460915385926,0.5222908226441901,0.13056434067293665,0.39358636121939417,0.29486559950710867,0.3827685800607421,0.18805878013809174,0.15598955983640628,0.361953178211453,0.06414955275819556,0.13234526240430522,0.5418062023796969,0.910859683073712,0.468683485150466,0.12069933992772053,0.25033962641116947,0.4625507436541737,0.23404545403759547,0.4474563780420775,0.35409435845946635,0.32560316084292673,0.18823385359140377,0.9242743959681687,0.8934336563995713,0.9603336666671468,0.42958848831937924,0.5158925979869639,0.17526978943248805,0.2069232324039656,0.7161373299328219,0.5301379065282041,0.7634005319063999,0.11439500436218841,0.8892383702345411,0.8588645063407954,0.6652418647801784,0.12400382769839269,0.7993349774365585,0.7161241388319252,0.5389422070155886,0.8457699150145369,0.48183130822048326,0.7500902176542471,0.459072717088563,0.01781014990836549,0.10019882255954782,0.35811692793850314,0.9105417521977118,0.5029979272569769,0.21657047126914009,0.47557010099297947,0.7078770557776287,0.18711169593202726,0.0012903986856774852,0.056822654450173204,0.07687162854479646,0.56210876690354,0.8890403071490793,0.912929650794388,0.8814358565434628,0.9162407464830905];
	    let r : f64 = 0.09592823890870503;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_13() {
	let x = vec![0.6569004260851552,0.005629072905469434,0.6252785364092592,0.8807522696894919,0.11692644489086246,0.7881619080213242,0.8713974191728939,0.15220549580559228,0.639714415605309,0.6286289491176619,0.5677943704966462,0.013042895650373643,0.3132680284374678,0.6722819028270578,0.8831074647429907,0.17847924986900865,0.07311913791260383,0.06574938954750964,0.27985285069649535,0.2777224098666843,0.6133157893340709,0.8314336793019556,0.6795769733761248,0.39692986026158006,0.318572841997229,0.060611531140417396,0.5598237501932385,0.44868921093998315,0.6558185545224756,0.9275077032105825,0.8606805668701386,0.7571426151322871,0.7833047177712175,0.5808669954157315,0.8746998357921199,0.7923293052946712,0.4053820205348775,0.7658116278333578,0.34161221981127554,0.07062971873361257,0.7950230667564814,0.09651508522389562,0.809028599324913,0.3523934130018145,0.03411252778221896,0.8848813933713373,0.34363841984512355,0.3671751456076926,0.9471313347308105,0.39299927423974557,0.6374187626775379,0.6309281641038876,0.6247064664408825,0.11322528533804321,0.7416956628963066,0.6620578208454035,0.8981876545177729,0.9034277621586939,0.9763964798098572,0.2331930606431859,0.6473914993804663,0.5859162647315981,0.6210959439325077,0.9649995226783155,0.5206333869486214,0.8976104344482885,0.4648477107364034,0.21293241566464083,0.013702959745528709,0.5365380930885649,0.3003574573747866,0.33593330170331615,0.28600500567760745,0.2206105133268772,0.4063243246523416,0.4285524008947629,0.5643112165279878,0.5559900754565923,0.8659157772649368,0.8514281593374454,0.27960357384013934,0.4584314040668407,0.8161418213449005,0.6754390473048295,0.12814206495175928,0.9518077061660476,0.5172680542051856,0.7576343505804827,0.12611785586896418,0.7316980502550555,0.5054427249081962,0.2237303826499375,0.2474476469565754,0.2276486235592573,0.4439816615230616,0.05218363143945581,0.053009880641527674,0.13157590387186968,0.676410784152527,0.568013387455371,0.9687241285621018,0.028316133676386857,0.03665603799736039,0.49058055050753513,0.8446567719294125,0.5577185924835087,0.6631554822313921,0.542150740003947,0.262402360172013,0.5778305875582839,0.6095998623296802,0.30989757127380513,0.8166924747026846,0.4498540383764834,0.025635829304272217,0.5629621977826346,0.5756813925511506,0.2836135341954441,0.3064349609706055,0.4934588326797862,0.5919528634993222,0.3295755807551417,0.5972411811759194,0.10845489962592259,0.5069108977562804,0.3536993775669509,0.1221551372277575,0.347404510751972,0.1927831391212106,0.23653696273198133,0.6785377637012504,0.645772623202906,0.5269287679600541,0.14813867496868804,0.3636741965877175,0.9055505122999397,0.16554279677342798,0.21047708886925387,0.0677160254134016,0.7100605545247061,0.5918233650294645,0.23989766553908964,0.41269732918920343,0.1701331614378614,0.13660721791712827,0.15046148123897574,0.8692581424788637,0.9511152887223093,0.2873247908437945,0.7461178925491191,0.9102662322434291,0.8968080946908582,0.5485877292351276,0.6494700405813083,0.6411079888318412,0.5040246131468724,0.4212846762654995,0.36726427421205976,0.0309070286350146,0.7992037186541524,0.13063011107872302,0.2229997124217017,0.0323909888040087,0.4126151780412951,0.8010556535818354,0.18471597936914397,0.9795318616834945,0.6425463869962685,0.774370142390454,0.9171950093027453,0.029741745412595555,0.5554915472223081,0.04321606785021992,0.9254632659298666,0.12477243724772835,0.020200900068399696,0.8298249917246011,0.09157627611574815,0.7143897487500543,0.367480715376425,0.26719876512467466,0.8269914570052136,0.22679279950006836,0.38176983292323796,0.5951454812135019,0.486814637716956,0.890927528831561,0.743617212709817,0.9845469668249193,0.3419207354305681,0.0559078534150651,0.6954264777067074,0.32879262336025894,0.35890914736416424,0.16651166059773803,0.8079582660687907,0.2399408445455855,0.30240174795042774,0.18275116797348534,0.8851077374338909];
	    let y = vec![0.2109802518795233,0.3097938582305515,0.7669221919768879,0.9985394071739299,0.004388370240656192,0.2349432532876501,0.38520466736193604,0.14730889383594892,0.35604865345875936,0.7576019557405411,0.14340810466822218,0.8366949132583595,0.9803039805096105,0.43748902360960173,0.5136928297738353,0.7855425549201979,0.05440844126967004,0.6556794529608521,0.12208453300505806,0.6605614580185709,0.14468040558826079,0.5279585249025376,0.06444403003629107,0.3057343583208665,0.7532009298752359,0.4533400810248879,0.29212096483640804,0.7120737924512458,0.07809258009651454,0.06572102190792806,0.48716427752819913,0.12500023641619518,0.4854572915049209,0.4404421594220287,0.7208736909450448,0.03426405959336265,0.5760809951606399,0.8643074423027155,0.1566331767318686,0.19286198561365675,0.4955517573466175,0.5723914568578143,0.681892160145929,0.8767837959493748,0.4555961317562448,0.5516092957936077,0.09166674713374956,0.9032222988634401,0.7045147915952789,0.0577204968187186,0.9148343170728651,0.9563007865363876,0.6176255870313077,0.8512707575982531,0.4924448746834875,0.5508420235210392,0.3505514567752336,0.7111367571528159,0.13074133991259562,0.6396844099601158,0.07518287926693468,0.8549384060666544,0.15361276661009693,0.11907152413113942,0.18213689620387274,0.9668955914473287,0.8217405061165725,0.6863957981500789,0.3486053097612656,0.29790270146430753,0.712737444032344,0.4248613389926643,0.2193209547873265,0.33994512940957045,0.7203999572293084,0.391399138643319,0.22293532424360896,0.4056250590278875,0.9870152631916381,0.7907359952984407,0.5455316460675218,0.2837626181669256,0.6663174532731359,0.5793643954011002,0.32756314834303435,0.8244780211637743,0.6758337714477086,0.2200687776215201,0.6640109434017455,0.9811508005141073,0.5264222306592967,0.49471417502400306,0.6380211963725366,0.14636795392498791,0.04916585729670786,0.2131325948493955,0.9467179660994256,0.5204297580125181,0.9314419561498232,0.3353471873399043,0.5508568465200111,0.4599319355259518,0.12454485884946609,0.8856864717114367,0.47048408611389947,0.29783442557736606,0.9209079830012639,0.543740752388539,0.9375171786164385,0.2972159916011675,0.18013048490859784,0.3587258518284093,0.006941269307066622,0.11912210204347362,0.719994389207232,0.42743206894536334,0.05990598185828644,0.4877910581821012,0.11804227068284534,0.1399877070844987,0.860761463215731,0.5301980319381426,0.48873087601882714,0.3015583693993559,0.9195626641521017,0.909527802286494,0.6377430475529986,0.142667592975378,0.34999267593874717,0.07154104294587493,0.6454293544412929,0.6749953686395288,0.08193115995069056,0.2634058622843096,0.027499829061599645,0.4623892362310674,0.8758560672246064,0.5195922524238222,0.792515407161112,0.3398769759374679,0.8797026937243078,0.3710019515224151,0.32307951152195225,0.21624110313900413,0.20744017449589502,0.3359202137963295,0.5450417111918177,0.6472210293787508,0.504992476405093,0.6893407867692478,0.7433249844774631,0.009167815622514564,0.38483678374338215,0.5011101196532377,0.12223241272057661,0.14648180295566848,0.7030647935807572,0.9651983527202752,0.386602584068262,0.8107919509930303,0.5496878771068201,0.5698672391382685,0.18258071430971834,0.16256429270458927,0.779403109144914,0.15276310541367677,0.9250183047887467,0.07710975975527634,0.5181303680133235,0.5254064062230521,0.38287227803431656,0.6417841749695421,0.25083739180194997,0.739986577994657,0.7296917845650608,0.09343561882536733,0.6295788832852494,0.6209595143230644,0.48336635484192214,0.274752983766557,0.5007057809777422,0.3218418473822955,0.40893122443154395,0.058081993060277615,0.9112604670322799,0.7074971182300009,0.06674310049688792,0.9570822232320818,0.45222159529804784,0.8688526581388899,0.3715765147559882,0.4101470603627797,0.02956485721652946,0.1568703037940946,0.2744638455726528,0.4714157127341112,0.09293367627144056,0.9993703168635125,0.8501237320286607,0.033913088325543295];
	    let r : f64 = 0.10058475226523482;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_14() {
	let x = vec![0.8508897916894925,0.3409094403722004,0.698939569489456,0.7300136548027021,0.809650811613002,0.5250744036593328,0.28116450644757085,0.9721027266063751,0.6815936111148686,0.07185147463026353,0.1659351333589495,0.5091436625523321,0.2968495611052533,0.23979245897953005,0.20460071481606001,0.03438430096796674,0.2436867195225284,0.9668492853387378,0.49973238543226073,0.5167301285721664,0.5738699800334678,0.9442239984802007,0.0055159540743985325,0.24572372670496456,0.7956899553049235,0.268984929004084,0.6028028188073855,0.04777292553366774,0.6154262747222651,0.8650586196847893,0.3936122348241382,0.7926969188412002,0.7822002867050316,0.7917670640119268,0.8965053064248966,0.2756514011385197,0.838333615427332,0.1569857795404559,0.36276912331927325,0.035471024718483624,0.18015769959469774,0.5244841442131715,0.6781744268477748,0.8341247355261171,0.9891466408842194,0.9469144450524852,0.06486704245116492,0.2407652640355048,0.5028151929581158,0.7749140908048032,0.7473274896480399,0.5838096331852979,0.22860992289346538,0.13757164680355283,0.8760820935286734,0.6382025343524416,0.4785281253101069,0.574098846691554,0.9712885891792548,0.6442170057302995,0.6909949730229965,0.7222800355620967,0.4453039638938364,0.7747902391222251,0.839867128608609,0.45846273518514535,0.7739089981795706,0.8269654626513955,0.18693782775663792,0.3290082522725236,0.5015097385806644,0.9147206992507183,0.4768311610287552,0.8705514956192297,0.8445916894643049,0.6294083686868485,0.10291260540711378,0.19089299427562478,0.7631957463931093,0.0156659663596862,0.9756401934810154,0.9285558685565257,0.7130079699852968,0.6899415970804693,0.8016835673522217,0.020851383785374544,0.9541449690270368,0.690358818906064,0.23935503446282524,0.2529527360575,0.07139765766254946,0.30552670572425156,0.46446700005730657,0.9345495704179048,0.27384464829710087,0.28591185129491414,0.4808060100544804,0.5245868345532145,0.681728721395206,0.9224215798187345,0.12496300118071768,0.6454398113270822,0.775757072387186,0.5385367300648467,0.04690119881545585,0.0632586201708093,0.8976005652064127,0.8386059878399501,0.08549209141511982,0.5523041973890309,0.024143278431647874,0.6113685458548209,0.8486198297780845,0.7198020642874057,0.7619475694582428,0.12054059900339531,0.9669782947408659,0.19908910224144494,0.964185702847158,0.7978426397620275,0.24487021718539181,0.225175326137935,0.7217229447338968,0.10564901033768459,0.2289968856266088,0.7174499293751756,0.47895096677350646,0.3528796359656631,0.6727896834804338,0.0614328130236903,0.8894691275167047,0.6621094373701856,0.2988773983798736,0.15833527235567024,0.36149138494854227,0.5466194486735647,0.8768751161314104,0.4999619936095008,0.6485988101017882,0.9597743900051944,0.7874514193652214,0.20750771723164574,0.4293141442701379,0.6868409462151166,0.6550308975553275,0.953615927111663,0.7884188319150394,0.6641949415382226,0.5114084191683064,0.16726821780904044,0.49922083557712627,0.7062549779071888,0.6590044011577282,0.5415915315429107,0.1867678375871995,0.17795610262847572,0.4217069211673211,0.7056630281255583,0.30717359478307105,0.4464769126446022,0.26903093551819945,0.822681021312394,0.15465406943071425,0.6816704795633463,0.31341894244254975,0.08117159547168129,0.6052252868962616,0.8253669383051874,0.8177977809879327,0.4696113900358241,0.6394767920310509,0.9599287477257951,0.1699040273564334,0.022294472266273235,0.10137827806539534,0.8309746184892601,0.604610103557327,0.834356290778578,0.48961114918943716,0.1622334887113298,0.08395015195522348,0.7373782584895351,0.9166077791595987,0.47205173336035156,0.26627906531997025,0.824707614192697,0.42648221345827286,0.9839123626059179,0.1934131167720915,0.3672160525170135,0.6129084173738374,0.14486979699394165,0.2856891693389624,0.6055667689342897,0.7712592583981766,0.6420006019372242,0.610743849860123,0.8032319078551334,0.04911674931518306,0.6946383075344531];
	    let y = vec![0.5123390421377823,0.3816357927611771,0.36110640957179463,0.14786108760026306,0.7377891882320528,0.41082157852165346,0.06734054606290074,0.4250926639704169,0.6108387914680972,0.07540091395753723,0.4817070701577134,0.5550740668760712,0.461097871410198,0.06318750449322375,0.8555283455596134,0.014372311423860862,0.2739135967412567,0.45371300200804876,0.8054705691820251,0.29616253353284105,0.08758700357505933,0.4914281780446401,0.2608529372273558,0.7993631352922536,0.2724828255644356,0.8864513649726504,0.6086855585154749,0.01486430491989399,0.0006400717375438791,0.7603549595025265,0.4964322085445515,0.7526215140363653,0.979110694489398,0.688914627990669,0.021686157844157283,0.8002874161475968,0.16374549706420116,0.06323557526594026,0.41386781485513857,0.348940577624837,0.16810466835241866,0.8301517926726563,0.7532675275974668,0.9752984838604668,0.5265369255628077,0.4473428656377455,0.7272708156536589,0.05264613085641523,0.15989715530331594,0.3612903405004593,0.8006850279565181,0.4432150657304951,0.55655003972665,0.10286503139960235,0.8243483848308435,0.5425483574798095,0.47839683420118984,0.9280001245881618,0.33787925328934,0.301371000083248,0.4955107852096763,0.03510403777728199,0.8832336587286658,0.5785367661275207,0.47015342350399436,0.448932280755327,0.2962301621823643,0.12185240013689358,0.6743275725569674,0.8273771431474234,0.10474809936552132,0.4548889103892102,0.01888629037313838,0.4974025629858939,0.05744762588301122,0.24081646761001996,0.38045060022949273,0.44411114589715595,0.5413275715235996,0.7558972266178037,0.4047924824370741,0.45005857616845213,0.7792795335853476,0.629610607533913,0.6831099585929595,0.31277673624918956,0.932310115975467,0.3971577708904338,0.2765968181284316,0.33024880166227966,0.7602543894902456,0.6575166451034101,0.9714295562698678,0.1321877164627563,0.8823012394439703,0.6743162709437324,0.7536034137973445,0.4022364976374654,0.6328250767225282,0.9198081821027689,0.9095446418587656,0.23226106355347043,0.593356245380485,0.345667519768844,0.04665733612232492,0.9735254589874791,0.020989226457736043,0.5713979496435916,0.0897257216206041,0.1401743231448236,0.29674381507578784,0.394960097340857,0.13634764173171943,0.9537656501376462,0.9828458156513454,0.6362343926262466,0.039647593858393115,0.6857355415741094,0.024655139603733445,0.32149694726868583,0.9466328546862868,0.7458551528490049,0.3321080129181283,0.5944633325489875,0.8283416541558976,0.12532750991150343,0.28041468181473683,0.14314062261572835,0.6493827476689928,0.6630546521293517,0.8957374155935267,0.3177307540845522,0.4050713684784323,0.6873026442635473,0.9099179184960717,0.8433228906107589,0.7023464749543874,0.8079586398265187,0.9806160590587382,0.6189009695917188,0.6705248994299884,0.671666784059102,0.6511688962121704,0.8174459125108694,0.5629455956742676,0.9707374003835935,0.7526403384676896,0.6883976564999071,0.6231418093529653,0.3358398503538371,0.9643188618318952,0.3502390984888446,0.060562489911648254,0.4317991522265242,0.12277328444681979,0.22945218938049128,0.7792419376518966,0.1469185628671289,0.37909513748402823,0.8419397551388107,0.9841790121007924,0.7617130367923395,0.5438566780040527,0.5271885038411481,0.8112335466261396,0.7596356639283239,0.3539926858346981,0.4389212979564976,0.4076655466172402,0.39336766064591533,0.634209061975065,0.7664162994547808,0.6366775472302035,0.38700445638293635,0.8975181137873304,0.44930003195760393,0.16184443955100014,0.003426771902241832,0.8490562664846008,0.2335240836693422,0.23147344848940454,0.22458167702228438,0.3860427146299249,0.22673054319815178,0.6577634822011603,0.76545200169056,0.35842922740885674,0.03717128361706312,0.8926514556704704,0.12000665745735373,0.9144799667499401,0.7907647291735043,0.9480793536495057,0.7130512753963316,0.09813679751092408,0.3281142263987151,0.6232198562568985,0.28016901007927764,0.8467985170811061,0.8259071261348029];
	    let r : f64 = -0.032194664958038244;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_15() {
	let x = vec![0.5848850982325546,0.12772366258025836,0.3010091067839614,0.029233013665318275,0.8048360205967691,0.025335935711342072,0.7274771282112444,0.009538601682342218,0.8325685466039506,0.8252057508051928,0.6115720707391237,0.5208382481403063,0.9543274937314284,0.9608763470638599,0.26721354348344006,0.16144500899495695,0.01316860555786803,0.3946015231978951,0.33299561623650076,0.250130662399796,0.3566704993913,0.8441027490829577,0.1057566893077081,0.03490802950295724,0.3530813686051698,0.07478141918648618,0.42273223112451963,0.5279662861865688,0.5274174278729967,0.6631163156971455,0.39769214348241233,0.3011240171903541,0.23100747064140015,0.9252635525968683,0.2778959297328901,0.5328164704996903,0.035381297964102276,0.8912625888753978,0.7957882255496996,0.5541769125301863,0.591771828481347,0.08582950943324463,0.2518659762903003,0.7031580637774293,0.8237832667131053,0.06641228872725147,0.7183359465430612,0.3542653211826138,0.942566162275456,0.21107924040813686,0.9085280116088236,0.11256546278802249,0.772647216155434,0.34027230083107507,0.5529027774305478,0.6922029396062379,0.8472556471422804,0.5112170730966024,0.6747166086353958,0.3402982636685521,0.9525333383340474,0.24610512825896302,0.7698086011983277,0.9755530304969983,0.009527431544404164,0.9656883198562439,0.17061621201332644,0.20615534488373188,0.37150026877993203,0.6281921937418469,0.7819863632028116,0.7193224745482837,0.8084262650867977,0.7148757996672139,0.7156045610339486,0.3900756760483238,0.4111047357205362,0.27438240199963604,0.5420572250649794,0.9014874647000412,0.14044211160017017,0.9616882295683303,0.29189104302887603,0.372823946340775,0.29827516755692607,0.12153000014222592,0.29610774947917795,0.8431562846432795,0.8663392561475775,0.22620180891937225,0.840574008244806,0.7487955037254106,0.24558532783325837,0.12821295608369476,0.8634434792893132,0.053483731190138495,0.23921946805210226,0.6311981503926887,0.8239533730108293,0.050188560100134616,0.039143241055507594,0.6907503266966959,0.21720897647489723,0.6949177123901872,0.330378873120983,0.7871525663663237,0.9868125192384616,0.09908169844281722,0.1193575054086522,0.07100221448186639,0.3342293462483388,0.22702192432842094,0.4812251258880649,0.9545407022116912,0.91797461972755,0.1400012051147328,0.04016446835319576,0.26289325505556693,0.12785045617772184,0.3937359369344491,0.024760017438785087,0.1934757746355461,0.822928509095172,0.6103331578558198,0.6989709774239963,0.011251832030294673,0.5296899315129074,0.3884797296098791,0.8175452998294668,0.16177183780717186,0.10625097709839748,0.6730502677283604,0.1801150802166197,0.706740955445604,0.23613005268197573,0.1681241729582592,0.412086581330825,0.5653905506191664,0.025089790021560976,0.49588579609393835,0.032900894668939196,0.16836403105543019,0.5053385542369826,0.23252008040812555,0.07761711785114789,0.35165181537682444,0.22899968822211736,0.38723988306971424,0.9384036480426705,0.5789178915733101,0.5830583698626175,0.0942003701610894,0.04269206447519969,0.08098126669954564,0.8396215025752282,0.8923514309884817,0.8874023119943603,0.31198738529733683,0.7555452393366572,0.025606070334688424,0.9978319222494442,0.5575369739056074,0.2949167082960016,0.41357561213510585,0.8410204637600169,0.7595514766369516,0.6587750232903122,0.5762622963629302,0.7205460383126908,0.8940195657268319,0.18720279304807563,0.6468314160483472,0.8572782987711892,0.33912467301655236,0.5982283058300121,0.2125495263821524,0.5043342388411459,0.07548254587365744,0.0890689048011154,0.8031613848978875,0.883877697297215,0.47699123572176605,0.6249255098657586,0.530676978697482,0.32025610264384075,0.8120647184097927,0.22754406336424005,0.5535562490226604,0.035519497947165024,0.9361657884405402,0.2876838846702058,0.3801455834478916,0.7222385872032742,0.6788070226862701,0.30161462696987695,0.3750299899891997,0.7037147313699715,0.9580172441873831,0.2261960806279475,0.8849951206552237];
	    let y = vec![0.9943482335442749,0.04848443618239584,0.18822166564271103,0.7417072452619203,0.05899931533074321,0.9230562339940346,0.2552746797967578,0.6944615600921036,0.03921991520244161,0.039140790700643024,0.10974311663702252,0.4812873861525767,0.28523379574022845,0.6724205135595045,0.43289227173625144,0.14903680086467874,0.9656376555785441,0.3704486921908341,0.4803789081850631,0.5967503467299693,0.24036456462481515,0.6308629703305332,0.12779168090576842,0.0013356539819446844,0.7251190135713681,0.05495538248354559,0.6178280824751383,0.6468672952316256,0.015096830434659814,0.3594662628418521,0.7788978062315729,0.1993669110802344,0.8077420937720208,0.016487069338963822,0.7955510786855039,0.37505437054050894,0.3905614612328582,0.7746550004091595,0.07601553389464477,0.6002780504754367,0.08260445081489676,0.26998601981159875,0.48822706487974776,0.2685410266863193,0.14969905636656144,0.7207310501749477,0.14208533829983616,0.6957699997640854,0.6151129012996056,0.7942838732977844,0.6177047696759538,0.935162048005281,0.7922609889217785,0.39928902679961165,0.20954367661171924,0.38642043760628,0.5464078830563045,0.28146678544597836,0.030868428613705978,0.5007700501679587,0.7512410152951347,0.23630126449664435,0.3017760869692082,0.24800989151981834,0.2809540012335342,0.24429875867689466,0.45954442685302643,0.6368326342028493,0.3607572164390327,0.5707539103513334,0.7582171233803889,0.2928285882258782,0.8331553014914865,0.04758091666394759,0.16633617035511017,0.6164223378009112,0.5824066823407473,0.7561105711303165,0.9462568930207528,0.953995060287528,0.6449805270529607,0.13981456242202417,0.8424784762840148,0.8282082811372053,0.9329613286055605,0.03100642767602313,0.5436108889356314,0.3096730560931388,0.3268980984650536,0.14791007412237034,0.7160421495112483,0.7091495157561468,0.048516899847790174,0.5292400468434798,0.31779528298327187,0.08293694742490154,0.8107477975152425,0.19990428618798706,0.11764243294868348,0.6260198800435168,0.6582041202220456,0.3096559983035859,0.17583945830668435,0.8929963854853977,0.06461461199141261,0.6752302208087683,0.30633311731087487,0.9865530514736712,0.1345658753372675,0.0032216708660643967,0.41666399241968866,0.33587433281635526,0.7070358673445883,0.7984180205836056,0.049904803781032014,0.4338840609665887,0.7182783145801951,0.8518239422745343,0.9241509993030917,0.919574841588962,0.3599591483258515,0.45621856020455287,0.09118235271946784,0.5254589879658874,0.7480067952022814,0.4314951639022152,0.05612266817338196,0.79154592341737,0.10902969454451727,0.3194666051105538,0.2697703057913501,0.3507822542772636,0.8337768522854955,0.3237887800109801,0.45898480677605036,0.5643732736144854,0.30393274727485353,0.4372518256878276,0.8239376628272765,0.23461502983810645,0.7846107468199774,0.40138937445947676,0.1361546712202395,0.7966406451832575,0.40935031919459897,0.5024879061441374,0.2668123770684515,0.7785452901134784,0.6045250299082288,0.3783907431737268,0.942998606352865,0.2807393607685076,0.3384310364980452,0.3842805228310028,0.41009350741652784,0.30657265874567885,0.17754152649759014,0.19740234200096385,0.08930514542920098,0.1547660644572021,0.5141185817678858,0.7217412691540472,0.7323553084682447,0.35823580912619046,0.2153598835762841,0.13273221826320125,0.5809104290091083,0.13451696862827112,0.11154762265258167,0.9627521861688024,0.050778959798801315,0.43798458780862337,0.7150824892542812,0.1637192251886611,0.23547982930626088,0.2126039930878243,0.5198075423089887,0.023924019788739037,0.6449204735975781,0.7134372937922094,0.9071662399629705,0.4796092912245803,0.12433772967962264,0.47199072475980564,0.9158570499412445,0.3182847171568639,0.8624652133990144,0.7391879295876105,0.9920137913198414,0.41921918586965223,0.29698223448252525,0.842957555346658,0.27940453518628505,0.9301081493287313,0.753201389779682,0.21816917547460402,0.836219636826418,0.5529329610152232,0.3313128489210584,0.22211951693903087];
	    let r : f64 = -0.09655395664912465;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_16() {
	let x = vec![0.5287016439342932,0.2744833366032855,0.7882587670104828,0.21608037478964925,0.7731553781931414,0.2851682563312816,0.4157679496708244,0.7382376833263792,0.14603942805242387,0.395387237123468,0.34889041439714064,0.35936168983214933,0.3801900592482025,0.6574288219881457,0.5553448618768128,0.007876465819105838,0.8908693938284371,0.17886986708060093,0.11905125152927154,0.6208192383835155,0.8954259957307161,0.8504449081311637,0.4323627553549514,0.5167476755830126,0.5696557291829089,0.6893580107541406,0.4201227232902546,0.7255118694803496,0.2764059566997339,0.6091644773302185,0.08957390587378133,0.773999069074439,0.6356454337202132,0.6053252993022757,0.3139666572169406,0.21155518504268744,0.684311420958595,0.6717585076815004,0.23513418250317641,0.004693560070257452,0.4926165417036431,0.9838429815100089,0.4358000832363712,0.3610099579490854,0.38036344317396176,0.36948930173575156,0.087288795800336,0.5683120699022497,0.07107295557635585,0.32999923160026745,0.9628859160203994,0.368171001799379,0.530384411035824,0.10627835763525961,0.5891173160955355,0.08707819841673581,0.21744945772539725,0.3025456830668347,0.6564976313613237,0.48289118568886324,0.05918048626463368,0.2814980786685145,0.15897061547235813,0.31940038217464695,0.47926902696218554,0.15065944451295965,0.8622518483590623,0.45040179722107976,0.2642229188016113,0.776284573344646,0.1017770047215597,0.5044558894226759,0.8940185240677007,0.18528911689303484,0.7646649516958041,0.1575190261594518,0.7224872209132909,0.8357610919932011,0.18925085849899037,0.7375034686125087,0.9104870550542398,0.490638253019719,0.4425484891274891,0.5340273175195367,0.9830424251351362,0.3625427545338632,0.3871341910873526,0.4023906381282095,0.047889301580154586,0.9293509374143804,0.07782681946897507,0.9253053044730135,0.14345391478556968,0.24685681262551273,0.2817905765843133,0.07098695617824025,0.31362129181356946,0.9555548605652316,0.2806519156054622,0.8482625413351399,0.3104405219422869,0.7084997522591072,0.5515072726340471,0.28345042571034995,0.6859842269530493,0.9548433944527653,0.6987891411827206,0.7494195011958167,0.6116029787528721,0.4303511555887789,0.8139516017157054,0.16147175945878334,0.851099429152254,0.636620212338374,0.5265632569484802,0.24042766536960347,0.291755193046515,0.20603534784931088,0.20796000377159063,0.5653262954933583,0.6068415328589866,0.3331479556820526,0.829712266276362,0.3252559253777698,0.6447985007705952,0.7410379121740767,0.6028172166368583,0.9636900552120776,0.4314305917299778,0.943196018763928,0.7172195175323072,0.7038304576583483,0.7655325100250673,0.39187397789373724,0.6266515878763957,0.6770661613610371,0.512424387019022,0.695937541314471,0.43633828645338535,0.7706195425465278,0.14698731676208432,0.3827819469677025,0.8227739864021548,0.24385960887701486,0.5280824089266929,0.43240515639876775,0.606474852852736,0.08102424620032445,0.6582770635248056,0.6474502727171028,0.8063449123713329,0.08328397240069063,0.554221605094822,0.3091933034980122,0.9308687925573608,0.38195735419572563,0.5687973596839073,0.8093006274739374,0.4274143375053574,0.32981356484892344,0.06266174270875369,0.6503457113198721,0.040652192262725984,0.7565167484349407,0.1196136011726534,0.5072909614912213,0.09276931680457368,0.7982014571755857,0.2188550688590094,0.38216933573144163,0.058337990614869994,0.8092246885019465,0.29762717311653086,0.6573689917858815,0.815058488144858,0.9491492516871202,0.046668220011711004,0.6024516345013067,0.25449940122292924,0.580288702157972,0.2862659173675435,0.12266053846219027,0.40104446723910225,0.9699352143371406,0.7270379003145884,0.4294418945878853,0.479652465077236,0.11626004786002231,0.5736894879089321,0.06045173062418907,0.9899741085014435,0.2714488568046739,0.8306982584018445,0.06457641106976997,0.5875613763654474,0.2947343300350289,0.7343574618285201,0.8871163913446384,0.4019676364418838,0.29514673970276484];
	    let y = vec![0.8669410478007344,0.9416572373479255,0.42062349921401954,0.2489128352134411,0.464876984822744,0.24585471923907942,0.8787386691088521,0.3173206277853401,0.08423723173845987,0.8193544806545118,0.47353686784875093,0.09724507821738904,0.5420155741052674,0.7903488039719712,0.9630635070416852,0.993847218591274,0.9558551192895044,0.28533194316221344,0.37234738941972834,0.40860756575980983,0.40951153043129007,0.6163202181002875,0.961893108976822,0.5514637759340714,0.7592863626853793,0.6655793719194001,0.40957475999806003,0.14201256778666937,0.18304856264635194,0.9370060658505595,0.373632160055024,0.12801185704692364,0.2768118270000315,0.3132500123526143,0.8316088462612861,0.16606123959657915,0.36210889049516926,0.10626198890841443,0.8633200847058323,0.05733075626557993,0.3882450478161936,0.5125133916990837,0.5270028572345274,0.84931855080218,0.2375221120993517,0.31406142608194143,0.2984810068244699,0.5969169982755904,0.5065641368778925,0.49603037611201384,0.7973003955278073,0.5968372180062206,0.9443811714843839,0.07725737780815745,0.5564573651965405,0.8753801596014701,0.8324148354557867,0.23076366895335898,0.9634313514712833,0.9278730225588118,0.41902933916871865,0.8568281457685678,0.908953227516759,0.11835812674670465,0.5645018087978574,0.5055383734485556,0.1805896347492001,0.6549106948387681,0.3125094193435465,0.48540004353843835,0.16322640778571795,0.43301994065615035,0.7954972698377969,0.9128820646216315,0.17740722787779728,0.731551955757827,0.7587425065691921,0.8817748245017671,0.665376401650054,0.9187689104298816,0.6140475559058454,0.10231934627222783,0.3490789890771818,0.005348702819111262,0.2192401766388109,0.3724556228750775,0.12787981723047293,0.5391824961608971,0.0897111096462535,0.23402694791103262,0.8378744823205169,0.7589015438810811,0.4369638603990057,0.4518799785376292,0.2537029656908354,0.3016031781789439,0.8311664452185826,0.6142241679925068,0.15025421988693188,0.07879719308926003,0.11151038209445541,0.3791030511597414,0.5301434258073305,0.9836295180604977,0.11710831259954835,0.15984643105750074,0.24288447077253228,0.8647054773468341,0.2268270431704663,0.5001831174574459,0.5422564346665469,0.7171573831509364,0.10971558684498361,0.5081006806037673,0.6327498305405257,0.19408463764576156,0.5556195596327544,0.13451063435934818,0.6774331130802907,0.3321531546308196,0.5312499725311056,0.14283779095339222,0.8729488371874901,0.3219022504779847,0.08910493691222376,0.6549449257164806,0.26878145477373305,0.6698265648106134,0.7085309884722909,0.9226525688749815,0.9390120906916668,0.32241915218749606,0.9288605259750681,0.15251435954644965,0.6120251459028359,0.4804849071361612,0.5231167794670768,0.27883201783352285,0.17924878435241698,0.740920905998313,0.4384660806781373,0.24572865632738217,0.6810453484325569,0.9611648223390503,0.5399729195918912,0.033306233196763846,0.5233997778010501,0.09681915004151276,0.2721812400547403,0.04485429317517842,0.4264666051444841,0.9063638602493661,0.12309470961727864,0.6905549193443126,0.9013746915465151,0.7222383264213178,0.5278957183046092,0.18822273457045913,0.8172171758470944,0.27306715245249435,0.23549384702649945,0.4715043734100043,0.7334432106927594,0.10102211119223214,0.10211789932511717,0.6669252475626808,0.545597118101147,0.59090688692345,0.9160221589354857,0.8894564905840576,0.22883007470072791,0.45954977597087576,0.23029215524925373,0.47426640880478166,0.8658037408448164,0.8033619919586965,0.7621514200665204,0.4671618723661555,0.8681634333432803,0.9134795241983659,0.990790652149516,0.6827343490535046,0.7435160477498028,0.6869049426478806,0.46760703354731503,0.3875846077488069,0.6001328264082099,0.9459226333781234,0.6812882903305428,0.11219395072376492,0.26437440989523875,0.27582683544650766,0.0989442549215892,0.8320796423452129,0.8241934115880866,0.5863483965454297,0.13259009539195465,0.43218849134221016,0.07491104304169682,0.5670987000203769];
	    let r : f64 = 0.03138973527288329;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_17() {
	let x = vec![0.41077989153653416,0.067951840476007,0.32312692349977346,0.9491950529316736,0.6493841826940987,0.6019126549815582,0.4140078906892618,0.6246186504654401,0.4036662791902633,0.4348122369806129,0.1443237847983777,0.06799174916792639,0.7149962661133293,0.2324396440696216,0.40495880194194744,0.986628632166677,0.19801332815842188,0.1884289749879997,0.4049307177110494,0.11004531545548246,0.8727051145464623,0.27922360403357893,0.1860981105429641,0.09275129734902832,0.3530452136655513,0.5916628499005376,0.5453443853726585,0.9317038893849092,0.9377429277366031,0.005669989214577509,0.9087928606576827,0.04333420340947136,0.7525427292038728,0.7138367617581148,0.8108168486742103,0.5727453315233004,0.24291889753138218,0.04648795209203849,0.8810573126706004,0.8155529135559281,0.1958582308217206,0.4623096662214442,0.8737294498866873,0.9178247192720388,0.8156276982203574,0.6355209112133118,0.2712363762805383,0.6787535124932029,0.055797262686782756,0.912682139709335,0.029805113987609988,0.7593170779794719,0.2116925316863013,0.5566392096652547,0.6747738185038111,0.49690642510681693,0.1791503475416557,0.309598054086238,0.9288964386902306,0.27150407596584547,0.13124254067330654,0.8268758400514129,0.7339541659200275,0.08154859166646622,0.8350941986015463,0.8967226723665537,0.5400437703608012,0.6380587043352296,0.3698852942852371,0.48251279156010807,0.20217361633569897,0.1322885757306046,0.3689614557410593,0.1536933228777133,0.6299729550449702,0.4291838517613684,0.7877694264788534,0.8230683004815336,0.2460277761032904,0.9513854297148421,0.6881676650374274,0.35684866733562925,0.9084082527930367,0.5276674629651609,0.6240495133892918,0.5670013121811454,0.5245346079363035,0.07224255289809045,0.6740650119910991,0.62543548209698,0.5535289522835448,0.9310622517569759,0.009828984305178978,0.11856381862892684,0.6742076301584907,0.20021756147675995,0.4791244281035647,0.9993981912226475,0.6500129241585296,0.3763419091890101,0.7046115361071102,0.08260701653133284,0.5050643901607823,0.7273705772192953,0.26387980399404865,0.6615476897811973,0.1228260195074038,0.8367087554549341,0.4993948276093556,0.40092836029405743,0.08426196717739798,0.6316962558231235,0.050816492637216104,0.8126443360201162,0.1091555629594021,0.9412281154574652,0.8797609929708071,0.21331950072060957,0.27017458553790286,0.5999143239201074,0.5917845216701019,0.7443071423542046,0.06381885521411657,0.8449642648432009,0.4502992984435067,0.9994966709971262,0.6178317708742492,0.8421850861163016,0.5203202376976703,0.34820924084753,0.9659048211834734,0.1689893686048849,0.8717043587247748,0.37794843766161357,0.1988467123290123,0.449517971371709,0.08849224970717706,0.036927440217688345,0.6417612794501167,0.7945974042102922,0.357586528411293,0.6653323166161841,0.08965420140541913,0.7978407096188866,0.6577690116540958,0.9423817535020206,0.3089672364201167,0.2638789223587059,0.581587418216971,0.6716856135166459,0.8935889435597975,0.554094733716224,0.8962367454686689,0.2351678922339806,0.4644557297551162,0.3588813023584039,0.9034695975949992,0.15623709280757725,0.5738836761941214,0.5483535562610576,0.6611518207168321,0.04894608239780618,0.6318902003967318,0.18809641027802637,0.10213257358105476,0.09135729686707428,0.5498898613379201,0.23128210582130848,0.16755846654862694,0.992665920853181,0.48958446731184124,0.6579611122305457,0.47895565853082234,0.3581755646638084,0.30151161517957203,0.5626336329821614,0.7360111593143551,0.8248513944328223,0.10311100226557302,0.22499708172722233,0.6763853929048216,0.6765405345051633,0.08793028496664301,0.4690027832764424,0.08965851248107615,0.1141655601524263,0.18061063996546,0.9262547503437045,0.18886479483135044,0.8082893856071902,0.24338130000368352,0.9560246425169413,0.8722643957413068,0.19431775621149316,0.4001647107754899,0.10884351326195285,0.6585807901752534,0.45795886091824944,0.5271980202209464,0.3446421739696418];
	    let y = vec![0.7984469652235282,0.5545459339697301,0.4783692175408878,0.6147010725355303,0.25549432576313025,0.4758791246164137,0.9079412951919239,0.03271067726267829,0.9800524058114991,0.10240189711616887,0.5578537033423189,0.17172600654111358,0.47115827350623896,0.3343151993175766,0.4172750024526938,0.19897578995895726,0.7796663694296226,0.8508535810273415,0.7023510247912684,0.9852341919999139,0.7928045288204547,0.9672119880729818,0.26531155805408535,0.2472042901796746,0.1017092616689802,0.14231972564895135,0.14772961658365835,0.8378496371457014,0.34515716720619827,0.8317220743844133,0.6358680274132766,0.6565771789355739,0.23393763867395478,0.23857128989390008,0.445559443294379,0.8612112894850311,0.6164701979042959,0.07223732094838409,0.6750608337992106,0.9762440382713992,0.7779848443004838,0.7568411525851493,0.3946234555535817,0.86652021603034,0.38763230290873707,0.7290417035041414,0.10742319273222423,0.6178956181150989,0.32910624064393446,0.05737937964807094,0.626193332088946,0.7477296176762411,0.6517027459664148,0.6403725828507459,0.9565283968183549,0.37791645554493425,0.956327427882066,0.9431477711600217,0.18781216741329376,0.6084693197537628,0.5491808946294139,0.45898263085999147,0.6765076479552784,0.1270484574942946,0.3460006237207366,0.3914204044422164,0.3970718268671519,0.23742302131041215,0.6521897761654685,0.07845947600730974,0.5817432840781738,0.4315014589326883,0.015063521296211468,0.5518513038959996,0.43165937916610164,0.2866973158710884,0.966571896201012,0.769702307455386,0.6452316696381315,0.2894828882874607,0.30356035161703265,0.19918523859927528,0.9243359112337166,0.08555320548647027,0.6301447583910305,0.6886208107268997,0.23521074177722845,0.7597805544252292,0.10653895892641907,0.22617597617297736,0.6356903571111442,0.8115145676292836,0.6620779970690285,0.9282311763424651,0.08831300431826239,0.0649192289559597,0.9765598174761905,0.22583967791152182,0.6590158039683982,0.6291672730552234,0.5977372468258825,0.7566614307966467,0.27874589212743106,0.027015779771144555,0.6972824704511514,0.13712458096365931,0.6058605746609725,0.3033722609729338,0.4380878598649357,0.025581577713689407,0.7067406527113325,0.4370131719839274,0.49134018060249784,0.46922402759983384,0.6165348696008226,0.19776351372090573,0.7942866738350832,0.2963851388842168,0.16139090298677727,0.5007100717141234,0.8540394577671439,0.4135182952382276,0.9089390085782533,0.3448103543407711,0.3812939312577662,0.46549528442491106,0.29548622470650365,0.23491595546419086,0.370731359300728,0.6784559230452151,0.08386831232619485,0.16000222765285144,0.58202622879826,0.7749693307435642,0.6295899754608405,0.9251835409623493,0.1218240965403602,0.08338289096430995,0.15808146672034218,0.9699349608429152,0.03675043668335787,0.341669923202807,0.07796424646173328,0.7714762890275471,0.20635383572714072,0.4153196237501283,0.06400914839215921,0.8761715769198297,0.537083658735014,0.3860150189589675,0.1858134552615459,0.6308170989325709,0.8904774718325601,0.6235243538916717,0.9251469395248094,0.1608426200713775,0.3315903769507006,0.975274703687984,0.3136700482688993,0.6454320091289417,0.9351024830932658,0.7050147269070908,0.28574406770859273,0.5515017992701886,0.4583302179688139,0.24355872142002244,0.3296493200706856,0.9131878796856375,0.3232089443149605,0.27810880747398214,0.24458642865898206,0.5984604126016161,0.8098241984724455,0.8355821351912349,0.5773347015163212,0.6102205441718502,0.8381053940325758,0.5952755464206022,0.9098781964547977,0.23477181411724724,0.23728518993455472,0.2616814390747888,0.8034916067627822,0.08119377640749847,0.8627209983148418,0.007925558248086828,0.7678779353456334,0.1070668168514346,0.9728648929603094,0.5723985161270583,0.5354813939556032,0.1796098886258789,0.6656209068976073,0.7565997035776622,0.6270247468813059,0.7276829212598326,0.7504011870140395,0.695819032413198,0.8864957446312857,0.009469302655753409];
	    let r : f64 = -0.11218908450613024;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_18() {
	let x = vec![0.5254864871509975,0.09539222808081438,0.7017425377740824,0.2611645674608728,0.16882972759801584,0.4053814943842603,0.42342079649669795,0.5625114541185909,0.3740632432216928,0.8886382790441918,0.06315287058985886,0.8678688691909654,0.24744198820074337,0.07215246472451187,0.32769883568479474,0.20436609557132934,0.2306513768141042,0.06631010962992356,0.9656749145279869,0.29047224465105104,0.07480348994264585,0.2790398988340266,0.8414177880854163,0.8243315376571624,0.4704787794425035,0.8586737684951575,0.7857808238908699,0.2947157430275099,0.2639280970117185,0.10956817217326431,0.07535605613508678,0.9246449813134864,0.3675642800479778,0.6049607373993837,0.3113466583578307,0.9873469555365613,0.13988927034860343,0.358672618639442,0.5018982968642921,0.8348864654422048,0.9201568074724836,0.8466260881610134,0.11959313635785529,0.7744563090973058,0.5139139448839761,0.14244105442398136,0.17621282963655927,0.24894635222741934,0.45323371321426054,0.2838496185785543,0.35575778748579245,0.6151576787367801,0.24046575401470627,0.6897335862790093,0.41739256085693344,0.5384800937046799,0.3433162541718311,0.9395979051389697,0.4936657983414743,0.3687630318033338,0.3946830287844867,0.02526585301950146,0.05260666826874827,0.16717297824977417,0.6322864914817052,0.670332336654545,0.8736015105803341,0.23549945278077278,0.6013684623305031,0.17073580146747058,0.884959821805807,0.19238078244418833,0.8705111644054938,0.26539510960572,0.21764478134680965,0.9680191614409311,0.2609282584497452,0.7033212513384213,0.21011708616719882,0.3181460356574164,0.8958167111286794,0.7589343172761751,0.49754998678505735,0.4705138026821849,0.9685691571136266,0.058005048185305386,0.11967305851321242,0.43858178315451013,0.1589166764484966,0.5365041459858778,0.9938776253209549,0.6150163512256647,0.965333049855798,0.7659010080729743,0.5698540535636346,0.23358115513360989,0.19198795495086884,0.3668732407274399,0.6196501503588584,0.3944244644341577,0.2506855621645031,0.49405973483133925,0.38479859023737195,0.6010906475335628,0.7712027407826177,0.7478217515993497,0.9445001489947942,0.8740959935863858,0.6598344972377977,0.4455464253059864,0.6181077678619505,0.45339975985827874,0.8507761761230223,0.8765652230629001,0.012432699613129983,0.6105995093694078,0.09466013708367205,0.5863716953604643,0.5133372226272266,0.9735436237661004,0.18165309829982867,0.04469279971087625,0.02830509669650072,0.909965485306569,0.823065933831796,0.8065084808412072,0.9705317899512239,0.4555606455773892,0.5946426036853666,0.6658498377649217,0.3829132390189982,0.17255778651586529,0.47479744994465944,0.8543035465466527,0.4982929855248919,0.6417105791913565,0.4150107851196081,0.001322160497886915,0.13184340320162802,0.5411684826332045,0.5736111584790352,0.5500402597114719,0.6784811800835585,0.12391007764531026,0.11830520524909494,0.09145521483003782,0.07043779011423823,0.9012168563360526,0.2837725290456209,0.8041511666670366,0.656572553202084,0.2678057446577803,0.10619499443608804,0.4619327436488445,0.6981584240486373,0.13003507794842661,0.47107969876184663,0.7644601954214957,0.08444419327206931,0.15521598556086336,0.37010393531974395,0.7452028426203028,0.8210557221019464,0.504450816299454,0.42319253493689823,0.15936953973433798,0.16989745157663882,0.3167504743599844,0.8393125614606678,0.7641432992795459,0.4878321749267276,0.9775781939820158,0.6427455613599306,0.08278416686088153,0.7452027532768305,0.20815095383130233,0.5974781580055859,0.04606596280685116,0.40157156832832286,0.752804986579557,0.7373085078088112,0.2899834621841343,0.33877198578089074,0.7868637750060002,0.9527579777174712,0.17051097385638914,0.9313454813702257,0.2728812233604142,0.5294183885472072,0.10891056203298133,0.19909103127984162,0.042410446533838964,0.352115978498276,0.45067261676800485,0.07486501112618449,0.7430525750328151,0.6106476980871837,0.0914603282082408,0.5345344498525868,0.23722260977929488];
	    let y = vec![0.6867110849503876,0.2288965577300509,0.2587194211484798,0.2287052007456719,0.019560820035249837,0.6480524003186151,0.8894829765938664,0.6952566190746997,0.5501144421884698,0.8921431845797608,0.3319280469628799,0.8959309785216433,0.4099589924242537,0.6415021071448339,0.584796630471509,0.4839478950243128,0.6644043177586102,0.47438805822024266,0.006929294355944804,0.812595355427841,0.9931595614074814,0.48436395810224164,0.7060501547314262,0.7400957963136682,0.9468293419599451,0.7882720715429627,0.6956442743664418,0.4718764883209957,0.6789037974664883,0.9554159712625034,0.12364799711820418,0.8344419046490851,0.3308325167870084,0.3573304202680201,0.6600639889624991,0.08856043742753594,0.05760815177523648,0.5667791294667905,0.8149423681827489,0.547526272935028,0.8355982985723514,0.5342572623606222,0.7019627935476065,0.17204811714228263,0.7422415912828519,0.5452024310768931,0.40052584389702617,0.9765305352418826,0.22992558250396233,0.7158930082409627,0.6802812749530552,0.4662889008365736,0.1726884915403133,0.5535748009802128,0.22497277480277167,0.20942924253954753,0.5278589776330839,0.5851840819482284,0.21549471603410608,0.9176013319977232,0.5294545338623966,0.0056575000002664355,0.1283070898315779,0.442634314952584,0.44313833072455,0.42496338254738986,0.8317518651572526,0.179278602781765,0.9628445791455659,0.9290388335391576,0.06627010398024002,0.6761877177773339,0.04392198213172249,0.926100824279396,0.4630518348247563,0.4138041345599742,0.16360413083891534,0.8644702105647959,0.22268473574820968,0.9469284690557407,0.4122797961981939,0.4917586959893939,0.5432326807727764,0.5749542463040824,0.43743181478701776,0.4716788175352312,0.07659318730406006,0.18745923066019587,0.4245790395375961,0.2789560554437073,0.72002186341989,0.48637951763012843,0.32253529579724594,0.966331096619238,0.8765088950963391,0.012393286419636884,0.31074571345067536,0.6730702535694387,0.06496321594958976,0.13234620486771287,0.9577665800525755,0.01961482098820666,0.6864684081981253,0.3492814762221451,0.8140656277036105,0.4170897825517048,0.23148875154476556,0.5257874816830246,0.3602791916815624,0.2282919872084408,0.4673314298743513,0.9668593878079367,0.4146627230139418,0.6572615895704628,0.914146763301449,0.029637718951491143,0.8131990319717203,0.44848434494577183,0.022259608145805188,0.7432472641076668,0.36119267786972686,0.09737847179058579,0.2275169944756582,0.36490715099704374,0.5062788241619475,0.719243107122439,0.6475871660007545,0.884947119726381,0.25334063590395695,0.5461646443977897,0.394498234210353,0.8117497894689729,0.15972564388343857,0.224390713537571,0.011316082798569771,0.9573994394680981,0.12104077058729801,0.4826895715364312,0.013691220007050142,0.6369385220664123,0.44823354288633477,0.7018191290420586,0.8864151406089047,0.7798513815911234,0.1333579625793867,0.1047613092464289,0.18852919958404424,0.06102616304113373,0.03911848419130137,0.82809665584689,0.21954036102230345,0.2472187161373659,0.39325609180691845,0.15116980019265602,0.3785279575825865,0.8248249132579261,0.23998795054517774,0.5563410165912203,0.29144710020530185,0.3044108525262287,0.4556999968960139,0.07517191425035663,0.637752870266056,0.6654772715415119,0.9418950012657151,0.0631766973582365,0.21753629986371426,0.8277054995447394,0.5961082112924063,0.4833765175839839,0.3805141630019968,0.5163648240936621,0.8220714707055459,0.17061431816585504,0.11963802102009946,0.8263147192155615,0.6739387464436705,0.37404119309367223,0.02166823723410738,0.5585289780685524,0.46619271975557464,0.13708014910485622,0.8126789412584557,0.8261070884395578,0.7233698219410335,0.4201698310606098,0.20657645990778783,0.18589759175642806,0.7713257382992886,0.5232251879626713,0.11637678214971048,0.26691451130913735,0.13205594749874539,0.04563051413145469,0.42514186085058525,0.20477193509308977,0.014023343375209496,0.1443898664542257,0.5873248009638533,0.199552090763917];
	    let r : f64 = 0.13188528796522447;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn pearson_float_200_19() {
	let x = vec![0.6990948462625693,0.01951137453411944,0.007121333501004301,0.31928663936517543,0.3356605106056265,0.2086298149420559,0.2531133736355381,0.18213759625331627,0.3155813088726892,0.6450228330701214,0.1314326813365364,0.14832452805315055,0.13261870610533677,0.8607890138402413,0.22200150834423482,0.8169137716551814,0.719990458024057,0.9784902703244449,0.7062111728128209,0.05460191280793614,0.0021585349849773117,0.8804459939899012,0.05744212919745406,0.2406807570697933,0.38935525971650975,0.9475128437177415,0.6570655176556416,0.8457125731397551,0.4068091436870436,0.8050825335638335,0.27929108998459895,0.44717483703405825,0.3582563999021673,0.292528522765905,0.5885751562840249,0.060612257213319864,0.40088143493843875,0.8748276501896008,0.7215979492907186,0.4059262326514822,0.09572813189080864,0.893112103457685,0.7682874361682822,0.47389643215099364,0.04559683565647621,0.441926663591654,0.14927163736689153,0.5074514381246757,0.6503061396944875,0.3805918385571736,0.49501434484689644,0.5835864824411388,0.15738583363844416,0.24353180120030726,0.38006533701120027,0.2846162095752701,0.16241169797145283,0.22645143636376608,0.6202680271707592,0.8290670450093793,0.4465115539403477,0.922577340700695,0.1450108097544669,0.4827099694588458,0.20207704209678512,0.30524431764272086,0.36151674851362525,0.020959185914511846,0.7575457965593787,0.9652378570065689,0.7147778949108442,0.3259605194180233,0.22410979575569223,0.585276670193357,0.07468566605579274,0.4917961963017624,0.35361792386287993,0.6469826497095668,0.6519356878731476,0.553353643230975,0.09865779700244381,0.8993984641107223,0.3668795720789124,0.6130447990762984,0.9422221094015141,0.7079987315199214,0.3445415207734448,0.713520121887691,0.5098749758856498,0.3960334210046047,0.9069883703998013,0.7735156898260618,0.03440543221227055,0.9385678758974283,0.015649730387718552,0.6157678792127713,0.9948802641994028,0.3068932957842122,0.20704139708883362,0.31278898050602144,0.17167797438005283,0.9397094868848912,0.9509714710630753,0.1282383832521291,0.9197020296751682,0.19680940227358712,0.7594354221155095,0.23621998574308,0.5118652099105181,0.3018699525376688,0.8158764558807335,0.5264575708810619,0.31441160485524877,0.5826235631067405,0.22444640822894435,0.6469674709920712,0.2321099004619016,0.026075187993940596,0.7344146172997719,0.43241891865485416,0.9869961731156394,0.09477036878820722,0.5266356419622267,0.7460964588811083,0.25775630343517053,0.15195263110897705,0.04962941908187879,0.5894806350946566,0.9796316582634236,0.6925017859029491,0.34588966450361724,0.9436215680620884,0.06924523989620457,0.5290314145025151,0.38432242935873495,0.8102911070855083,0.5686975653458836,0.28263221421845475,0.11630418720266456,0.044621458688174354,0.6965406143751912,0.25254605235409,0.7360385480346354,0.7303059230277621,0.6676503839648045,0.4459436633025373,0.09444960850123374,0.13031471191379007,0.754945171100095,0.7719775641306776,0.8724014548191328,0.9273908404691609,0.2105559321230478,0.09035408546660473,0.8914839790588543,0.34574301857372125,0.08991645139164328,0.676172177986584,0.9532579143068064,0.7157868836775103,0.9934310232697685,0.05670199043638302,0.9683345075225188,0.4174161937375416,0.6610304455372057,0.39366313585225754,0.46638202507659265,0.15649596962676382,0.877879086685219,0.06654411796050641,0.10895574348636006,0.40449763923935245,0.9356946069567093,0.5784013307693696,0.8914120391247791,0.7018399467426742,0.07760310428823691,0.465088315427469,0.7967785554199129,0.4619202518869352,0.026884389982475998,0.44848363182640116,0.42690692386288454,0.28085959042544895,0.8233333672032301,0.5622789979214214,0.7861475883527932,0.7644382865182544,0.8085163471684343,0.7352892168161088,0.6167314193015739,0.9153238793333844,0.8450914093353374,0.22200703900691576,0.26953627903780475,0.4861571154411418,0.5588883268581861,0.27746157106986935,0.19953668189495255,0.5004470911000019];
	    let y = vec![0.19132681596859225,0.653984508678184,0.6292965883754299,0.7406324432940377,0.7030750440961024,0.8907399631653908,0.3917419594678335,0.9873746789537453,0.7805646360023865,0.2958508146413661,0.68610364022187,0.9120406414348186,0.876495911567635,0.5231402370890593,0.8610103790694751,0.7841160695696441,0.5002736347102527,0.9242557495516769,0.5761779226596232,0.9817849498954492,0.5807932656409994,0.9442505598191573,0.7012122711538323,0.2956253301573464,0.021260538496405523,0.22556101491615865,0.0057851861018092254,0.14116342405522242,0.9164331566884952,0.4014277778356482,0.24242261109798358,0.06791528253426915,0.2304800072476456,0.372965484590866,0.7703790166220685,0.687019923610408,0.3508944742130743,0.7663336660018972,0.44592824912278883,0.9425360853864283,0.278818254873309,0.9107765077581446,0.2755230118281651,0.5807807463983762,0.9615378895785399,0.7163248945957905,0.4575381225584375,0.20783119895388857,0.9606534778554768,0.22942599128323782,0.6799651232286004,0.05802082425381616,0.023771997615301466,0.5565460827153464,0.2363019241098494,0.3939870382662717,0.7784328281857027,0.8535460338124614,0.5026028290684572,0.49481650867365534,0.09493057219750789,0.27653068817541027,0.568721668982736,0.10996979393122897,0.9223326092037122,0.09472504416307737,0.8738251714024956,0.021325684218437946,0.32161394469601357,0.08292389729740934,0.7486653070808208,0.2541312283850483,0.7840409731542843,0.39541322326886397,0.23664995542037148,0.5807218946512669,0.9423687676332223,0.6381516364422991,0.20430578819014766,0.27086748212926903,0.11346523058666047,0.3449298656374713,0.1198745099205395,0.19234408271209058,0.8394922360746255,0.6537340081102616,0.7927450197622266,0.3547054348490408,0.19897164791534216,0.08593633710296655,0.590156278744521,0.3998302276611998,0.5786943853608807,0.9609925269275973,0.8510362481168192,0.6131540842785405,0.4579021667961408,0.9028515960326382,0.13188031328632632,0.9983587230367901,0.7962201400801846,0.0698740344926132,0.9365331222260486,0.008005923904904177,0.09131882864602414,0.3270449878767022,0.7909956841373083,0.8710835478516598,0.1725505297386335,0.30624281867996206,0.6749107410416033,0.7939307177135196,0.8943245976176457,0.018545265510022446,0.6266016796769187,0.3206915631294739,0.9325829624449731,0.2879026256631788,0.5968196579972372,0.1930543761262279,0.05359388647180208,0.5856894266599053,0.9148400894075805,0.27686987515279415,0.10404887002923713,0.4836255014542843,0.3029473304709458,0.8710597724934825,0.38888367804826995,0.5771543334903978,0.46190363684396296,0.32844659086777317,0.5627931474855381,0.7395604515318795,0.8132555338588868,0.9155009586322104,0.17511230942005773,0.9661165830954048,0.09907679600687214,0.903184189591166,0.8655854159980442,0.9644070753435267,0.2559251617536833,0.9059793922079112,0.8518531601927887,0.18473417660326175,0.48397150129916333,0.7528852168770643,0.20887112723022927,0.7831144253306664,0.8568307567280411,0.812220172917381,0.3473138258648052,0.33976174596146014,0.6986327430697512,0.7473177095174824,0.23772537539472227,0.6367648433324943,0.8369169924730799,0.1116486769681665,0.6136043493197811,0.012095130949959843,0.09394477068290508,0.7626266332863296,0.39900260414078903,0.9164101219878387,0.3024509161584602,0.6361652560261147,0.7406007291348441,0.5647866620712674,0.1913821291179082,0.6400894195145626,0.9020743589402079,0.40954780539973945,0.6961685219881313,0.2681354693244107,0.5124896348714716,0.2912437311153666,0.19496054935023643,0.3139620498096789,0.9576714179849923,0.7402358330495401,0.479339740951058,0.3227810010457478,0.6508284148902879,0.684532188403532,0.890543389418797,0.8207854590383167,0.3214622222040354,0.7335370767928296,0.02497680458426288,0.5016678072166586,0.18685531523391097,0.05178743506826533,0.4210190695466677,0.678505988784553,0.14623682297109497,0.8888642575099911,0.20538580749925406,0.4486436076006254];
	    let r : f64 = -0.0237809179628376;
	    let result = pearsonr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn spearman_int_2_0() {
	let x = vec![0.0,0.0];
	    let y = vec![0.0,0.0];
	    let r : f64 = f64::NAN;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_2_1() {
	let x = vec![1.0,0.0];
	    let y = vec![1.0,0.0];
	    let r : f64 = 0.9999999999999999;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_2_2() {
	let x = vec![0.0,1.0];
	    let y = vec![0.0,1.0];
	    let r : f64 = 0.9999999999999999;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_2_3() {
	let x = vec![0.0,0.0];
	    let y = vec![1.0,1.0];
	    let r : f64 = f64::NAN;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_2_4() {
	let x = vec![0.0,0.0];
	    let y = vec![1.0,0.0];
	    let r : f64 = f64::NAN;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn spearman_int_5_0() {
	let x = vec![3.0,1.0,4.0,4.0,4.0];
	    let y = vec![0.0,3.0,3.0,0.0,3.0];
	    let r : f64 = 0.0;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_1() {
	let x = vec![0.0,2.0,1.0,3.0,0.0];
	    let y = vec![4.0,4.0,3.0,1.0,1.0];
	    let r : f64 = -0.16222142113076254;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_2() {
	let x = vec![1.0,4.0,2.0,3.0,4.0];
	    let y = vec![0.0,1.0,0.0,0.0,3.0];
	    let r : f64 = 0.8603090020146066;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_3() {
	let x = vec![1.0,0.0,2.0,3.0,0.0];
	    let y = vec![1.0,4.0,4.0,1.0,4.0];
	    let r : f64 = -0.5923488777590924;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_4() {
	let x = vec![2.0,4.0,0.0,1.0,3.0];
	    let y = vec![0.0,3.0,3.0,2.0,2.0];
	    let r : f64 = 0.0;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_5() {
	let x = vec![0.0,2.0,4.0,4.0,1.0];
	    let y = vec![3.0,2.0,1.0,4.0,0.0];
	    let r : f64 = 0.15389675281277312;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_6() {
	let x = vec![4.0,2.0,2.0,1.0,4.0];
	    let y = vec![4.0,0.0,4.0,3.0,0.0];
	    let r : f64 = 0.0;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_7() {
	let x = vec![2.0,1.0,1.0,3.0,0.0];
	    let y = vec![1.0,1.0,0.0,2.0,0.0];
	    let r : f64 = 0.8651809126974002;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_8() {
	let x = vec![0.0,0.0,2.0,0.0,3.0];
	    let y = vec![0.0,3.0,3.0,3.0,4.0];
	    let r : f64 = 0.7499999999999999;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_5_9() {
	let x = vec![1.0,4.0,2.0,1.0,1.0];
	    let y = vec![0.0,3.0,0.0,1.0,4.0];
	    let r : f64 = 0.0;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn spearman_int_50_0() {
	let x = vec![5.0,41.0,14.0,10.0,12.0,33.0,22.0,11.0,4.0,35.0,40.0,18.0,42.0,32.0,44.0,20.0,26.0,0.0,40.0,14.0,23.0,41.0,43.0,12.0,45.0,12.0,23.0,31.0,12.0,14.0,40.0,21.0,17.0,24.0,30.0,25.0,12.0,47.0,30.0,22.0,47.0,27.0,5.0,40.0,25.0,41.0,19.0,5.0,42.0,4.0];
	    let y = vec![39.0,32.0,9.0,33.0,31.0,45.0,39.0,11.0,0.0,20.0,17.0,12.0,19.0,47.0,5.0,2.0,40.0,6.0,12.0,18.0,0.0,40.0,7.0,3.0,30.0,17.0,19.0,47.0,35.0,10.0,46.0,19.0,2.0,34.0,41.0,27.0,16.0,6.0,28.0,23.0,30.0,15.0,40.0,42.0,1.0,3.0,38.0,39.0,28.0,41.0];
	    let r : f64 = 0.07787586720927746;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_1() {
	let x = vec![13.0,47.0,47.0,35.0,27.0,49.0,33.0,13.0,14.0,21.0,39.0,43.0,30.0,18.0,24.0,2.0,19.0,23.0,43.0,2.0,20.0,45.0,6.0,36.0,22.0,6.0,5.0,3.0,11.0,35.0,28.0,40.0,13.0,16.0,8.0,30.0,22.0,1.0,28.0,5.0,41.0,5.0,38.0,36.0,43.0,1.0,10.0,10.0,38.0,47.0];
	    let y = vec![5.0,48.0,15.0,34.0,20.0,49.0,38.0,42.0,38.0,4.0,20.0,0.0,41.0,41.0,46.0,0.0,46.0,24.0,17.0,9.0,25.0,39.0,41.0,26.0,13.0,18.0,4.0,35.0,12.0,12.0,33.0,33.0,36.0,29.0,22.0,16.0,35.0,40.0,16.0,13.0,34.0,14.0,43.0,44.0,41.0,43.0,10.0,28.0,1.0,25.0];
	    let r : f64 = 0.18759164491939803;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_2() {
	let x = vec![6.0,34.0,25.0,8.0,13.0,11.0,49.0,3.0,30.0,24.0,2.0,22.0,20.0,11.0,18.0,42.0,44.0,20.0,23.0,31.0,35.0,25.0,23.0,30.0,35.0,10.0,13.0,19.0,12.0,22.0,30.0,42.0,15.0,41.0,43.0,22.0,36.0,7.0,31.0,27.0,2.0,2.0,44.0,47.0,39.0,33.0,48.0,6.0,4.0,26.0];
	    let y = vec![13.0,21.0,24.0,12.0,43.0,3.0,2.0,2.0,25.0,20.0,34.0,19.0,39.0,14.0,22.0,30.0,49.0,24.0,43.0,10.0,34.0,8.0,10.0,37.0,14.0,27.0,27.0,27.0,18.0,12.0,31.0,49.0,40.0,33.0,2.0,12.0,8.0,17.0,0.0,49.0,8.0,14.0,44.0,32.0,28.0,10.0,0.0,43.0,0.0,0.0];
	    let r : f64 = 0.10657946855146598;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_3() {
	let x = vec![3.0,9.0,12.0,47.0,20.0,47.0,28.0,43.0,6.0,36.0,22.0,6.0,36.0,13.0,3.0,18.0,43.0,7.0,46.0,17.0,2.0,38.0,35.0,29.0,38.0,29.0,7.0,46.0,40.0,31.0,13.0,0.0,48.0,44.0,39.0,30.0,33.0,17.0,42.0,17.0,1.0,25.0,15.0,27.0,47.0,19.0,6.0,28.0,3.0,30.0];
	    let y = vec![14.0,17.0,5.0,0.0,19.0,9.0,15.0,30.0,41.0,16.0,8.0,10.0,23.0,30.0,19.0,25.0,26.0,40.0,6.0,22.0,19.0,10.0,10.0,15.0,9.0,35.0,16.0,10.0,17.0,31.0,13.0,49.0,11.0,47.0,38.0,38.0,43.0,27.0,24.0,27.0,3.0,9.0,14.0,16.0,38.0,9.0,16.0,25.0,28.0,37.0];
	    let r : f64 = -0.06002742263472619;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_4() {
	let x = vec![41.0,43.0,35.0,7.0,10.0,33.0,18.0,38.0,39.0,3.0,48.0,16.0,42.0,17.0,38.0,28.0,22.0,36.0,40.0,4.0,27.0,13.0,32.0,4.0,33.0,40.0,1.0,30.0,33.0,10.0,6.0,40.0,15.0,0.0,6.0,17.0,34.0,6.0,45.0,39.0,26.0,26.0,19.0,41.0,19.0,31.0,19.0,3.0,42.0,27.0];
	    let y = vec![39.0,48.0,32.0,18.0,6.0,18.0,23.0,12.0,5.0,47.0,11.0,32.0,2.0,17.0,25.0,49.0,1.0,49.0,37.0,33.0,11.0,45.0,23.0,24.0,0.0,11.0,18.0,10.0,31.0,2.0,38.0,36.0,0.0,46.0,19.0,15.0,28.0,38.0,39.0,22.0,46.0,34.0,34.0,38.0,16.0,9.0,36.0,35.0,1.0,22.0];
	    let r : f64 = -0.06797913529370292;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_5() {
	let x = vec![21.0,32.0,43.0,8.0,5.0,29.0,34.0,21.0,16.0,25.0,33.0,39.0,12.0,27.0,20.0,0.0,0.0,17.0,12.0,41.0,2.0,21.0,4.0,14.0,11.0,41.0,6.0,49.0,40.0,12.0,29.0,11.0,12.0,43.0,1.0,48.0,22.0,36.0,31.0,41.0,5.0,43.0,12.0,11.0,43.0,36.0,9.0,4.0,7.0,48.0];
	    let y = vec![21.0,21.0,15.0,43.0,3.0,7.0,18.0,22.0,26.0,31.0,19.0,4.0,17.0,10.0,1.0,36.0,28.0,48.0,3.0,0.0,41.0,0.0,45.0,43.0,32.0,2.0,24.0,31.0,14.0,29.0,23.0,1.0,15.0,32.0,7.0,32.0,4.0,2.0,31.0,42.0,30.0,33.0,40.0,2.0,19.0,17.0,32.0,23.0,38.0,15.0];
	    let r : f64 = -0.20158769835740914;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_6() {
	let x = vec![19.0,37.0,3.0,39.0,41.0,1.0,15.0,31.0,0.0,28.0,0.0,25.0,40.0,39.0,49.0,36.0,6.0,14.0,26.0,41.0,20.0,28.0,19.0,42.0,48.0,30.0,33.0,25.0,13.0,47.0,28.0,36.0,34.0,40.0,10.0,27.0,32.0,34.0,26.0,35.0,15.0,27.0,14.0,10.0,0.0,20.0,21.0,37.0,6.0,27.0];
	    let y = vec![14.0,45.0,22.0,31.0,8.0,1.0,44.0,20.0,0.0,25.0,36.0,30.0,9.0,8.0,5.0,8.0,1.0,8.0,31.0,5.0,21.0,7.0,35.0,13.0,21.0,13.0,23.0,36.0,45.0,19.0,16.0,48.0,35.0,42.0,37.0,33.0,7.0,39.0,17.0,39.0,4.0,18.0,40.0,49.0,29.0,18.0,35.0,38.0,22.0,6.0];
	    let r : f64 = -0.06908819925552073;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_7() {
	let x = vec![22.0,29.0,37.0,32.0,23.0,31.0,4.0,3.0,43.0,33.0,20.0,46.0,9.0,31.0,16.0,10.0,26.0,22.0,33.0,37.0,49.0,47.0,34.0,44.0,7.0,30.0,38.0,46.0,18.0,18.0,30.0,21.0,11.0,11.0,48.0,2.0,42.0,24.0,49.0,10.0,5.0,11.0,3.0,34.0,41.0,6.0,17.0,20.0,3.0,44.0];
	    let y = vec![44.0,44.0,36.0,11.0,19.0,17.0,1.0,48.0,33.0,4.0,38.0,5.0,17.0,9.0,35.0,36.0,15.0,35.0,11.0,15.0,20.0,7.0,26.0,46.0,45.0,27.0,1.0,18.0,20.0,3.0,17.0,25.0,14.0,37.0,31.0,7.0,43.0,12.0,29.0,29.0,25.0,25.0,17.0,47.0,43.0,45.0,31.0,42.0,24.0,16.0];
	    let r : f64 = -0.09047207093411225;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_8() {
	let x = vec![46.0,35.0,10.0,21.0,20.0,13.0,7.0,41.0,24.0,30.0,6.0,14.0,20.0,45.0,27.0,24.0,25.0,34.0,45.0,36.0,39.0,36.0,46.0,45.0,5.0,22.0,34.0,49.0,26.0,43.0,43.0,25.0,8.0,41.0,0.0,23.0,41.0,47.0,8.0,21.0,2.0,26.0,4.0,8.0,24.0,38.0,30.0,15.0,7.0,44.0];
	    let y = vec![13.0,27.0,44.0,30.0,19.0,27.0,26.0,14.0,36.0,10.0,20.0,32.0,5.0,25.0,1.0,47.0,39.0,20.0,35.0,25.0,20.0,40.0,37.0,46.0,47.0,25.0,31.0,9.0,1.0,18.0,4.0,13.0,47.0,38.0,6.0,26.0,44.0,19.0,25.0,49.0,33.0,19.0,48.0,3.0,12.0,48.0,3.0,48.0,30.0,40.0];
	    let r : f64 = -0.1333734095364174;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_50_9() {
	let x = vec![47.0,16.0,24.0,7.0,43.0,13.0,40.0,8.0,32.0,45.0,32.0,13.0,44.0,20.0,29.0,17.0,33.0,41.0,22.0,15.0,41.0,24.0,37.0,6.0,40.0,32.0,37.0,35.0,22.0,15.0,34.0,9.0,20.0,36.0,26.0,43.0,23.0,24.0,27.0,33.0,16.0,6.0,24.0,48.0,10.0,47.0,29.0,32.0,39.0,17.0];
	    let y = vec![34.0,38.0,18.0,1.0,9.0,12.0,27.0,32.0,5.0,6.0,28.0,39.0,40.0,30.0,39.0,27.0,21.0,38.0,15.0,7.0,2.0,15.0,6.0,42.0,32.0,37.0,47.0,21.0,45.0,28.0,3.0,7.0,41.0,23.0,30.0,21.0,43.0,47.0,6.0,33.0,24.0,22.0,43.0,0.0,39.0,26.0,30.0,43.0,27.0,17.0];
	    let r : f64 = -0.13081325506576408;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn spearman_int_200_0() {
	let x = vec![111.0,143.0,132.0,42.0,8.0,153.0,115.0,107.0,82.0,119.0,46.0,159.0,67.0,171.0,113.0,175.0,1.0,129.0,167.0,190.0,42.0,59.0,92.0,112.0,72.0,100.0,138.0,193.0,81.0,74.0,43.0,22.0,51.0,117.0,10.0,159.0,23.0,61.0,109.0,140.0,91.0,31.0,193.0,69.0,130.0,170.0,85.0,191.0,38.0,197.0,101.0,148.0,108.0,108.0,191.0,62.0,54.0,122.0,40.0,91.0,0.0,0.0,80.0,94.0,93.0,47.0,85.0,127.0,150.0,149.0,98.0,143.0,16.0,170.0,81.0,168.0,138.0,92.0,101.0,163.0,43.0,116.0,149.0,148.0,153.0,73.0,70.0,167.0,86.0,115.0,6.0,196.0,102.0,157.0,152.0,195.0,35.0,137.0,58.0,30.0,76.0,33.0,11.0,130.0,89.0,89.0,46.0,52.0,93.0,20.0,87.0,160.0,139.0,181.0,149.0,149.0,89.0,16.0,191.0,1.0,84.0,194.0,16.0,3.0,82.0,7.0,127.0,71.0,79.0,38.0,109.0,145.0,109.0,158.0,125.0,71.0,150.0,56.0,162.0,168.0,147.0,194.0,188.0,123.0,155.0,79.0,57.0,173.0,142.0,17.0,95.0,180.0,20.0,197.0,56.0,92.0,11.0,79.0,19.0,61.0,182.0,128.0,164.0,193.0,32.0,110.0,191.0,26.0,126.0,171.0,57.0,115.0,111.0,142.0,118.0,140.0,101.0,116.0,65.0,42.0,110.0,37.0,58.0,198.0,93.0,57.0,59.0,138.0,163.0,82.0,118.0,167.0,100.0,82.0,138.0,139.0,154.0,187.0,60.0,41.0];
	    let y = vec![8.0,36.0,92.0,19.0,147.0,179.0,88.0,95.0,147.0,47.0,2.0,118.0,30.0,167.0,82.0,64.0,196.0,197.0,110.0,78.0,15.0,68.0,46.0,175.0,175.0,186.0,34.0,163.0,1.0,92.0,168.0,105.0,43.0,2.0,85.0,166.0,136.0,117.0,141.0,163.0,161.0,197.0,66.0,88.0,172.0,72.0,176.0,96.0,138.0,22.0,78.0,128.0,129.0,167.0,187.0,79.0,190.0,125.0,88.0,81.0,144.0,126.0,52.0,184.0,187.0,95.0,167.0,186.0,19.0,184.0,112.0,190.0,103.0,53.0,55.0,141.0,35.0,40.0,81.0,52.0,113.0,182.0,122.0,118.0,18.0,67.0,8.0,196.0,5.0,96.0,34.0,101.0,139.0,167.0,150.0,193.0,41.0,103.0,156.0,108.0,84.0,148.0,138.0,156.0,169.0,195.0,52.0,22.0,95.0,196.0,37.0,156.0,70.0,54.0,83.0,167.0,107.0,146.0,60.0,189.0,60.0,107.0,94.0,126.0,49.0,158.0,107.0,135.0,38.0,63.0,178.0,55.0,110.0,153.0,35.0,55.0,48.0,161.0,46.0,53.0,185.0,94.0,147.0,156.0,79.0,127.0,193.0,116.0,142.0,83.0,108.0,66.0,187.0,15.0,104.0,2.0,2.0,33.0,99.0,184.0,95.0,85.0,20.0,199.0,79.0,173.0,100.0,20.0,167.0,98.0,192.0,119.0,99.0,17.0,52.0,114.0,193.0,18.0,111.0,176.0,111.0,4.0,188.0,194.0,5.0,111.0,196.0,28.0,171.0,147.0,20.0,159.0,27.0,139.0,189.0,52.0,176.0,102.0,100.0,54.0];
	    let r : f64 = 0.006451278986942016;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_1() {
	let x = vec![2.0,53.0,69.0,145.0,146.0,32.0,131.0,109.0,18.0,168.0,183.0,31.0,193.0,199.0,49.0,37.0,177.0,161.0,44.0,64.0,12.0,78.0,56.0,154.0,182.0,9.0,83.0,106.0,91.0,159.0,119.0,58.0,50.0,12.0,25.0,57.0,4.0,148.0,53.0,10.0,60.0,151.0,126.0,93.0,131.0,174.0,185.0,111.0,73.0,17.0,147.0,23.0,78.0,56.0,98.0,70.0,15.0,174.0,122.0,125.0,57.0,108.0,109.0,7.0,90.0,192.0,33.0,81.0,17.0,185.0,107.0,85.0,123.0,126.0,90.0,121.0,171.0,25.0,193.0,123.0,99.0,48.0,164.0,30.0,58.0,143.0,199.0,167.0,176.0,32.0,131.0,85.0,49.0,65.0,123.0,191.0,117.0,119.0,119.0,75.0,37.0,37.0,38.0,176.0,6.0,78.0,136.0,79.0,31.0,0.0,35.0,174.0,1.0,199.0,36.0,190.0,103.0,5.0,190.0,196.0,168.0,69.0,187.0,6.0,3.0,48.0,1.0,77.0,79.0,120.0,84.0,4.0,31.0,87.0,106.0,146.0,78.0,94.0,7.0,76.0,47.0,73.0,198.0,94.0,46.0,117.0,179.0,25.0,167.0,41.0,44.0,114.0,120.0,163.0,108.0,5.0,40.0,147.0,99.0,82.0,126.0,92.0,181.0,22.0,124.0,187.0,174.0,62.0,128.0,45.0,190.0,76.0,66.0,199.0,175.0,21.0,156.0,54.0,62.0,169.0,67.0,31.0,46.0,67.0,159.0,129.0,37.0,148.0,32.0,41.0,105.0,99.0,99.0,44.0,143.0,78.0,89.0,50.0,147.0,73.0];
	    let y = vec![191.0,105.0,167.0,65.0,90.0,87.0,118.0,197.0,70.0,99.0,161.0,7.0,124.0,17.0,175.0,130.0,95.0,105.0,36.0,104.0,85.0,153.0,187.0,19.0,60.0,64.0,39.0,195.0,110.0,196.0,170.0,59.0,151.0,98.0,175.0,157.0,139.0,112.0,166.0,70.0,119.0,154.0,179.0,197.0,141.0,192.0,192.0,71.0,128.0,68.0,25.0,110.0,40.0,138.0,164.0,178.0,50.0,20.0,13.0,94.0,2.0,171.0,171.0,199.0,41.0,173.0,109.0,165.0,59.0,193.0,157.0,81.0,46.0,23.0,184.0,173.0,131.0,64.0,55.0,54.0,48.0,26.0,123.0,27.0,63.0,42.0,113.0,156.0,3.0,10.0,22.0,40.0,109.0,108.0,99.0,194.0,48.0,143.0,191.0,39.0,74.0,195.0,13.0,61.0,151.0,88.0,76.0,107.0,122.0,156.0,188.0,130.0,185.0,160.0,33.0,198.0,193.0,37.0,191.0,43.0,117.0,131.0,53.0,131.0,190.0,163.0,39.0,94.0,100.0,151.0,191.0,176.0,171.0,36.0,71.0,105.0,163.0,16.0,143.0,183.0,185.0,132.0,194.0,140.0,157.0,175.0,51.0,143.0,105.0,54.0,101.0,139.0,192.0,64.0,60.0,151.0,189.0,36.0,155.0,106.0,199.0,67.0,142.0,59.0,63.0,52.0,38.0,171.0,76.0,164.0,148.0,167.0,91.0,44.0,133.0,92.0,120.0,109.0,46.0,158.0,124.0,129.0,100.0,149.0,11.0,108.0,120.0,98.0,166.0,41.0,178.0,6.0,67.0,157.0,176.0,59.0,130.0,153.0,1.0,107.0];
	    let r : f64 = -0.027452089361178177;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_2() {
	let x = vec![56.0,21.0,64.0,95.0,70.0,140.0,78.0,69.0,115.0,118.0,57.0,155.0,184.0,120.0,175.0,14.0,15.0,122.0,133.0,148.0,124.0,95.0,134.0,13.0,141.0,5.0,183.0,101.0,24.0,30.0,36.0,62.0,56.0,73.0,82.0,151.0,70.0,179.0,150.0,158.0,58.0,161.0,130.0,121.0,161.0,21.0,74.0,185.0,191.0,195.0,46.0,87.0,22.0,10.0,67.0,149.0,176.0,174.0,37.0,54.0,105.0,120.0,168.0,59.0,78.0,182.0,171.0,12.0,106.0,101.0,121.0,59.0,136.0,105.0,74.0,160.0,138.0,143.0,150.0,82.0,132.0,134.0,160.0,173.0,185.0,7.0,139.0,82.0,154.0,93.0,140.0,134.0,122.0,86.0,136.0,6.0,138.0,182.0,88.0,130.0,33.0,27.0,88.0,196.0,193.0,34.0,18.0,61.0,136.0,59.0,109.0,81.0,98.0,106.0,42.0,42.0,74.0,192.0,170.0,8.0,193.0,178.0,53.0,151.0,41.0,34.0,136.0,92.0,101.0,144.0,168.0,20.0,194.0,179.0,198.0,102.0,25.0,133.0,22.0,157.0,153.0,156.0,88.0,168.0,28.0,106.0,18.0,184.0,171.0,171.0,127.0,123.0,35.0,26.0,158.0,32.0,102.0,34.0,65.0,139.0,96.0,197.0,34.0,189.0,150.0,193.0,178.0,78.0,166.0,66.0,123.0,109.0,122.0,188.0,15.0,17.0,5.0,31.0,125.0,132.0,72.0,83.0,55.0,106.0,21.0,107.0,79.0,170.0,177.0,52.0,13.0,136.0,186.0,197.0,110.0,86.0,89.0,109.0,94.0,83.0];
	    let y = vec![7.0,105.0,62.0,31.0,3.0,56.0,136.0,134.0,21.0,58.0,188.0,39.0,196.0,6.0,97.0,114.0,100.0,193.0,180.0,117.0,35.0,86.0,117.0,180.0,132.0,66.0,104.0,94.0,80.0,127.0,79.0,140.0,25.0,86.0,187.0,70.0,132.0,68.0,176.0,111.0,24.0,92.0,46.0,187.0,113.0,46.0,99.0,199.0,10.0,15.0,62.0,45.0,1.0,148.0,135.0,30.0,188.0,111.0,0.0,49.0,145.0,110.0,171.0,62.0,153.0,95.0,157.0,123.0,18.0,66.0,189.0,2.0,39.0,186.0,188.0,134.0,100.0,128.0,49.0,91.0,31.0,48.0,65.0,31.0,90.0,190.0,125.0,129.0,24.0,100.0,148.0,53.0,187.0,155.0,122.0,85.0,15.0,42.0,27.0,160.0,45.0,102.0,2.0,104.0,44.0,118.0,4.0,183.0,60.0,90.0,30.0,37.0,67.0,59.0,175.0,171.0,45.0,13.0,2.0,69.0,3.0,169.0,31.0,53.0,54.0,144.0,13.0,36.0,131.0,108.0,165.0,182.0,167.0,18.0,165.0,198.0,8.0,7.0,14.0,21.0,125.0,38.0,172.0,124.0,98.0,64.0,181.0,140.0,190.0,13.0,80.0,107.0,93.0,172.0,186.0,16.0,62.0,124.0,89.0,143.0,95.0,46.0,170.0,17.0,86.0,12.0,160.0,16.0,105.0,78.0,155.0,139.0,43.0,183.0,38.0,119.0,153.0,158.0,193.0,97.0,107.0,131.0,90.0,178.0,60.0,127.0,42.0,159.0,108.0,144.0,82.0,154.0,198.0,123.0,19.0,28.0,144.0,19.0,124.0,177.0];
	    let r : f64 = 0.00843433862342497;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_3() {
	let x = vec![188.0,110.0,196.0,15.0,188.0,80.0,117.0,79.0,186.0,132.0,195.0,136.0,35.0,138.0,67.0,155.0,52.0,79.0,118.0,6.0,111.0,4.0,124.0,83.0,142.0,193.0,42.0,176.0,81.0,51.0,42.0,135.0,94.0,10.0,147.0,93.0,11.0,121.0,79.0,179.0,64.0,56.0,114.0,43.0,47.0,82.0,119.0,27.0,79.0,37.0,109.0,41.0,86.0,39.0,191.0,72.0,181.0,68.0,46.0,81.0,138.0,142.0,199.0,67.0,45.0,135.0,173.0,16.0,9.0,100.0,44.0,65.0,170.0,143.0,29.0,39.0,77.0,7.0,118.0,93.0,78.0,18.0,149.0,50.0,123.0,14.0,106.0,103.0,136.0,102.0,127.0,73.0,157.0,125.0,162.0,25.0,118.0,11.0,136.0,147.0,35.0,190.0,140.0,27.0,84.0,161.0,0.0,35.0,76.0,199.0,83.0,129.0,39.0,85.0,135.0,74.0,190.0,184.0,174.0,194.0,192.0,111.0,72.0,174.0,161.0,47.0,141.0,143.0,13.0,182.0,104.0,138.0,178.0,131.0,145.0,116.0,61.0,41.0,60.0,3.0,81.0,56.0,134.0,180.0,102.0,98.0,190.0,48.0,62.0,154.0,13.0,175.0,131.0,90.0,177.0,189.0,69.0,87.0,147.0,67.0,132.0,129.0,116.0,94.0,116.0,70.0,57.0,32.0,118.0,189.0,193.0,112.0,36.0,118.0,22.0,117.0,112.0,109.0,174.0,81.0,30.0,105.0,168.0,190.0,119.0,72.0,198.0,102.0,178.0,72.0,110.0,87.0,132.0,138.0,20.0,38.0,16.0,4.0,159.0,158.0];
	    let y = vec![20.0,42.0,143.0,196.0,19.0,79.0,7.0,127.0,159.0,182.0,163.0,179.0,80.0,29.0,165.0,29.0,147.0,28.0,8.0,63.0,37.0,32.0,172.0,150.0,30.0,69.0,167.0,134.0,95.0,36.0,47.0,77.0,105.0,51.0,149.0,38.0,62.0,180.0,150.0,15.0,69.0,94.0,91.0,19.0,66.0,80.0,162.0,145.0,199.0,31.0,84.0,123.0,111.0,19.0,121.0,133.0,22.0,7.0,113.0,190.0,59.0,147.0,49.0,50.0,116.0,110.0,76.0,21.0,182.0,128.0,16.0,58.0,89.0,26.0,134.0,66.0,177.0,22.0,199.0,87.0,140.0,32.0,168.0,154.0,133.0,191.0,32.0,172.0,158.0,102.0,6.0,99.0,76.0,192.0,70.0,121.0,185.0,95.0,171.0,173.0,124.0,17.0,3.0,102.0,64.0,54.0,183.0,16.0,99.0,80.0,153.0,121.0,135.0,154.0,26.0,164.0,88.0,15.0,90.0,38.0,34.0,132.0,120.0,158.0,111.0,180.0,181.0,125.0,95.0,152.0,135.0,31.0,89.0,118.0,106.0,148.0,88.0,88.0,154.0,125.0,95.0,135.0,120.0,178.0,123.0,191.0,115.0,181.0,88.0,95.0,82.0,104.0,96.0,196.0,8.0,83.0,43.0,48.0,175.0,62.0,169.0,137.0,46.0,32.0,37.0,186.0,102.0,180.0,39.0,141.0,107.0,143.0,162.0,197.0,84.0,189.0,76.0,146.0,10.0,22.0,3.0,66.0,180.0,71.0,2.0,158.0,32.0,15.0,148.0,177.0,39.0,40.0,77.0,149.0,155.0,103.0,115.0,158.0,170.0,152.0];
	    let r : f64 = -0.05827220649957183;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_4() {
	let x = vec![55.0,83.0,9.0,66.0,96.0,21.0,187.0,188.0,149.0,114.0,96.0,3.0,183.0,72.0,192.0,94.0,44.0,82.0,21.0,41.0,53.0,127.0,72.0,176.0,7.0,141.0,79.0,156.0,91.0,125.0,58.0,58.0,76.0,114.0,169.0,53.0,186.0,90.0,92.0,14.0,195.0,141.0,103.0,164.0,156.0,113.0,172.0,46.0,168.0,84.0,71.0,141.0,81.0,9.0,13.0,121.0,144.0,91.0,182.0,192.0,61.0,54.0,3.0,58.0,81.0,194.0,6.0,28.0,138.0,62.0,147.0,101.0,24.0,168.0,170.0,90.0,55.0,155.0,32.0,143.0,61.0,13.0,81.0,98.0,38.0,4.0,56.0,21.0,74.0,61.0,138.0,71.0,197.0,113.0,167.0,109.0,148.0,62.0,85.0,93.0,17.0,178.0,15.0,0.0,176.0,74.0,78.0,113.0,159.0,14.0,198.0,83.0,132.0,23.0,142.0,105.0,158.0,106.0,80.0,173.0,98.0,127.0,152.0,85.0,75.0,50.0,176.0,110.0,157.0,41.0,119.0,159.0,0.0,91.0,147.0,34.0,37.0,12.0,198.0,118.0,102.0,23.0,151.0,45.0,109.0,5.0,140.0,186.0,124.0,172.0,58.0,153.0,8.0,26.0,176.0,68.0,121.0,132.0,166.0,195.0,131.0,184.0,46.0,32.0,137.0,39.0,135.0,12.0,194.0,129.0,128.0,32.0,86.0,140.0,190.0,145.0,19.0,153.0,92.0,34.0,165.0,118.0,129.0,37.0,45.0,90.0,185.0,30.0,158.0,65.0,31.0,55.0,188.0,77.0,18.0,28.0,16.0,101.0,87.0,24.0];
	    let y = vec![170.0,86.0,188.0,147.0,0.0,78.0,178.0,96.0,65.0,195.0,47.0,51.0,173.0,156.0,11.0,161.0,86.0,191.0,193.0,35.0,1.0,47.0,120.0,58.0,83.0,74.0,8.0,97.0,15.0,31.0,133.0,123.0,12.0,189.0,111.0,45.0,115.0,23.0,81.0,53.0,4.0,131.0,139.0,131.0,132.0,22.0,71.0,70.0,192.0,73.0,78.0,63.0,12.0,174.0,123.0,19.0,188.0,176.0,124.0,174.0,98.0,131.0,17.0,168.0,186.0,80.0,156.0,139.0,114.0,106.0,150.0,26.0,117.0,87.0,39.0,160.0,69.0,0.0,1.0,61.0,184.0,99.0,179.0,26.0,66.0,104.0,81.0,111.0,153.0,195.0,147.0,17.0,3.0,5.0,33.0,34.0,38.0,77.0,136.0,21.0,92.0,186.0,105.0,150.0,133.0,32.0,72.0,71.0,82.0,161.0,178.0,57.0,156.0,63.0,31.0,135.0,10.0,17.0,99.0,164.0,162.0,12.0,29.0,71.0,38.0,46.0,70.0,93.0,39.0,46.0,70.0,179.0,181.0,174.0,162.0,183.0,45.0,195.0,147.0,116.0,188.0,166.0,82.0,139.0,91.0,149.0,120.0,3.0,65.0,43.0,175.0,166.0,185.0,98.0,43.0,71.0,136.0,98.0,145.0,28.0,152.0,109.0,14.0,85.0,75.0,102.0,10.0,8.0,166.0,50.0,71.0,57.0,63.0,152.0,92.0,88.0,34.0,84.0,35.0,12.0,145.0,38.0,174.0,115.0,173.0,34.0,163.0,98.0,38.0,164.0,169.0,100.0,48.0,160.0,26.0,118.0,159.0,20.0,133.0,191.0];
	    let r : f64 = -0.09055457128474297;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_5() {
	let x = vec![112.0,175.0,47.0,77.0,138.0,166.0,26.0,11.0,138.0,70.0,57.0,24.0,94.0,179.0,164.0,113.0,54.0,98.0,142.0,21.0,21.0,108.0,168.0,76.0,149.0,6.0,128.0,85.0,13.0,147.0,82.0,79.0,71.0,176.0,69.0,136.0,172.0,160.0,56.0,134.0,29.0,129.0,47.0,163.0,24.0,71.0,52.0,31.0,88.0,0.0,46.0,73.0,161.0,20.0,10.0,176.0,31.0,106.0,158.0,164.0,10.0,58.0,151.0,22.0,69.0,187.0,137.0,69.0,10.0,35.0,1.0,131.0,53.0,9.0,131.0,52.0,58.0,168.0,109.0,137.0,197.0,171.0,104.0,154.0,42.0,0.0,19.0,2.0,83.0,37.0,107.0,106.0,137.0,99.0,151.0,85.0,124.0,63.0,56.0,142.0,169.0,124.0,100.0,35.0,69.0,29.0,144.0,134.0,178.0,53.0,60.0,5.0,114.0,158.0,148.0,136.0,137.0,74.0,132.0,33.0,187.0,135.0,1.0,102.0,71.0,187.0,143.0,28.0,114.0,141.0,139.0,58.0,69.0,130.0,87.0,65.0,90.0,31.0,113.0,67.0,9.0,11.0,61.0,28.0,64.0,146.0,144.0,21.0,64.0,4.0,112.0,184.0,4.0,8.0,15.0,57.0,175.0,102.0,174.0,100.0,91.0,104.0,165.0,2.0,182.0,79.0,171.0,75.0,191.0,2.0,21.0,71.0,131.0,103.0,119.0,158.0,49.0,146.0,26.0,22.0,67.0,146.0,133.0,114.0,92.0,156.0,124.0,139.0,192.0,160.0,159.0,38.0,120.0,45.0,119.0,186.0,139.0,118.0,139.0,48.0];
	    let y = vec![28.0,16.0,152.0,130.0,110.0,97.0,12.0,88.0,34.0,48.0,68.0,191.0,42.0,22.0,8.0,10.0,90.0,104.0,57.0,11.0,70.0,61.0,107.0,42.0,29.0,113.0,157.0,186.0,75.0,145.0,185.0,169.0,123.0,126.0,100.0,193.0,54.0,185.0,198.0,31.0,8.0,150.0,142.0,3.0,16.0,140.0,37.0,27.0,99.0,111.0,109.0,75.0,13.0,54.0,6.0,107.0,144.0,16.0,84.0,169.0,160.0,142.0,184.0,162.0,107.0,54.0,103.0,42.0,60.0,193.0,5.0,135.0,118.0,7.0,45.0,34.0,28.0,79.0,43.0,23.0,11.0,148.0,145.0,25.0,147.0,37.0,52.0,176.0,175.0,104.0,9.0,3.0,70.0,4.0,100.0,130.0,140.0,114.0,44.0,139.0,93.0,69.0,127.0,30.0,149.0,182.0,96.0,156.0,35.0,88.0,170.0,31.0,106.0,171.0,122.0,38.0,154.0,59.0,67.0,140.0,28.0,46.0,185.0,190.0,109.0,4.0,170.0,25.0,168.0,54.0,11.0,92.0,23.0,153.0,35.0,39.0,186.0,30.0,68.0,183.0,194.0,140.0,144.0,81.0,47.0,84.0,189.0,114.0,104.0,145.0,194.0,114.0,159.0,62.0,104.0,145.0,18.0,182.0,152.0,75.0,85.0,164.0,10.0,129.0,166.0,198.0,93.0,151.0,180.0,141.0,195.0,82.0,85.0,41.0,187.0,70.0,199.0,179.0,113.0,106.0,103.0,96.0,106.0,37.0,21.0,33.0,134.0,110.0,175.0,73.0,141.0,189.0,134.0,81.0,84.0,172.0,182.0,149.0,76.0,199.0];
	    let r : f64 = -0.06555335194613023;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_6() {
	let x = vec![143.0,197.0,142.0,99.0,104.0,155.0,179.0,178.0,166.0,65.0,74.0,110.0,138.0,79.0,86.0,20.0,106.0,42.0,180.0,102.0,81.0,151.0,21.0,189.0,26.0,41.0,83.0,114.0,76.0,14.0,163.0,156.0,16.0,133.0,193.0,9.0,138.0,85.0,121.0,31.0,41.0,160.0,87.0,187.0,4.0,171.0,20.0,149.0,125.0,82.0,143.0,88.0,73.0,101.0,99.0,16.0,139.0,159.0,113.0,157.0,56.0,113.0,196.0,138.0,116.0,27.0,110.0,5.0,85.0,152.0,190.0,177.0,142.0,145.0,12.0,28.0,77.0,136.0,21.0,108.0,101.0,37.0,42.0,164.0,186.0,23.0,93.0,14.0,8.0,77.0,174.0,187.0,4.0,79.0,14.0,53.0,124.0,138.0,120.0,2.0,107.0,26.0,100.0,193.0,45.0,40.0,191.0,98.0,12.0,150.0,187.0,174.0,155.0,52.0,132.0,140.0,59.0,152.0,148.0,60.0,123.0,170.0,94.0,106.0,7.0,34.0,113.0,162.0,24.0,118.0,167.0,196.0,197.0,25.0,160.0,87.0,7.0,134.0,26.0,160.0,113.0,140.0,182.0,66.0,62.0,177.0,153.0,73.0,17.0,47.0,157.0,136.0,101.0,144.0,98.0,119.0,158.0,146.0,84.0,157.0,173.0,189.0,17.0,22.0,155.0,85.0,194.0,58.0,31.0,165.0,14.0,106.0,67.0,184.0,14.0,59.0,76.0,159.0,79.0,171.0,65.0,34.0,90.0,37.0,163.0,175.0,110.0,11.0,96.0,50.0,88.0,95.0,112.0,100.0,90.0,28.0,93.0,73.0,179.0,14.0];
	    let y = vec![14.0,104.0,54.0,86.0,122.0,108.0,80.0,181.0,48.0,44.0,198.0,152.0,86.0,33.0,1.0,7.0,92.0,59.0,59.0,74.0,67.0,55.0,120.0,179.0,63.0,129.0,35.0,16.0,64.0,37.0,9.0,3.0,116.0,132.0,77.0,121.0,35.0,99.0,187.0,82.0,137.0,30.0,187.0,56.0,174.0,56.0,47.0,130.0,38.0,80.0,30.0,101.0,71.0,79.0,63.0,185.0,150.0,141.0,64.0,38.0,84.0,92.0,142.0,145.0,138.0,35.0,56.0,168.0,83.0,44.0,89.0,83.0,170.0,58.0,91.0,89.0,19.0,150.0,100.0,46.0,195.0,161.0,11.0,41.0,174.0,34.0,95.0,111.0,52.0,41.0,13.0,128.0,140.0,44.0,134.0,89.0,197.0,12.0,116.0,92.0,85.0,47.0,119.0,170.0,67.0,61.0,99.0,71.0,73.0,163.0,18.0,139.0,7.0,82.0,168.0,113.0,191.0,91.0,48.0,79.0,183.0,43.0,197.0,7.0,166.0,76.0,139.0,198.0,127.0,75.0,8.0,199.0,142.0,48.0,119.0,193.0,101.0,126.0,127.0,120.0,184.0,163.0,104.0,193.0,154.0,141.0,37.0,18.0,14.0,29.0,57.0,78.0,184.0,45.0,166.0,146.0,166.0,20.0,78.0,38.0,95.0,97.0,188.0,91.0,91.0,40.0,88.0,186.0,30.0,184.0,180.0,110.0,21.0,158.0,108.0,138.0,70.0,49.0,18.0,138.0,147.0,28.0,163.0,36.0,147.0,53.0,177.0,74.0,141.0,167.0,155.0,195.0,192.0,55.0,182.0,191.0,69.0,8.0,54.0,107.0];
	    let r : f64 = 0.007116467412194736;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_7() {
	let x = vec![102.0,165.0,187.0,32.0,135.0,9.0,77.0,17.0,45.0,189.0,155.0,99.0,98.0,13.0,2.0,145.0,161.0,14.0,181.0,170.0,109.0,140.0,61.0,199.0,126.0,138.0,60.0,4.0,78.0,24.0,43.0,1.0,186.0,78.0,14.0,8.0,45.0,90.0,3.0,109.0,133.0,17.0,196.0,87.0,111.0,73.0,136.0,138.0,40.0,119.0,131.0,38.0,77.0,128.0,14.0,111.0,164.0,194.0,128.0,88.0,22.0,36.0,65.0,93.0,88.0,83.0,175.0,119.0,93.0,193.0,93.0,175.0,171.0,68.0,3.0,8.0,196.0,190.0,89.0,71.0,89.0,32.0,16.0,106.0,15.0,187.0,69.0,59.0,23.0,103.0,187.0,98.0,114.0,65.0,74.0,88.0,75.0,164.0,178.0,166.0,197.0,37.0,184.0,153.0,5.0,18.0,89.0,150.0,164.0,151.0,192.0,69.0,82.0,87.0,175.0,6.0,87.0,8.0,181.0,118.0,177.0,51.0,69.0,162.0,119.0,141.0,170.0,52.0,154.0,120.0,115.0,59.0,40.0,138.0,100.0,173.0,187.0,120.0,110.0,48.0,191.0,8.0,17.0,16.0,74.0,51.0,169.0,31.0,25.0,126.0,46.0,45.0,162.0,127.0,169.0,77.0,61.0,166.0,81.0,164.0,101.0,134.0,116.0,99.0,14.0,52.0,132.0,168.0,141.0,144.0,72.0,87.0,33.0,194.0,21.0,177.0,49.0,140.0,49.0,136.0,64.0,119.0,83.0,3.0,53.0,58.0,126.0,146.0,29.0,80.0,64.0,99.0,20.0,183.0,79.0,28.0,176.0,93.0,21.0,88.0];
	    let y = vec![81.0,79.0,8.0,82.0,144.0,95.0,142.0,196.0,165.0,157.0,159.0,137.0,66.0,170.0,126.0,14.0,92.0,180.0,121.0,62.0,50.0,161.0,126.0,51.0,24.0,108.0,100.0,145.0,108.0,109.0,0.0,133.0,116.0,4.0,43.0,87.0,125.0,119.0,132.0,100.0,188.0,161.0,181.0,32.0,123.0,62.0,102.0,3.0,193.0,92.0,59.0,131.0,44.0,73.0,53.0,62.0,56.0,107.0,186.0,31.0,114.0,65.0,41.0,122.0,53.0,109.0,80.0,82.0,184.0,14.0,196.0,66.0,186.0,137.0,163.0,44.0,104.0,65.0,189.0,149.0,94.0,77.0,190.0,67.0,185.0,3.0,114.0,186.0,67.0,30.0,45.0,14.0,14.0,123.0,180.0,45.0,119.0,152.0,193.0,173.0,73.0,125.0,160.0,84.0,102.0,105.0,99.0,25.0,165.0,151.0,100.0,177.0,171.0,65.0,176.0,19.0,83.0,6.0,148.0,180.0,158.0,99.0,122.0,17.0,180.0,46.0,102.0,163.0,199.0,3.0,86.0,164.0,49.0,3.0,182.0,126.0,89.0,14.0,153.0,21.0,69.0,151.0,126.0,154.0,4.0,156.0,54.0,95.0,9.0,117.0,173.0,80.0,90.0,170.0,72.0,31.0,155.0,117.0,142.0,57.0,195.0,140.0,1.0,155.0,167.0,36.0,64.0,16.0,189.0,163.0,191.0,137.0,37.0,139.0,0.0,90.0,129.0,17.0,160.0,135.0,126.0,5.0,161.0,57.0,142.0,48.0,169.0,108.0,82.0,158.0,56.0,68.0,46.0,82.0,20.0,79.0,13.0,17.0,141.0,190.0];
	    let r : f64 = -0.07553838652814762;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_8() {
	let x = vec![4.0,173.0,30.0,12.0,145.0,189.0,198.0,122.0,33.0,126.0,109.0,69.0,181.0,41.0,185.0,195.0,132.0,187.0,185.0,148.0,127.0,83.0,59.0,176.0,0.0,47.0,63.0,18.0,27.0,189.0,154.0,23.0,149.0,170.0,98.0,134.0,142.0,134.0,106.0,16.0,163.0,110.0,176.0,60.0,37.0,153.0,20.0,8.0,149.0,130.0,155.0,188.0,178.0,5.0,100.0,100.0,33.0,142.0,153.0,161.0,108.0,105.0,149.0,27.0,89.0,122.0,6.0,173.0,69.0,199.0,113.0,186.0,144.0,9.0,85.0,81.0,177.0,29.0,33.0,36.0,86.0,38.0,126.0,50.0,40.0,185.0,46.0,66.0,156.0,116.0,162.0,0.0,106.0,109.0,119.0,111.0,52.0,73.0,190.0,24.0,165.0,72.0,47.0,25.0,112.0,198.0,149.0,92.0,35.0,98.0,178.0,165.0,39.0,191.0,85.0,197.0,163.0,144.0,124.0,125.0,90.0,1.0,77.0,87.0,104.0,160.0,180.0,35.0,184.0,7.0,121.0,39.0,138.0,27.0,198.0,78.0,161.0,39.0,62.0,50.0,151.0,14.0,173.0,129.0,178.0,2.0,4.0,32.0,28.0,102.0,167.0,75.0,197.0,183.0,128.0,170.0,39.0,89.0,160.0,152.0,3.0,183.0,179.0,17.0,134.0,41.0,139.0,138.0,118.0,5.0,95.0,142.0,11.0,167.0,79.0,162.0,148.0,169.0,105.0,39.0,16.0,188.0,41.0,198.0,55.0,93.0,60.0,163.0,30.0,62.0,189.0,128.0,1.0,34.0,84.0,46.0,58.0,144.0,81.0,95.0];
	    let y = vec![160.0,12.0,131.0,24.0,148.0,100.0,66.0,31.0,30.0,144.0,52.0,171.0,181.0,33.0,78.0,82.0,144.0,144.0,63.0,2.0,121.0,185.0,38.0,69.0,48.0,127.0,158.0,73.0,29.0,160.0,87.0,108.0,179.0,53.0,124.0,78.0,170.0,139.0,34.0,32.0,1.0,37.0,116.0,50.0,99.0,96.0,172.0,22.0,2.0,116.0,149.0,80.0,54.0,171.0,36.0,152.0,82.0,36.0,13.0,158.0,27.0,11.0,87.0,26.0,45.0,66.0,122.0,168.0,198.0,111.0,45.0,135.0,169.0,81.0,190.0,176.0,194.0,48.0,22.0,20.0,178.0,7.0,160.0,115.0,158.0,3.0,62.0,176.0,125.0,4.0,60.0,43.0,153.0,92.0,1.0,123.0,175.0,1.0,93.0,28.0,180.0,182.0,6.0,19.0,6.0,73.0,112.0,135.0,44.0,164.0,91.0,110.0,123.0,2.0,26.0,188.0,176.0,190.0,87.0,22.0,43.0,108.0,177.0,24.0,162.0,196.0,111.0,43.0,74.0,115.0,26.0,53.0,194.0,48.0,19.0,31.0,99.0,184.0,120.0,113.0,11.0,61.0,21.0,13.0,57.0,196.0,120.0,88.0,188.0,27.0,93.0,52.0,89.0,170.0,26.0,55.0,188.0,158.0,137.0,195.0,41.0,74.0,47.0,72.0,20.0,62.0,99.0,123.0,129.0,190.0,116.0,56.0,107.0,54.0,29.0,178.0,162.0,42.0,170.0,29.0,24.0,170.0,71.0,58.0,95.0,67.0,68.0,190.0,197.0,13.0,52.0,117.0,150.0,134.0,31.0,72.0,32.0,21.0,169.0,66.0];
	    let r : f64 = 0.04344281078331533;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_int_200_9() {
	let x = vec![92.0,170.0,79.0,188.0,176.0,33.0,135.0,79.0,90.0,112.0,175.0,168.0,76.0,180.0,59.0,189.0,126.0,132.0,68.0,153.0,82.0,160.0,126.0,46.0,135.0,160.0,103.0,79.0,121.0,58.0,24.0,76.0,185.0,114.0,188.0,70.0,66.0,37.0,9.0,186.0,185.0,58.0,16.0,81.0,39.0,109.0,158.0,119.0,26.0,141.0,67.0,122.0,192.0,40.0,77.0,118.0,135.0,121.0,110.0,27.0,165.0,9.0,78.0,96.0,26.0,71.0,106.0,195.0,72.0,63.0,65.0,69.0,61.0,128.0,21.0,2.0,136.0,27.0,5.0,124.0,77.0,155.0,57.0,4.0,110.0,178.0,41.0,79.0,139.0,42.0,141.0,170.0,10.0,171.0,34.0,79.0,147.0,67.0,96.0,65.0,7.0,51.0,194.0,80.0,32.0,108.0,135.0,79.0,97.0,172.0,103.0,95.0,98.0,92.0,76.0,119.0,155.0,87.0,186.0,199.0,150.0,90.0,60.0,110.0,155.0,32.0,191.0,131.0,59.0,100.0,101.0,61.0,75.0,14.0,73.0,12.0,26.0,170.0,127.0,119.0,190.0,14.0,52.0,5.0,189.0,39.0,134.0,14.0,82.0,66.0,17.0,70.0,63.0,0.0,34.0,160.0,75.0,121.0,27.0,142.0,130.0,174.0,196.0,36.0,194.0,180.0,149.0,85.0,61.0,12.0,39.0,161.0,47.0,136.0,144.0,35.0,119.0,75.0,155.0,111.0,170.0,168.0,188.0,113.0,112.0,30.0,12.0,63.0,9.0,167.0,79.0,39.0,129.0,181.0,123.0,155.0,77.0,166.0,197.0,153.0];
	    let y = vec![69.0,75.0,36.0,190.0,181.0,167.0,152.0,76.0,185.0,160.0,184.0,128.0,32.0,65.0,193.0,3.0,120.0,19.0,181.0,57.0,61.0,12.0,10.0,47.0,69.0,181.0,31.0,14.0,161.0,156.0,179.0,23.0,153.0,81.0,69.0,176.0,104.0,141.0,131.0,128.0,42.0,154.0,28.0,4.0,105.0,36.0,178.0,94.0,32.0,88.0,85.0,163.0,47.0,181.0,123.0,98.0,65.0,143.0,48.0,68.0,43.0,7.0,129.0,146.0,188.0,135.0,15.0,21.0,143.0,152.0,122.0,71.0,21.0,147.0,65.0,144.0,17.0,66.0,158.0,179.0,23.0,79.0,12.0,5.0,97.0,105.0,158.0,128.0,134.0,33.0,26.0,114.0,151.0,199.0,17.0,88.0,167.0,81.0,87.0,177.0,143.0,82.0,96.0,79.0,17.0,152.0,76.0,153.0,93.0,110.0,53.0,58.0,167.0,23.0,192.0,167.0,189.0,127.0,47.0,91.0,195.0,78.0,181.0,9.0,115.0,105.0,135.0,133.0,119.0,53.0,115.0,171.0,53.0,54.0,18.0,145.0,171.0,176.0,158.0,193.0,59.0,35.0,69.0,34.0,145.0,81.0,132.0,115.0,165.0,22.0,15.0,116.0,132.0,164.0,134.0,48.0,64.0,0.0,192.0,118.0,115.0,134.0,190.0,148.0,65.0,27.0,62.0,155.0,100.0,195.0,149.0,58.0,35.0,48.0,50.0,157.0,106.0,39.0,143.0,77.0,99.0,107.0,139.0,79.0,54.0,117.0,180.0,95.0,196.0,85.0,80.0,90.0,105.0,49.0,76.0,62.0,180.0,192.0,24.0,170.0];
	    let r : f64 = -0.04887052935301446;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn spearman_float_200_0() {
	let x = vec![0.6146145653921842,0.07183297665356347,0.9657563132134285,0.4569318539639291,0.38284634869340406,0.846824605274309,0.2742667894313132,0.908045342390545,0.895428672266301,0.7181492314505846,0.4475156406794193,0.8766729767546604,0.02839422783122736,0.6700307903662989,0.15802769562362085,0.8598740459161797,0.789920868612985,0.7864112966365367,0.9439028070338628,0.5576873306305342,0.8288933746180377,0.8207947989319805,0.06824561426495312,0.9833966832409015,0.010343124512823931,0.5636161046457155,0.4732836922600031,0.6361249116994472,0.8801679805118181,0.20326203601350457,0.16551832570979153,0.5329375195419251,0.9521159263783846,0.6216081526045799,0.17760199798061727,0.3222115722436376,0.6657257924766805,0.2685366120074316,0.003585628393424467,0.0304638491152065,0.6096821049883085,0.26378484520488565,0.5007107034002481,0.03155750380569311,0.006916907164555064,0.7858556420465276,0.6154863079771298,0.5838060730953145,0.3971314831662758,0.4571208621146754,0.40739707062551667,0.08665087184783471,0.13178326116814942,0.9535651891618121,0.17514945992907216,0.9196458239501007,0.38303604302745353,0.2011865245545491,0.7312684121751399,0.5994108549945792,0.1067179988258915,0.6995971313323129,0.12053469683547313,0.9379243829746391,0.4241240547426246,0.9401512898142536,0.16164733297902145,0.33057899441373884,0.2745631315127317,0.5542572507799042,0.7945116085623714,0.3660049761562061,0.7173072003861877,0.107128616722733,0.3771661450205799,0.8794371774202409,0.6883837150700416,0.2808125610500266,0.31844520281353494,0.49247541961184793,0.4571766322004083,0.38212451178791085,0.8216037910007301,0.029791768478883984,0.0018787776333584194,0.9828584365288174,0.8423722735763634,0.10179416159382015,0.5766891836614678,0.6528447918234873,0.9440580237006901,0.7491949658345192,0.2991611279188171,0.13284881188160325,0.29852888054256166,0.2545997938361243,0.099417609749473,0.6188579007479214,0.14509675692658108,0.9542828434226753,0.5357329271041656,0.5403081103740272,0.013382952283554683,0.03584301660568656,0.9715269977258183,0.17972228871564788,0.045441578141466765,0.37121286466489656,0.8527173227398859,0.6726954422404303,0.19034753561353135,0.5861489992073313,0.18118952888868267,0.8643548367424638,0.6736162691500693,0.07054929153856038,0.15822541685519653,0.07253954738565593,0.616809053494008,0.81015498814571,0.31801165951319954,0.47378890966438725,0.8858634809677918,0.8864383903659002,0.6076840099739331,0.8479293479585683,0.023939073304468983,0.5039701465783462,0.42919824467567114,0.5015354377255218,0.92378315925568,0.438007565764145,0.6702527427234766,0.5858641594540904,0.580602163162979,0.811744285645516,0.2671767271898525,0.7117913629158923,0.23648700602979889,0.3893000561824549,0.4001398515641187,0.9539282562278494,0.5660973802644355,0.12643848690337867,0.25627053868498517,0.415578617892272,0.5923828362609685,0.08336933005025604,0.6095808791874491,0.42440131097755107,0.06720048183691663,0.822241741373478,0.3238737853474567,0.6392428696166598,0.9015498787559781,0.3343672760790112,0.6839657610799931,0.512755763021815,0.19879882891100265,0.41899621378873386,0.5262728465024475,0.4316205647721698,0.8009322629992118,0.6935411588289156,0.06065360296209743,0.04191164185576879,0.07411005092226242,0.13468268261798633,0.8227793587606389,0.7820056243051402,0.22897141302089163,0.6143079373188011,0.5136442618246629,0.6832665849464609,0.07666077216571077,0.93886520665523,0.101747095907743,0.31303894586066294,0.33078310113232867,0.4816741714730911,0.20795894997842845,0.8154117760916525,0.56721826084414,0.2625752705068012,0.22407899673612397,0.37462845743018114,0.9629218497586228,0.6702839401846656,0.46429155949274115,0.02304956793350077,0.2786192658271315,0.6482222201739646,0.828245649990952,0.6494069962085608,0.2527316181553452,0.09527778919076224,0.17623618781970485,0.6667570636713449,0.3974218259310167,0.652407516495587];
	    let y = vec![0.591340985114411,0.39812240024225554,0.7744063585931343,0.5631325934626088,0.4446900600035574,0.8012727967891817,0.5509602089287357,0.08931731763274842,0.5132030272759581,0.7796204818086304,0.3407680624579008,0.48659991203261554,0.0026322761929932215,0.5352626310736383,0.823678523354259,0.8991686062233811,0.10947398352399529,0.15727095060678342,0.8941567145539077,0.5842833655127535,0.6980170905238624,0.17762107681757766,0.20425759092823392,0.8883550021350247,0.9128852144529411,0.37336455520000345,0.9872953087027495,0.5419983402200632,0.2328085916681112,0.13258630685257444,0.018045178046731114,0.6000018225014717,0.12410207159364028,0.6190802538272484,0.19408159546098247,0.39302041670756493,0.9555438120979518,0.6066128657554228,0.4928228534000595,0.4518605439041288,0.7783151243661488,0.32771992514132064,0.8066133831525774,0.8413899400897554,0.7262573616414456,0.9459470717558917,0.13854815119154618,0.7473512418369848,0.6730201917134746,0.6743164125044481,0.63511945471844,0.8551821359225615,0.25893430095222447,0.013857703281185962,0.49763091096795653,0.5057286863933462,0.32404337810362205,0.0953230024748285,0.25771621936810973,0.7374338571998025,0.2317060632233091,0.2310876398969035,0.10753729948302682,0.3736934620784068,0.4319790429443183,0.8680495277836765,0.7641046514504855,0.6634210199006296,0.8462329887367587,0.43022115980188047,0.7781144601609236,0.5228496759486845,0.8056115467642814,0.040780900466296566,0.20772281305065643,0.8989953662557323,0.3168633895071279,0.932457382504315,0.05370278469544576,0.7141614257246351,0.21927384515717396,0.7488879893599804,0.7211217465734995,0.2079871345269535,0.03222898909465299,0.5019031184220168,0.6232112383209929,0.3238166093825191,0.8725552303078707,0.9957229446360736,0.4104818790430683,0.17492821295247585,0.8004158814572817,0.5900750585473942,0.5579777632079503,0.1744414761700689,0.5747740335762462,0.2665477150102774,0.3726020500742835,0.6222883918902785,0.42396272779147837,0.02724728855429559,0.47025834758595764,0.3039463445574805,0.5152425584882235,0.3906922628270425,0.433205253371842,0.5569854158292024,0.5116487508343117,0.5256829087156498,0.7055813366618336,0.3139846013029005,0.5333102937492421,0.4646080771458003,0.39089280000465965,0.9097117266478727,0.2767572687911998,0.38115276721882674,0.5246405214866452,0.05224540788041865,0.19313555594597243,0.7732084719516961,0.5795696068273234,0.3352145427283356,0.3718606075164007,0.03904438294748236,0.4515615837625474,0.31768873255977026,0.3525120597996505,0.472006976931752,0.39044836459072985,0.7504236543312132,0.4010608610741604,0.08419514666900962,0.16882612340254954,0.2631330018192338,0.5622836959032695,0.4436145495143037,0.21016156414034803,0.5990881556554203,0.7893052079739276,0.6678976371830272,0.6023871582396166,0.0680716237239205,0.11370155449639385,0.23763731313846825,0.9468379247530792,0.05987262923628134,0.9150756497137886,0.23291996050032804,0.23115475677245323,0.9803899667641814,0.868509726659475,0.8364999124584833,0.8940523286993106,0.2124155688146223,0.5323050234486454,0.973550545143125,0.9302387148480692,0.7359830156223701,0.7827882575551566,0.9288102941088132,0.1547551326046931,0.7405640950509776,0.5405144428608989,0.9225746807670071,0.48794914954123303,0.6558882343073396,0.8162346695992938,0.5930275766474336,0.5997428506055884,0.7505524416888729,0.8710894669448223,0.06288955040233901,0.9034222055702099,0.43129698406622696,0.5921039530539765,0.16625228762407196,0.8609784944879053,0.8888914904625733,0.844560677366852,0.5770742884876817,0.29812960146139034,0.9097236446153728,0.6936684870394975,0.24502250836517592,0.8686897102691447,0.2522237279337679,0.42933822715229164,0.2913532242096679,0.5018919052419684,0.7247665787511265,0.5891184503806541,0.053430809663942314,0.8340782707867389,0.5060003154826311,0.3149133857945162,0.22492072302565114,0.8835400009608066,0.06217027654725904];
	    let r : f64 = 0.08394809870246758;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_1() {
	let x = vec![0.5904308846650692,0.12165400464360798,0.8041101095029811,0.6880292548826117,0.7680638811483835,0.09383693737538001,0.1987501042137909,0.791547291666596,0.9531520588077378,0.5808475902982847,0.6821457273520874,0.5374154491980337,0.09398097280381279,0.1701972618362485,0.4448649272424129,0.8535726003474592,0.7178242576704548,0.8903786634704557,0.8213437372695658,0.46987678989304216,0.9022617175657959,0.3021777297513657,0.925648411265984,0.7964444972550297,0.7449935835166317,0.862838485708145,0.8085598220238505,0.9874418196704343,0.2388795587781386,0.8227870140639567,0.5566249745037055,0.8840966413591312,0.7479999998405575,0.6073088791217051,0.2931587583307208,0.23533479478697317,0.13960924463038038,0.5017253820666576,0.278493279503231,0.9664660622936875,0.6717305161248184,0.31844407248680284,0.08086767123817651,0.31953805474690977,0.94071496463877,0.6219368619640626,0.16207900965912347,0.3908539508150649,0.32773636590758537,0.6109090809187561,0.5947590559709848,0.9925214224452111,0.4816356788062296,0.3320372920821657,0.3497867191591483,0.8793743545332362,0.9860853660718149,0.23768728518382265,0.8472261498540126,0.4937707952965529,0.5476204207207884,0.018393244919553298,0.5777979703459633,0.7388713118921572,0.7214579010674278,0.5302851908338121,0.8100313960370844,0.766646772988261,0.2436242600380366,0.9807124461065198,0.4743276586528271,0.4689632700373131,0.6157285305976943,0.9944823078391469,0.8055245851958015,0.5338304178366344,0.47522410524003156,0.3616283653881771,0.908663530283364,0.8641201339235576,0.35734833861648907,0.27167736615310867,0.9031329387217449,0.03629030095697361,0.6444439153205538,0.3484244739325604,0.6783868104244036,0.02788309487961549,0.3708918362292365,0.8483191532628509,0.4201325628098963,0.9735337849790386,0.04064913843860207,0.19280814899502186,0.011063200239830873,0.40124836221447147,0.5218826144754284,0.010357401939773525,0.20081382430339867,0.9628891604632548,0.6396711316551859,0.21464390610971207,0.6689731215394246,0.4072737293927853,0.02483762035462489,0.9286810259698264,0.293171997277622,0.31377049859333783,0.6042222463303004,0.860254819263836,0.9156562748196015,0.021552613811111065,0.4737885548960191,0.2633589859611095,0.17408933028858442,0.429745700435772,0.32196208549715843,0.5972809223713224,0.553909480104701,0.4593300717962091,0.7670237530548343,0.5008607603616207,0.437286994372755,0.05821001624490174,0.48898881529979943,0.5980732688492032,0.7848277913715227,0.8071154722944326,0.5692462263000568,0.8146702260978916,0.36980985629936414,0.8032355441738139,0.9101407673027403,0.9854194357150527,0.7530339624567337,0.3760797082024725,0.38254193070671827,0.6285672141324445,0.7216663653578842,0.5048122212113733,0.11715361555709292,0.11264342546910333,0.10143595130275218,0.4432609320259199,0.9666941360486417,0.12507221192387385,0.9284152881086521,0.6689518859075593,0.5063377765344649,0.4127373448932701,0.3571534757717,0.37754667550722065,0.7532347593027338,0.08228641708739481,0.07400873058822643,0.8451943001966119,0.7693423126270507,0.9792709013185459,0.544723685072377,0.8813192163079812,0.4580461003291316,0.4247697099305934,0.3973163023657341,0.14219663226263668,0.24728262309526516,0.9606597047060029,0.9027366728807434,0.18528578594297762,0.11357131848715896,0.3129684674593207,0.9752663198357902,0.9561696694291107,0.1255680202284769,0.4679107093060385,0.08791404950617732,0.19424882662652088,0.9810349531208863,0.17805751061511987,0.6489193955623456,0.9222345476769063,0.4345635215365109,0.8247708053241835,0.38073298276382617,0.38675707751255384,0.9632603937460346,0.37444494977131637,0.6397375769680732,0.23678936074944668,0.6149651565584223,0.5961462365498713,0.0005236643434682886,0.24357092050681461,0.3507077711595591,0.1632254309274518,0.7165268108626547,0.26579956773484914,0.6109347584750053,0.9986953602867802,0.1703053460824795,0.6678548454487915];
	    let y = vec![0.3657497109517397,0.23778726775233727,0.46381033357718016,0.8529956393744732,0.822923687487628,0.8071536048687173,0.789297495156983,0.8128294889891275,0.919841890646844,0.5375928621941285,0.2999271910119542,0.1540528069894771,0.6404710312528038,0.4823208704244003,0.07181268669325358,0.1388332528006222,0.37065199252896874,0.1502390156302864,0.085936330405053,0.8719990768567601,0.05781179165521211,0.6203561497545038,0.7914388300367011,0.594788591435689,0.8514699477719223,0.06526464641597374,0.637288683871952,0.14781626398761605,0.3910518295032629,0.32493249697343807,0.5944495216142351,0.6416507660980306,0.06307776796007947,0.1526492811853667,0.5497162905110586,0.08009817178367418,0.946479238773071,0.7860215969318844,0.9072210146398942,0.8332647298426126,0.786468355731687,0.11330560129148692,0.8531433686174082,0.27020128203884575,0.20854982341851325,0.13539313786465224,0.6229643838852634,0.9060961523789423,0.16878613656173036,0.24277348416021816,0.75212525555636,0.8657282897777684,0.5157019359278575,0.45353154000810836,0.5233055220144792,0.26329159515848855,0.7219400097190107,0.7055238845866342,0.8768340172736031,0.24464138636826338,0.561324722556838,0.21087683711884597,0.040363040259696836,0.3230043796529838,0.111819280830739,0.31615707715768515,0.00851429272119375,0.6958246868094504,0.5590097669418916,0.6793170797794081,0.09959643500239546,0.23284965248183287,0.7839227279977319,0.5917392628520272,0.4683285220087854,0.5243547694132424,0.9119182546758885,0.45178911985357484,0.9750989153856655,0.754596024141705,0.04943600477322352,0.11607784624799089,0.6718914059529797,0.9998349115802199,0.8187374469423486,0.06779030834396238,0.17801199247892396,0.65358897978416,0.8369172764879848,0.8778225748550348,0.5372593498206157,0.2534331965548633,0.8740105107506706,0.7899767280744194,0.95174134664408,0.22328106432481543,0.9347725783713222,0.22442216463692477,0.3916258833634455,0.6369532172516458,0.889277655341443,0.4846917243785971,0.844077725081608,0.055454175444271,0.6242048508482783,0.8180127500457022,0.2249910370143603,0.7765325506501475,0.42014374045922953,0.19818384149246848,0.055261302316685024,0.37365149137299003,0.6135075903161834,0.25701166761923666,0.7935824558564156,0.6595058374336626,0.9503662589517062,0.863886212638128,0.07815902022418098,0.5596009626987469,0.4535339025975951,0.8508979937920224,0.88693434323886,0.5243831327328403,0.5624547576900555,0.5045841230554083,0.05785442136572616,0.12224021789317352,0.7211006497803789,0.2519408394681174,0.786625261017871,0.0864208062905023,0.9622723878965523,0.2632976900635421,0.7737130970246248,0.15296823545280624,0.42071718426149385,0.639849902142104,0.4212961092298487,0.0035535199582296118,0.0796210985918181,0.9373500291242883,0.36379031894410996,0.9148314032414965,0.39859445526785153,0.4705061237688575,0.5724057754355037,0.9790107091927926,0.4850255816539256,0.9516998524675335,0.7931932043812251,0.7681053094974781,0.9803944932506359,0.9560772060343078,0.16749058458664523,0.01810838120243008,0.7768917795620462,0.5291200832652438,0.9436618673271947,0.9660381471749764,0.5644540907608574,0.07300152754874678,0.8181325166639378,0.6662154501573401,0.7531919373066677,0.6868755559330161,0.3553867835208383,0.5684361617464244,0.6502730917757024,0.8999414228321702,0.9180987992066527,0.22909855949568814,0.18463155009480203,0.23539966658017397,0.4526178366771135,0.10368296774062391,0.7510699705763089,0.1330547136918676,0.9513436257924149,0.022182791146901804,0.8717638594711654,0.8460429973340626,0.7461995038494686,0.30476923466884853,0.09128861997275173,0.7493618188269228,0.18392066019309483,0.22206080151044627,0.4658286094563746,0.3988150773212098,0.1292852342186741,0.038243186485438896,0.7549850642065402,0.9562172017461186,0.7364618940152561,0.6610588529091809,0.7569076615119253,0.35556715017094553,0.8599056811884374,0.7563749419472489];
	    let r : f64 = -0.04001050026250656;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_2() {
	let x = vec![0.24204113042544828,0.7426138852524664,0.8854768838645048,0.31234029700586363,0.29568986652914386,0.19069985427994074,0.03599044076898694,0.3244640940171797,0.6391803140934884,0.28687919202081336,0.09591196199080498,0.38109468296611404,0.256942001154451,0.6623982485453291,0.5417121999414737,0.7113673357078045,0.331924823008799,0.19344844325906452,0.567036646026934,0.6339245597376527,0.3640832777169032,0.2940845557460313,0.5475135456616211,0.7746953347926439,0.5369208510542214,0.9286208851131937,0.3554516255400336,0.542418983284331,0.3408529291315725,0.9422378939303752,0.749929811754438,0.8205562803925478,0.3817323203348081,0.7523312393844432,0.8969835205785354,0.32818001709296885,0.804128431996398,0.9662834034846098,0.32812861769168256,0.850211345470792,0.14301806123172234,0.11201564080383941,0.18600371720244646,0.3620691372406145,0.4236022616910583,0.9024173882524553,0.4956549575797451,0.6606044241151716,0.9317568725025094,0.12964277722486206,0.10649312285978174,0.21608808656699463,0.446327200751384,0.7178104656711395,0.35907345244598254,0.03285435882302845,0.7816986982503886,0.20127357946605262,0.7053386754986453,0.7019135226874567,0.7421890793861585,0.5642254043751863,0.5712153233354458,0.2687492006333009,0.9577059824067063,0.14083597784021584,0.5107282577985616,0.21320842926048134,0.635968342941306,0.4798830701915928,0.9652191970385794,0.9233622029310998,0.6574390770302266,0.6996742292153929,0.9194357441889134,0.7756012192171661,0.003825643241397114,0.08184176375865859,0.4732847941432491,0.6708450061360843,0.8037224020373372,0.535198113583013,0.28915524279632565,0.775303038229526,0.4086674018109917,0.35121798917630265,0.009145391498718403,0.15373419179845815,0.5948066206987714,0.449781976341765,0.43204610816583267,0.17891407592414188,0.40824624940076415,0.34755894970275936,0.894284346374968,0.27199602685947877,0.00615243268945731,0.7138185288506661,0.6282095257225061,0.1607284291748713,0.25208232905439987,0.14037577924842004,0.2133889193294124,0.4563564525381948,0.5852780769826094,0.16433566409596334,0.004874708588614607,0.6827419602690701,0.17603636885016904,0.3161889820141456,0.10875667536381717,0.7777968008498445,0.05017263316798504,0.35450228190312694,0.7676395422148669,0.09100143489400125,0.46035027607260914,0.4282812664440869,0.4205205322536094,0.8425285897059428,0.9837480442440243,0.9601933352631136,0.7256221517071447,0.48083879384109096,0.6736316802935877,0.12261517339325612,0.41382469654602194,0.8593530369346061,0.203606862110831,0.20059048615658592,0.4970253173751086,0.29252742808974197,0.26143157168358166,0.007228552797103771,0.43396239760682065,0.37115872862777133,0.5240584972953448,0.527577418010585,0.07717715030212258,0.49336369303719596,0.0629281977799685,0.8732811844662393,0.3770762683795954,0.8989091437835095,0.07026929953522532,0.12958535808961547,0.42789240581076016,0.12575283379095215,0.07868144682244915,0.4383198330868455,0.38366426566307466,0.5226868272906617,0.21032498656793763,0.05077079744797408,0.37030943745971834,0.05878546762756476,0.4297881991496457,0.9281213115975868,0.3541224081737493,0.16359698681268164,0.9457083193670249,0.6049090574008046,0.29031096641175247,0.7258685859405738,0.03371138897697479,0.07084040403516811,0.6959844928108291,0.662847093993828,0.9653147561433713,0.055155661779650145,0.8194973200316884,0.8586005260238039,0.12818133889980898,0.293601126351969,0.38298309190738455,0.10990701756774868,0.19696153124093163,0.3588124775767514,0.5464743396232118,0.8175226741996495,0.1245610786026009,0.693361204816775,0.6957228192074428,0.2923074442293335,0.7889074693080446,0.46742498673638966,0.7824277957763812,0.21780680567441235,0.6446566055694197,0.976332926249387,0.4344163429818535,0.33047699260834473,0.8784581367577916,0.21195704180336183,0.2657050633879061,0.11523565147497394,0.9523489813234605,0.7382121446830306,0.2224988897976774,0.47285477043344304];
	    let y = vec![0.42667198079542645,0.6521026861285286,0.5738756456099952,0.7603768901508602,0.1296137362897286,0.7179375658667484,0.08866719177408533,0.14273529097337,0.3137945649545978,0.8197974785003188,0.37573970423931313,0.7342155865512633,0.3135149338677543,0.8484252836657089,0.20009964287319504,0.769735920764609,0.7941466367652081,0.7325550886829656,0.5455267468699047,0.1291017689726227,0.30528443273142203,0.40915756657327274,0.19147243170664252,0.8984699737825549,0.5334116280881336,0.8397534175306849,0.7975569181217732,0.9716713591713718,0.24886201052415413,0.8086054869462349,0.07476726581711701,0.5573617469597006,0.764900418733483,0.7935722745577904,0.538177294209036,0.04003371857829541,0.7786844651746435,0.8543953220379652,0.3843466200221033,0.1282719182403116,0.7431810489141082,0.5213868201770785,0.8141595913309025,0.1540438496402572,0.26191531328780515,0.5683373483550698,0.3796184255135062,0.5532962296390069,0.6093901993527606,0.023347845477561857,0.20134295306638572,0.2921463444936767,0.30647471084112177,0.19009184195376883,0.31926442997751914,0.9751276794112208,0.6258883769049318,0.860202616902948,0.5755468653984891,0.05163785183701952,0.12070304375170848,0.40399219733983005,0.6052014951710247,0.11351031158661995,0.805770103835968,0.3843020058956059,0.5963084547941303,0.677133294305736,0.8342535666272007,0.11641564107508218,0.37642443880443166,0.7451013725275143,0.6853774428763381,0.7331124244547104,0.09722315320257602,0.21749726701387784,0.06768889713419757,0.23880063774229998,0.588548116967006,0.27767518236913324,0.0038120672458059612,0.2557260294166719,0.5308748207389204,0.21797436293259165,0.7539300481335421,0.23070213855469823,0.7573836650005306,0.8398903345417312,0.20924396452979577,0.5461151784232674,0.4149409795711494,0.880625606633769,0.4370223851399242,0.7231087413514371,0.7583657884066093,0.5385137664796975,0.7930206924732635,0.03479878179974383,0.8801415256654507,0.46829351789330087,0.5982390703622936,0.13477808166901772,0.5747438795456027,0.2045815326032141,0.8276155233528231,0.19407779201009223,0.0031182017850046595,0.6108109145231975,0.5652190050635697,0.5554670732637232,0.3421502861872572,0.4502913360132639,0.9506311263447652,0.26095839295307144,0.6403131914829898,0.25771669014368026,0.6341270437642246,0.2682473159819073,0.623926980351958,0.26899869366838236,0.7067650835962315,0.4366243381311248,0.9383143414636349,0.4169343591268452,0.5976317170586536,0.34136719008478267,0.3326220279009803,0.7225260649241304,0.003738048017174034,0.5399100939479532,0.7472631192275283,0.8677995189183517,0.8262328153233942,0.1916458061566635,0.09819902746744713,0.8421066463643991,0.0539138955084838,0.4623182297899352,0.5414431800243381,0.9624435984500596,0.8057260860942899,0.36598944724283966,0.6286943490685608,0.621782014693514,0.9923993868934057,0.7125134983490786,0.9930627521275405,0.23550510973997396,0.6849096031212953,0.7621547549249166,0.9537314026807422,0.2835962147620047,0.017923780591736493,0.5017046510596805,0.9852140915330087,0.7302791548055309,0.5941051087977427,0.9271562982908315,0.05606726587378841,0.19087899778698258,0.011746230364100607,0.8003395298821302,0.7664433000954547,0.13578327238572097,0.12398101550364593,0.08702560520156022,0.2599631937810504,0.24308400703174693,0.8942288926082769,0.8377393316968037,0.16146524038782706,0.48590813029847335,0.8362608685445162,0.7891992767156221,0.86326302339541,0.5783334799620956,0.37886233790063717,0.8117161663606799,0.8834022907402862,0.6090179673292511,0.23455505571532342,0.5508753155359735,0.21249859271849403,0.870030493340761,0.9382657813493533,0.4778516584815522,0.7100866152366406,0.10577010015702504,0.16659710044874143,0.6498339155037046,0.30833965662697604,0.08331404143771048,0.6756595671141726,0.2340990326045601,0.6164533628770229,0.7240537202220874,0.6623031318648182,0.6471585624707147,0.03219748133235556,0.7397007009060482];
	    let r : f64 = 0.07426835670891774;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_3() {
	let x = vec![0.40864923590649893,0.6957227134888626,0.5039793044625092,0.48635359853400917,0.5173190658759032,0.5974285061678898,0.11930375768689094,0.06743599037305048,0.17360317741967746,0.7632716003819804,0.526822416213773,0.8888526758057158,0.3475875426783053,0.4210320727655179,0.2796302726480553,0.5210690510523799,0.4574938028452443,0.4893681405302367,0.6346021058703722,0.6239338048364348,0.7758514087072466,0.6957285855864621,0.5084007032152935,0.32135279472140077,0.7995236256364824,0.4150957125260536,0.7251741971951481,0.4832846568806395,0.9667626070089805,0.8543057589856642,0.885345209342923,0.07649818366467342,0.06608375270298783,0.10126468811813039,0.5576538616852089,0.07783771795282701,0.22390524554420566,0.40919047506877537,0.5563109495266308,0.6906654081489193,0.7607192617336026,0.8024581048319198,0.10721636254657485,0.45973140869969975,0.26067231170658334,0.2867872289211336,0.26483561615815376,0.7756888681489367,0.7898858992013236,0.7842287077880692,0.06628939845825466,0.9881530607499888,0.5368214464625444,0.6206819659512268,0.3668175334975785,0.8713758691387858,0.37103928596220725,0.7554906316314564,0.7050527950849612,0.7173665056422498,0.9594564039387101,0.17654720742607022,0.4440055199425924,0.646419264769936,0.9164239561521269,0.7846152735055613,0.12116724108435772,0.9429355537648977,0.6630409010401831,0.19053785100022325,0.6453421283739443,0.11086073234667604,0.9458778824539007,0.49117555817823455,0.9524162094798697,0.7267481235660916,0.2831562954281628,0.8766214876097589,0.651248542931885,0.1797742870871687,0.9480852072410969,0.021554187524405632,0.2715983560324564,0.1119634586491588,0.8697469482253138,0.24142048890590873,0.5969743669362945,0.5251747162589051,0.3834379368660301,0.7398799588417142,0.26183597704029715,0.16902605293460193,0.10891641732515789,0.7792240910719607,0.19181286164177846,0.38232205098748095,0.8526552119552773,0.06090610834636645,0.18491461487124894,0.7344397785011771,0.7804468452484064,0.8656068992139931,0.6132203870133293,0.8152789684855184,0.048897583813794276,0.2758595068190186,0.8714485265853745,0.7665111275538982,0.3269068809025024,0.7887608533029493,0.17875063431173677,0.48472029881932344,0.4528539442009075,0.38785414100365345,0.6303733802188373,0.514984009733292,0.4728309708551647,0.568755669811803,0.8045739747472522,0.315063202122275,0.4918348209432455,0.07163316029544164,0.19516958633350334,0.19198884455328535,0.9634216309437132,0.6913404571979894,0.11323241489785008,0.3241912023339719,0.0883981540395431,0.004197689370182944,0.6823599488458985,0.49555383300949685,0.5479506064553202,0.595681516150401,0.8286383164965063,0.8855869361830625,0.16042068113225627,0.4685659044478909,0.8978690688415853,0.5632058489257551,0.5934361732513034,0.8578836501792507,0.16032770482252023,0.6495492902819103,0.3495758886743885,0.7285481433884815,0.35228983532427627,0.3488845727977805,0.5081133584643772,0.7605501914796888,0.18494608076511965,0.835207234234841,0.20614035742126058,0.7013408445968249,0.1305494032737794,0.07639207865705655,0.5065552991339175,0.6739412322582577,0.5631889238442237,0.6337046966554281,0.4681883993115731,0.9644352512697865,0.02185897072934262,0.8147069097455373,0.21195519861679435,0.1249350939580961,0.47142913343080906,0.13243025356484295,0.856015393745287,0.08979410171570368,0.7652942336484253,0.7125631544805978,0.48053407930660397,0.32635883545605004,0.8115629466763533,0.1346475333344871,0.4172845301720777,0.09529084393073817,0.5109495156914181,0.9951402550405353,0.5566161765479886,0.33591431454518017,0.8823021828635526,0.3220128071864681,0.8374995602886794,0.5888840374995562,0.5690779952361797,0.06040749511785315,0.49217119773643403,0.3620597467064369,0.8253024286709525,0.14596447435196114,0.4456897293960089,0.8668628650081275,0.157456086228015,0.20880207002417694,0.20757667534605528,0.3644861365462406,0.566237126174114,0.728086586649078];
	    let y = vec![0.8671231938539083,0.22679500119217966,0.7922835529432745,0.9505704086511213,0.19087679535286672,0.7568248778239981,0.23347786394132275,0.300841416913309,0.04678139005302295,0.8163066456139795,0.6016462209926566,0.11558393880894358,0.517924418931391,0.04014062114444383,0.1432972064069099,0.9662789741509673,0.04290513798285278,0.6824654124457817,0.7839736631816285,0.3750923557396266,0.3259390230238375,0.3801951025169834,0.3311354178333349,0.7854681248815863,0.8898982704287215,0.307792002611568,0.6692874226919977,0.9114583916936064,0.4740522500109303,0.5211583842286122,0.22138922374774217,0.5595907729425067,0.3297404763494427,0.23014496948981333,0.7732213028743646,0.8679591524492766,0.8168853092961289,0.2309697006775594,0.9922530601687041,0.885403567290524,0.34518331295734717,0.13998059564421117,0.45247004431028437,0.6541260165364494,0.1952696518534548,0.6667057610375756,0.9169410593335235,0.333490428604701,0.8534443548000235,0.35878406405990704,0.8217794547533827,0.8851449599575207,0.039006914601404596,0.8088701721392589,0.5599382240017324,0.37432414616884013,0.7923276673822252,0.5686765592135868,0.6779270848246887,0.6964221789601207,0.34508510640376167,0.8511302904525585,0.9960371081510343,0.542003640140586,0.10123053693945439,0.07290881544108996,0.06702636719904254,0.5414350518790889,0.2875655106530879,0.8918723283151245,0.8234413955489248,0.3694087658696438,0.31906336812344815,0.37296093118566864,0.5019565410782351,0.45874881586493366,0.05613853968773419,0.2538951396778646,0.7716603838928734,0.519820139446067,0.2304017053919737,0.6157026767801173,0.06380425369282094,0.5475280321122623,0.6184933464264855,0.5469675028011504,0.43254571179140855,0.13294359836112557,0.14930029583795046,0.30885717016851866,0.3103740432697879,0.6497873555808632,0.4462367227702949,0.2661351524888873,0.6001624381596471,0.2926449353955247,0.021303713340615538,0.5205368578243705,0.8753435961833326,0.12695766147911236,0.3185324261630956,0.3833797869070371,0.6988432753699998,0.11312203442428415,0.6781729949694862,0.5052139055206485,0.36780402903980647,0.0438474967040039,0.9551949402753748,0.3508361203024212,0.395106643231773,0.6032256066671736,0.5880605403705951,0.6691735499185997,0.5030525828666652,0.10898627920967618,0.8644676059115664,0.483978289200383,0.5833786071246059,0.12122266883456345,0.4289919597669194,0.7937853848949157,0.8403618108839311,0.3476860481060119,0.6841175366254815,0.5307242375234518,0.28267255742032427,0.5645058066695202,0.23146670599963015,0.49500260195070345,0.8316508225703642,0.25059805109595357,0.31916530296556744,0.5608755983614518,0.7029943122489785,0.6803900845064665,0.43556056548372346,0.40356553533992523,0.8089436520048663,0.8052822260359113,0.5256762315489559,0.6322208869385321,0.458354923124233,0.4438608484816895,0.7973513003021465,0.38844642742811997,0.6050612352475657,0.6962908880115278,0.12227907149246264,0.9145412297344816,0.7240788243930576,0.2791416351242155,0.4484158888399976,0.0707567792534658,0.1976812466799318,0.6809370281054148,0.012675184272882722,0.9858042242910603,0.933543903814878,0.08915235839147584,0.9992960305287124,0.07132301737564894,0.7593626029211409,0.17863100116846886,0.3633063572079336,0.41049612264761337,0.43417843864061556,0.6160468023043368,0.9839540212759456,0.5278552185834607,0.6728754264491978,0.5852048003935357,0.9025050396421911,0.8499447678972812,0.9049375188700842,0.9139633192563468,0.7409160431459595,0.7765572154561283,0.9835940386915,0.96566897106722,0.7989388288356442,0.14422679865175747,0.47038903811946087,0.8337812552663563,0.24482379696953172,0.08707402943671694,0.3613224378741049,0.8153463218268018,0.3989673626224858,0.7546032520301684,0.6199795356628534,0.5058349491160454,0.577769145151054,0.8449524313096624,0.8459625382060322,0.716458804799346,0.08153150113107488,0.5367507979109991,0.08790361507342537,0.3238009328548136];
	    let r : f64 = -0.08953573839345985;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_4() {
	let x = vec![0.7845113305855851,0.9284001326535123,0.9972791734612609,0.20265802095839092,0.21789045301935317,0.3290143137461886,0.023290488455248615,0.6501092581210136,0.02657212550020427,0.00225789808110477,0.8644762218298762,0.6277285989205056,0.22316864277419168,0.07059155780915982,0.25698475417932487,0.7915298754620497,0.7690945000661318,0.009479218364446762,0.5332650479733915,0.30054455952697556,0.06645371262877864,0.544353839870784,0.8636267229052025,0.8717004893951986,0.05884160915754333,0.41028207972659936,0.15622779577441392,0.21624301015297842,0.6238812703430214,0.514224938221433,0.6585049565864624,0.29590564158879573,0.3939191361388822,0.7569476731739619,0.044816811493037956,0.7327130201893867,0.020851335723577336,0.13197542294866627,0.9817358096324765,0.7104250305444614,0.9935600372700061,0.41940364934661656,0.18814894136152271,0.663370594315982,0.3754090552871624,0.5033627775715506,0.283741190215429,0.316221040002583,0.9651771630625708,0.315128205775254,0.23111843176195013,0.5048985769963056,0.6346304569767368,0.8764812723673128,0.48756259596345863,0.5520053108945754,0.755581467957357,0.1287242831660037,0.8436036375106288,0.04727395832856185,0.1866452846987421,0.6614829645888469,0.5611272137593001,0.7387489043623179,0.006198386352864627,0.46996081414329294,0.9622006950302131,0.6791146938070979,0.48496455125614757,0.8734792251029972,0.1828403342394398,0.8993523049524672,0.36491919773760306,0.3546846119291871,0.03488372433796838,0.7443977814331826,0.5401934877744288,0.43249178255579923,0.9788192368851948,0.25863352895791936,0.26924808979066717,0.049781198651856706,0.49350669390494206,0.4851691359356808,0.4876202650368754,0.23102676879550277,0.709150403715309,0.7657355798974443,0.21796385975830213,0.0019620246775328143,0.6614981726279814,0.8813277803416333,0.8828634519256704,0.2355298075304033,0.6971683062481174,0.459839042674435,0.7216400009515084,0.10726248106614611,0.011485831099090849,0.8065660593177183,0.36103244253888356,0.8735341285641579,0.011477973538431163,0.40306285289505983,0.07743501549064813,0.1339029859953037,0.6229280760069104,0.5694705021393883,0.15115485285875574,0.3988626464334486,0.7414215972869427,0.2704616078709632,0.7451381199041337,0.5687233458690916,0.896432447830367,0.23233718413092908,0.19179027298117102,0.016730100087538613,0.846728739678333,0.9743598379738923,0.6554976229564085,0.6028494770078064,0.4576878093830322,0.9051259590060013,0.1976119901353045,0.42550550406092913,0.4795917726155021,0.7248885497924653,0.4378850373677362,0.2765359328609681,0.679076422941956,0.4197589751777252,0.42590510912181045,0.08054935875965974,0.899370346212644,0.11205890436292287,0.2861169848199461,0.8909779726949878,0.5513851351203786,0.6342654393589414,0.8918952967068825,0.7671760023190242,0.3294915847330102,0.44932046897462374,0.7204867211913292,0.3108364381962142,0.5304698465064744,0.08159483356951547,0.2952741553867243,0.02157027334786976,0.7048204540662998,0.7683323046012942,0.27134730979147204,0.31781500585053835,0.3603327488710255,0.1006169699498144,0.7177564034506229,0.7391453160041087,0.5626533534855014,0.16601977525535272,0.6719895818925887,0.3731311227269606,0.4468195991926527,0.9830378901110672,0.6748117628479973,0.04453313781020696,0.5204656680461044,0.49066156315927145,0.18199286433716488,0.3123191885264611,0.6391589648133195,0.18558158834653893,0.0009047301395240792,0.853288765130742,0.5442261058836456,0.25858336492671496,0.5970642439570392,0.8594486133082636,0.49607332872382603,0.8088964553684199,0.4905106313573405,0.08431449434807203,0.259632738939894,0.5546934988117151,0.17897062605953706,0.3145968694220509,0.5661079297470797,0.08714968230709574,0.6796656003865672,0.15754706479782554,0.25757508134735874,0.2613822333864083,0.8394427300281879,0.41497247137731874,0.26059437961597676,0.521804135828565,0.978838264352819,0.49857463907500876,0.5733196814611214,0.682781990605068];
	    let y = vec![0.6682449104540085,0.7862208001156962,0.8375569713672554,0.7717025988601098,0.5565063498472049,0.9414298815938248,0.17874416986038943,0.6712917991765445,0.13319543889404428,0.5817045079797758,0.08183933162699342,0.6658888225980929,0.27133205692394624,0.6260111106170071,0.4622954726573427,0.6158805759547394,0.9299205530935609,0.432944784897237,0.04870472580643792,0.8048293423310209,0.7372254929194333,0.9035052202698547,0.28116497171863364,0.10104699680325868,0.35718573140209486,0.2724986588947277,0.9525503490138262,0.21145044647896194,0.24768953227321955,0.3043810518663168,0.6191374563155931,0.652260122246566,0.5247624372659919,0.7600484905526962,0.11106617092454873,0.0020480227382394522,0.37768188012903803,0.901282626018001,0.4506383933280731,0.5487274651595772,0.512873687813297,0.49187104619233846,0.13605992011273627,0.0330279601896768,0.8397917990639905,0.6887614709011067,0.41259342189530324,0.10337777788217273,0.2451369779567213,0.25854603346580296,0.5211509400668655,0.8570806480946555,0.8359369198340921,0.4538250460879262,0.9976170495439812,0.9759147497953403,0.4812781198534779,0.9817674118665884,0.8706291489333813,0.1508991450360211,0.8945144447488268,0.08274185151830504,0.15459275747291135,0.8737525797901708,0.9527091133837228,0.6901659563004305,0.8297785055854747,0.321457514472555,0.3180958880715612,0.46050792503118054,0.26780551912198947,0.09018209603891758,0.43116762045621526,0.9409096411082298,0.1290465393778336,0.05290454362077002,0.9750186229262489,0.3903884003655863,0.6015095197777319,0.7026276400175309,0.6867899703578613,0.25287967510934084,0.7302016952272598,0.8933939943421202,0.4418955947562966,0.5918298615203031,0.3222401347353605,0.5384697556984634,0.2870901270723547,0.9235113020272263,0.34967073097602897,0.01390331752643259,0.3564050098776377,0.911473050893565,0.20271872748896802,0.21019595702263838,0.21567922071615608,0.16747901823604605,0.8916537005028905,0.1701082033941732,0.8297488986864986,0.2521840699992536,0.9865402700710575,0.9910084173142734,0.6659817375755326,0.18193539746837706,0.9997042213079949,0.18156926700569886,0.7232685671584155,0.3957504859555119,0.23924122621553712,0.9219080310148343,0.37100438392417046,0.3331136221309474,0.9860489559656391,0.18448712531480382,0.18240778238716981,0.5577855664225561,0.8155098940890573,0.8002575719820254,0.8410793704079588,0.8966593863439793,0.13789082082418613,0.2739918739958562,0.07780853174982294,0.09869762503012136,0.7618004576057978,0.6217397387022384,0.8611963406251594,0.9214572290796292,0.46251497219272786,0.71482752440849,0.9044887563076878,0.21558659333423125,0.7223614303152436,0.039822537255540524,0.6795843612004243,0.5107510290345267,0.5052707086871958,0.04618068123071095,0.14256374384904758,0.6381177905617643,0.5195953331883876,0.85051302273216,0.38351192079414675,0.12192056257481587,0.4149531972593713,0.8304713298117229,0.4722299947946387,0.26869018434420044,0.2193170276099039,0.6613279426201368,0.19948807927017187,0.9865950603239858,0.15743391949985397,0.072199764705977,0.19483807463454028,0.7220699098971224,0.21760860977424368,0.35194849421320096,0.8074827844267577,0.6904614868089343,0.6114275540767725,0.14502176000558287,0.15279169362310374,0.809994608878345,0.5266013050073112,0.6613730530481844,0.8283986421428365,0.03425949706328735,0.8030521833314853,0.021542817115808632,0.5334567097401018,0.3304451509134497,0.06908746332816451,0.31103758021938777,0.6143002928160245,0.9006794237407952,0.030243512001181472,0.11133193492502647,0.8597596057753668,0.7386778900023357,0.3369797066863187,0.5630054959219885,0.08919715108485071,0.18198794154562326,0.732010489701152,0.12009188001386839,0.7693024397023733,0.33768433341157866,0.15807890195818297,0.07157327408039593,0.908878903522405,0.701059656960731,0.08979418829795904,0.7602452214154602,0.8335471366226528,0.5318159052267923,0.8413605264172778,0.6284474291713738];
	    let r : f64 = 0.019110477761944054;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_5() {
	let x = vec![0.20608735750194973,0.3302523445973944,0.6504419631588216,0.5574861427897487,0.4084116941479192,0.9268552780435125,0.017161221474460087,0.7014143802582593,0.36044538556066275,0.44766338771379277,0.41371007839676277,0.4254294117874936,0.6215397042588525,0.44059560501595085,0.9470848733118467,0.6351185211986001,0.4956005729296349,0.9192254145848822,0.5232851388205629,0.8368964152304696,0.976013141605226,0.4840756937822598,0.7652901529532106,0.8474557640278655,0.6835422644921751,0.08743514477452308,0.2939001025445569,0.6719829644653389,0.9558882887765657,0.9816194414356707,0.4852761383901285,0.3916193977252215,0.8277482453409112,0.6857530762445915,0.4261490476816958,0.4618034327465701,0.7483553001531434,0.27848290878830073,0.07954463225843345,0.5736205133545887,0.23596847425937018,0.238489682983118,0.5554593979544385,0.26391668756447684,0.3024735524210892,0.17179078004941095,0.7543038516324692,0.933189583863299,0.616455237208311,0.6789867187226218,0.03280133857571854,0.9713359428249808,0.3699728654752946,0.4343773561555375,0.6659913927785441,0.910856023627764,0.016632378820875315,0.7196027019486491,0.25318929381378663,0.12966457297058398,0.1344496409349344,0.735693855171713,0.2791497655654869,0.6397668986320564,0.8813746335260293,0.5226086422767673,0.9470445270079025,0.620711314632375,0.23916641950842432,0.672342042172675,0.7480357632621065,0.4731848669476524,0.7171965528715782,0.838048715310224,0.21626391021430702,0.04746785200686354,0.1616644015020301,0.7230895883243914,0.709402065008593,0.23158954955763267,0.1545155989449284,0.8306410446251775,0.8063575195464459,0.9231182879060942,0.5933405620578294,0.394064955877378,0.37142772225859566,0.656833154847325,0.8814848398573462,0.8348258146769979,0.06689204488538725,0.5395321656353269,0.9210220389618935,0.6929212808227665,0.553547432196342,0.13039271056930601,0.04081492364773487,0.10445377031737169,0.13976397184473743,0.7442308314594125,0.363851370328631,0.34236271292686715,0.008110888957311269,0.625868023280152,0.9797347065313806,0.9145411472288313,0.5617197035222002,0.08516899033263359,0.43032809874678757,0.028070202780427156,0.22682166651533164,0.8876547120173934,0.45767710193174416,0.01210301355643395,0.9826654746300861,0.07223238879704841,0.1257449632863059,0.7806471027097935,0.9968860885079234,0.2893538481840957,0.8355971462297155,0.20638148866135952,0.5333215851296522,0.6153211547834426,0.16673577763099223,0.8202389495692449,0.4787196152932649,0.23071285589521007,0.9262297010317494,0.680743073148095,0.2815275291232969,0.6458005628409594,0.09334326161199324,0.5866654051594433,0.09549572089074587,0.21977999158187467,0.83231259315328,0.024652699977234627,0.3285241481024527,0.029487886638221106,0.24276646601075014,0.6704389537551944,0.4004911884947796,0.4623617131208876,0.32020604491774396,0.4537865549485587,0.6606155194929688,0.5275330094785986,0.5965271830869199,0.5934404282432774,0.06362919516632537,0.9534017688216538,0.6945508819369616,0.4601655664140233,0.6999715954157686,0.8743585644261287,0.024754911316462125,0.7639585946349057,0.06544236046542184,0.9883643338348624,0.7235768608722575,0.3698338149218767,0.34245674940715465,0.664426445901531,0.31773991061992957,0.1704012656185705,0.25810804338190885,0.8381880434141019,0.8543001183383163,0.9876438092967197,0.13651070549171618,0.751687503160726,0.34224683793263855,0.7581167374743875,0.7674583322325035,0.16890416968727284,0.3379728017939643,0.8602109813812031,0.4881219150268058,0.4491435745702962,0.3396376396074592,0.5969353372073134,0.35596879931247627,0.46124724929932837,0.6261674459126186,0.3217277819319636,0.31830923945102585,0.5904583585936821,0.1996720470807566,0.05656301909439232,0.6285568918591999,0.15097434566654333,0.17458028865834796,0.005813608716045415,0.016019957625664105,0.9743933247238904,0.08279540415657793,0.6572705554488266,0.4587668204931794,0.6564770821294256];
	    let y = vec![0.4835206473562529,0.03224595764726368,0.49938545089918607,0.6178444154503251,0.15153684126507383,0.19259407873973822,0.47122679772160325,0.4480809934185932,0.08469491935807738,0.760293921142167,0.035991649274785154,0.14713618820415342,0.32183668561328294,0.6867544422935619,0.5815947238682938,0.9023017109703856,0.7838436795315801,0.21342113681040986,0.6078948540811535,0.24420794282561775,0.823043989630913,0.406794039785073,0.6981516941197176,0.46793937186878676,0.11947342797430449,0.40828244056286134,0.8221267003321979,0.5257982244753032,0.4090712543135103,0.9404490064910346,0.7122276412503594,0.4612613236679183,0.771821737130745,0.9419100702308306,0.2581696962613341,0.3355725708236683,0.7576397633936264,0.3667048500546569,0.5610839968138898,0.7096700844174267,0.09516255617944702,0.5921803945080774,0.7814287392719049,0.6233334807926182,0.865675127821548,0.566743923933327,0.2791787534730725,0.8699520007571488,0.06300610492247039,0.8270971801042903,0.4563073960981604,0.7681741444202079,0.40008385004049274,0.8584875952911063,0.47473449365560616,0.05306318699475743,0.4948622212635434,0.6581304821917697,0.777795439614257,0.04778059338581231,0.8961995996596624,0.30438271416438745,0.4172692078798733,0.9074267078160445,0.02533628756723838,0.8465248166582121,0.43049334865510447,0.5060612253405541,0.36632805679913716,0.9749086425313502,0.9157160357822359,0.9866853458217683,0.9106300637068766,0.16989626459880103,0.5243461000114544,0.923848360473508,0.2732159992521549,0.7488049188744107,0.5067554542303823,0.3898105884251205,0.660208948534861,0.5127482951616178,0.32558755918356075,0.39342824100595997,0.11918561541396666,0.04347626537175775,0.5854910650992381,0.5778424924076436,0.7034177828580773,0.18870891942910073,0.6259308627051922,0.2054607506380931,0.8814380487351218,0.29245184997496,0.43850164335576525,0.8375766057112065,0.49491581994836276,0.5114720947320949,0.592383629349893,0.5124816199555869,0.6606733344940964,0.8918132175356418,0.7034772968695941,0.5027831662524325,0.2526286162781738,0.11375740254326672,0.11469514230310918,0.9351931288467604,0.026667555572917223,0.4715520317451465,0.6358435436147634,0.8265569755344491,0.9381819711529518,0.0741403369751672,0.8775832468234015,0.48654952181790756,0.673767468828583,0.13155335253358003,0.8508084849063161,0.32495101859514974,0.11177227609029972,0.7948140878981612,0.07048613590850239,0.9929934516078289,0.8800911730886106,0.187367087447862,0.07782867909779123,0.9027840869670545,0.7910799668814635,0.4982460067225183,0.20340554202294592,0.6314003580067081,0.4384471948738212,0.7411447909217946,0.7100829762253992,0.08174871841153764,0.5063479457547331,0.12408933167384995,0.5229891371739371,0.8244735917660424,0.8398400485559333,0.9012373711960702,0.25411961686744644,0.4085448006541693,0.7482437919177275,0.8491238110869559,0.10473397584717115,0.15328040763517692,0.9439112947639414,0.772689381071244,0.8843140520001916,0.924637461076407,0.3308340204293251,0.037952018422594325,0.16729657916975216,0.3855362182960955,0.7683952527086556,0.26407171468976565,0.7181859729945508,0.3253427135108442,0.7427248663794583,0.8829265150700926,0.15766983393645206,0.7003129684884958,0.48727127509132284,0.9957108333675907,0.055811485586313214,0.35387512228000895,0.15221756869188063,0.008364888915330937,0.24811578494538422,0.023843677137831643,0.8345924887671835,0.9215742963001189,0.6052625134131774,0.19641807021366597,0.7612417408104721,0.12914475909686185,0.8638799759785695,0.258670860634689,0.5682058814491769,0.269785674373229,0.1908510482131509,0.32434827386524956,0.4858642216777469,0.8110482612707094,0.560939135627262,0.03770025964549428,0.5513759865216886,0.9641092056412213,0.54893487733471,0.9267056878084371,0.018794605295238576,0.8588656966841873,0.458099739983321,0.6886883123414406,0.1874317014791449,0.681349730427867,0.4891325539291347,0.8270736501981839];
	    let r : f64 = -0.061224030600765034;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_6() {
	let x = vec![0.3740536847603696,0.530019216934536,0.4925685752224419,0.13552315272686166,0.5640180247371465,0.23470855649417832,0.4819915888012132,0.8764666913057217,0.2712236959724189,0.1961293735610249,0.6769740438012409,0.012948044371705603,0.02500238851741332,0.2180704045743096,0.38575514958179447,0.04700214032495098,0.8835814001730645,0.5806738820738715,0.847153675229867,0.24367317238859088,0.09507993103885615,0.8056875249247738,0.0642090837117425,0.02165010878507656,0.27913131671224145,0.5430080415473446,0.5750830417600943,0.6203064855829074,0.9799552766305157,0.007620672715597077,0.8118343421830446,0.7975712403610442,0.5865412241883201,0.8435665120526403,0.7258632505151079,0.16047369794707078,0.231092527094087,0.8599724204320587,0.5379608115817104,0.5922179826164814,0.0734146171505149,0.5156685049893309,0.790141939109094,0.12798277836796634,0.24281433340310343,0.2593575997183194,0.9224909060570258,0.46862868516014833,0.6153159498776067,0.6678238971163232,0.4432437423943951,0.030208251532792718,0.4543689073914319,0.2286758177560554,0.08557708487689308,0.7361432961859979,0.3374992666684776,0.21578726912507296,0.8604594419251942,0.2382321875217741,0.049543702788716115,0.3975547734644601,0.8886794704691154,0.987446159633877,0.5235366089574748,0.28802756304982313,0.01319793301372607,0.4941097958534708,0.8640451547381569,0.9695479842879566,0.8751394972411355,0.45162219867104014,0.902610613582509,0.7776256056003016,0.4077032599800482,0.12561180532034344,0.6014537626928063,0.2197176118675752,0.3662165817265083,0.6193026328286886,0.3771881601439355,0.33520519037983165,0.06963147185942797,0.4852064871571563,0.30996966412267557,0.35723025732462055,0.5594885031069144,0.8147617313774499,0.08560505360038073,0.6733376563063117,0.030066957718193454,0.2528041996317135,0.934603714419752,0.2565377401179879,0.338929956385983,0.7880517073166355,0.2495598018760924,0.12514762858425932,0.8035807891590007,0.4362374871353898,0.15795242198228,0.8711270199248183,0.6682364650975019,0.328707262503109,0.5191203892640149,0.1363834146820786,0.0942411294983051,0.9465168760020186,0.006932553852437184,0.47862200903784846,0.7873400834327151,0.15463713189057682,0.8591632954657971,0.6520264218814017,0.011242964014603785,0.5809012985345111,0.9995323756877189,0.5026629136737013,0.6388722621734315,0.5678304192913297,0.1409675297073657,0.1396279488364105,0.35215443900231047,0.8408270304388098,0.7961855385289097,0.41171256343268015,0.5432895622708078,0.5010686479762558,0.4383120302359883,0.35154062652016427,0.33213992190847175,0.634222453738107,0.34589783605222824,0.2818887353444799,0.5073826439985195,0.10800529667459624,0.19002228162427404,0.17057665918513498,0.660572773086234,0.13856145627926253,0.39919686826020484,0.41433532031127873,0.31616474408571515,0.1309129431954993,0.7349064897872299,0.22788316127516828,0.17456807222288595,0.877024896644001,0.1859901872071842,0.02512357149229283,0.7263620443429725,0.7362963254939073,0.5081576122159324,0.15080689337643427,0.6324344119712848,0.631924364435044,0.3151349369148694,0.20482348580815724,0.9655269809558604,0.5728946362774504,0.8640713056353982,0.8612933949975481,0.06042790918829499,0.47767466974224915,0.10335353944524839,0.7725421781514991,0.8746745495112688,0.03888387047614572,0.23642421651604595,0.9811754970646839,0.008874441246649156,0.796340266290344,0.14730383791080326,0.2692355567636906,0.09245841232349838,0.06881978127260235,0.6542267223516147,0.09821545207238491,0.18494865328609444,0.4203744827186301,0.9980911158125981,0.769800130263728,0.13563192027869797,0.05197752064156347,0.1679379887448611,0.1226123173244712,0.11874635983541537,0.38630078603644835,0.8956539054378521,0.33270018621228703,0.537713967331484,0.7769482801172742,0.4264420427421237,0.4077853286106141,0.81759765478119,0.9056800877777211,0.911092202039668,0.5629051738515038,0.7035865711426115,0.4233261666202608];
	    let y = vec![0.7741160925261703,0.789027557785502,0.9478510169511125,0.4586985948332718,0.35861373778101957,0.2832845630440691,0.06672307427821345,0.772427869885664,0.36811906908184266,0.5171039764692792,0.06500134953824566,0.7021201950713258,0.7800915860944105,0.3664341963766964,0.8929351340604366,0.7569118402890889,0.11350435634940237,0.10562012256999576,0.7216492872265354,0.553571342280954,0.3833148110900535,0.1280650114471421,0.686135790743555,0.44137667874872955,0.3407149244148747,0.6986948197177277,0.06122588896164893,0.18141723310899727,0.8157852259093823,0.45466038552234167,0.5832093635824418,0.5070172214030315,0.315896042625892,0.11708325543163955,0.5868207363538699,0.3709815928453303,0.8690072986676767,0.7245138500972692,0.13596034952484437,0.9092001294695435,0.7569636785921036,0.9448731580800217,0.7897648071790528,0.2764203771732471,0.020872476144266128,0.5985726004079138,0.7797791125532643,0.7295182171970049,0.39437089752767684,0.18089701824121518,0.059681582555972,0.10091373523763703,0.3700063344469926,0.44944405282063715,0.19092694139782407,0.6677829331335268,0.3504146832661925,0.3325162208923541,0.4009991184505426,0.6428807689229806,0.14728164124237086,0.32539462522136164,0.2494728279623697,0.28250346296360784,0.11990341092254897,0.49927587551923325,0.5746580719238661,0.4255628397005501,0.34369271935874923,0.6832718845462086,0.8679152054371996,0.022806140990983992,0.919078806334216,0.6340749973647215,0.18807696322575684,0.7615416484933416,0.77372464352864,0.3214819088625851,0.7820917894521042,0.8998598251362855,0.8917721817103823,0.9172415740430865,0.4297633851565179,0.7009492651701781,0.3154531305049698,0.5944307390632089,0.24535606954183553,0.11229505329067935,0.23951014548235583,0.25087702623826824,0.15648348338189322,0.21120514761946474,0.9718011113585124,0.6555214609722458,0.029187942177030246,0.04494671175310028,0.6304439806535882,0.12684042424950115,0.7040523101540718,0.13831655019211575,0.8070323182117872,0.14347819016629193,0.09058439306075261,0.7290199292309866,0.15102466765654665,0.7314637574902684,0.3371467171261311,0.5472376408500221,0.5934713721728525,0.34676609749886766,0.32030466583779205,0.454019313479221,0.7253617414051183,0.25841779643075846,0.188437993833097,0.9741564971857319,0.5607317413700819,0.18020627348051843,0.28592340445962416,0.9623110127351824,0.33943755497021577,0.13119036669024386,0.7944671248003866,0.1754098536581532,0.5747611862868617,0.7178614359904699,0.6042863563005387,0.3587589473574312,0.30606899981663627,0.7903476531282413,0.632543859154751,0.22417879271855723,0.032209726412791184,0.7183598805106166,0.5377641490640398,0.06112356757235493,0.15079742314244426,0.05300956185641481,0.18846886389641682,0.3953662030734306,0.5030201420735906,0.6493353697620898,0.5907630515559704,0.6926941051414862,0.7901961833049599,0.042909961413853503,0.7708314011070891,0.28691347371626663,0.4112646987016597,0.8636303011265345,0.43040348330889056,0.8812563408489722,0.45560776012441884,0.8975830179412455,0.5450298431504289,0.9147344105261058,0.19456419354833687,0.9009956600237683,0.4300152108646049,0.3746730233381551,0.04514218789908797,0.9354530677318854,0.3116809552465316,0.137652297235747,0.2745260148155032,0.3993612050040324,0.8383937186531263,0.1923073758569045,0.4618791148840551,0.15711057710431564,0.32438432024001196,0.8462947043677228,0.45803395895078347,0.7997135796833267,0.2326281874152767,0.26587435587486286,0.1547309195665354,0.3275486108364737,0.986610897584898,0.9317493000786088,0.9022462512907526,0.5191248705358136,0.34310140705083414,0.4225068027319808,0.6791988922144747,0.3632075305310618,0.6472415532051247,0.8408318345697154,0.7276604324743259,0.33274709559366555,0.3497196333945204,0.1829868779090903,0.21461080358310303,0.7205947197788127,0.26141355883262063,0.46319243566589463,0.4548621295729566,0.9091208076448272,0.3249756434254254,0.9312872220075209];
	    let r : f64 = 0.06376659416485413;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_7() {
	let x = vec![0.6072274460665774,0.7518505910798833,0.16146026438914995,0.941290393305416,0.38261431751958996,0.05842026371280573,0.00025928503952277193,0.06559188159894491,0.9878985747062203,0.7282160429962145,0.9952405833442391,0.46765646863134935,0.6153994130965227,0.3440624454883848,0.45105863585438233,0.09536203971771606,0.3808831361877919,0.5844296894729137,0.21668339773706002,0.6293210537114807,0.3766972302660839,0.48984289467957,0.5216687827878573,0.3850813690145619,0.16813185995610402,0.4944068593228489,0.5974537904515922,0.9597280272300115,0.5962609892906988,0.8949900864420091,0.9569238641457748,0.5938203815196756,0.8915109207089845,0.7188433136749866,0.7569118447635316,0.21949362847643317,0.8435094340272057,0.2808784019816757,0.14574816292656922,0.6149092046502209,0.5231742321518285,0.027201173159373537,0.21430622906443686,0.6216379891835694,0.11761593487167143,0.2123101350058365,0.11546411122336286,0.40288693174901824,0.3988841085855759,0.721385191355592,0.29613472472375413,0.10152002721336895,0.5345180722426047,0.2128990027616492,0.7310050347405411,0.3711279308743325,0.749583077119871,0.6364310165155198,0.0031028314202212748,0.6724703824106272,0.09423379211033533,0.41178661086337676,0.027830098450933316,0.6896544177853337,0.4660079547716829,0.2021927205250621,0.08240237099195213,0.03398143712601387,0.388393888925893,0.7880908698408634,0.17524615932784737,0.7926531148288938,0.36420180332021634,0.7405965005172235,0.42630782485684404,0.07476918930376653,0.7316489199496187,0.8165964017412268,0.4929898246866833,0.9249615016519371,0.8464223400596138,0.43950098374857416,0.9547594207243454,0.4860814505266551,0.527682990365097,0.7004700392096276,0.7046750099000567,0.2866434581089926,0.7475179952020222,0.8241141440762315,0.11561902126614487,0.40296562152396354,0.7945760652063708,0.4330732558126973,0.2512462000817334,0.6284995461686452,0.862699621416207,0.46612390232699785,0.9330444026474164,0.6767801437588767,0.040881006840258194,0.1799960124310851,0.856869624778574,0.9660494990035928,0.9813630681309464,0.5980263800536888,0.020679257113782046,0.7111284951710503,0.8001647779688915,0.033699564361418854,0.8628417571864158,0.04267522172139626,0.7215653439712579,0.8917366336703306,0.851081662085807,0.7980195429954202,0.38358906435828555,0.7511673559866981,0.5632802956843719,0.005493152863125017,0.6410400371171183,0.8053090208410686,0.904181983118218,0.7064666323266473,0.22298022283950258,0.741048601787424,0.09042350689601242,0.9043111221191095,0.5977482730753719,0.1681894506877165,0.3193829272506027,0.1460288772711571,0.09506063335258563,0.24671203423939903,0.810482752855599,0.36426508191943785,0.6467541715252243,0.24455915737266198,0.7692222642152138,0.7156797024997688,0.4313491123315093,0.8004414122581491,0.12830770955994453,0.947202507847526,0.1608204598730858,0.9314480699240755,0.6432821263272279,0.19027013924967318,0.8375287533993924,0.8899820199795639,0.9759774385593187,0.03352265876200855,0.19816902934218505,0.1563524594658562,0.09868923077378278,0.47775332936335324,0.6607792681393275,0.6172878248441594,0.9687225519468307,0.5437700621076228,0.5521540589901837,0.21673819043443676,0.9056132920519934,0.39983485177239275,0.9933774557539196,0.9656278875235889,0.6965105547355387,0.6950801996625368,0.35567808322654415,0.9012834393238134,0.7031502948926989,0.3548725226427909,0.2043318007782886,0.13187049886400992,0.5642706501819911,0.283791031237681,0.36168028972266875,0.6693798084792073,0.21159852817445413,0.023492611926802298,0.6819000957898783,0.6844080025865997,0.10020570448705113,0.6483765811648295,0.607569372174955,0.7617121680438176,0.007350369420161873,0.16392917401252471,0.6144516252413967,0.7208383789232076,0.5843497416911234,0.673360514176182,0.0348751431748201,0.4966528630739405,0.2867351218404509,0.9289282496722248,0.2882069115490171,0.10202979084227293,0.16933681837781156,0.5574782266841007];
	    let y = vec![0.6975478544322834,0.8107288412510989,0.8387793355779711,0.4161889533141111,0.054439737635536,0.8058047424059862,0.09913531631048189,0.11073074896534263,0.6565357056875202,0.8552074696578594,0.6246408817174273,0.7934388837576547,0.2912140800112374,0.48557730586122005,0.8721682414623573,0.5871860538693647,0.8189450815351627,0.8466472240096524,0.6765059706563319,0.9440330150964765,0.9146120525875996,0.09114499973222479,0.29856504555488583,0.09382955708194962,0.945879982104491,0.1760321902351194,0.3637439172314957,0.9467786301314263,0.6580569148980892,0.05687446298011267,0.5718066926615032,0.9388251685202738,0.7896078132496843,0.06149513197952805,0.40284366722133513,0.4860641949957908,0.5830808798752545,0.8248094899511935,0.1686058314157476,0.17998750052750556,0.6596649581485666,0.7680472724243605,0.4469443242740575,0.6238278691751961,0.10562859777150246,0.357629726368607,0.8438800853180636,0.24164472707628926,0.45144986782473107,0.6265975925619096,0.34735756802350926,0.8233845900065715,0.6500784509553936,0.8016964684727577,0.05784986760381128,0.6394725862352468,0.12539713985716272,0.6577015431971216,0.02539862287910677,0.4862803345840322,0.7098207313408106,0.6733299645615354,0.6581173216368026,0.5578063404788215,0.10627839125621441,0.6256230879323574,0.7450859277045494,0.4933451913887805,0.46383998447360864,0.7835446573179925,0.6727049041986324,0.06309208790538168,0.6491453036366146,0.7909010203495089,0.03088953159857155,0.7725765037720601,0.5379517337071467,0.7819605293770899,0.42638418583055393,0.4484795873111409,0.03681881732746284,0.9631907230324578,0.2744681093267297,0.15477972732115952,0.8225620237722991,0.8197173075713616,0.13591975983119786,0.28656290752683733,0.38231399360096396,0.37538035055231034,0.7292444888586496,0.5339612594617744,0.036684058064943126,0.40899713152636186,0.8290002783992619,0.04595311586470774,0.04400132909363086,0.8540625126103527,0.47259022893754676,0.9250810557375003,0.21562650946508533,0.5043318679016159,0.5359550245724749,0.7651381038110109,0.9231101174061241,0.8946761695890577,0.22837807866043303,0.6366537648204729,0.7046673289530523,0.1795584852261769,0.2781845782111194,0.20441913443379456,0.5284030353693375,0.632973659101066,0.8236312031062981,0.4186967806755285,0.739886339285959,0.2215918949522423,0.20999505389361295,0.16386410420324093,0.6272270988028622,0.5567667539323691,0.12924164350113676,0.6636823397202154,0.48552280866609154,0.36643485708867063,0.27189023329043893,0.06246139067112966,0.927308315986504,0.019255659610790343,0.1479006591172478,0.805038829128289,0.029153750251309285,0.4533384687107176,0.5087064870694624,0.5535669131381076,0.9950292438089767,0.8984076771737239,0.6646204066034053,0.4607147634366855,0.7492701660481785,0.17134233392320342,0.6443639347816267,0.04327704839570379,0.400720155469634,0.6817834335193265,0.7116441697157098,0.10082240111205376,0.3529540929865378,0.789770184953171,0.31343201882721416,0.12403827931057299,0.3084806872240048,0.02942628583782614,0.39040426105885595,0.3610700296897035,0.03181932962270695,0.8661091107010608,0.10865635397401319,0.048014748187996115,0.03249996150390533,0.7805837709166169,0.3386084908419714,0.5899786750828596,0.9446940211238813,0.29532145311664704,0.1796318106501239,0.42902911530567367,0.37146998300953027,0.05251364947634618,0.7924032841466467,0.6658546687194056,0.38784822748212633,0.5917605099843076,0.5404907758279841,0.8271928770841168,0.4699808236798777,0.0017247656619933105,0.5435638269794817,0.29444685820807415,0.7318658271841503,0.5185767888055828,0.40683534068014504,0.5465883738570508,0.8421322166396074,0.1379476603982227,0.19172018942228186,0.8925848003446705,0.6163941904341481,0.14044216563681777,0.5455761108883951,0.31103263938655257,0.1713501949994959,0.758533419562387,0.29945102337278673,0.7302586012259221,0.4966983709560774,0.0675591254889929,0.0905362913667963,0.10514145400365316];
	    let r : f64 = 0.031242781069526743;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_8() {
	let x = vec![0.8199007102836013,0.6476238994618773,0.4512740459760237,0.8783813958710206,0.9085098639232834,0.30780290848027314,0.7789021686083482,0.7456317125786047,0.969191109091444,0.25178700780491703,0.25551368072640845,0.7292828737956345,0.3696558678796221,0.19832366764339182,0.4134383855803818,0.21537540397232346,0.9502285672456648,0.59120822639646,0.7352551441170687,0.850036546273482,0.41900440501081593,0.8169602061576575,0.3544214839203641,0.65884438985663,0.3935573746955455,0.1453818808599031,0.3542192168961843,0.42092545497622513,0.44717193244480236,0.940815351334789,0.22426502771365853,0.9416995450829443,0.8266266198976084,0.8574667635996708,0.828876272827505,0.719675247938763,0.2818710639883144,0.1335351412925223,0.9872397565514157,0.6341635488777198,0.26978166249276636,0.8921032113098013,0.7685269125532012,0.019011022427331326,0.23644375201862822,0.8975038374155665,0.6812585481056883,0.9726833536512851,0.5010581707290462,0.24427436450601114,0.8766560257237243,0.08459593354314265,0.7969233325676582,0.44110274639507285,0.5655694058043143,0.15854259177166308,0.5337900009130359,0.8450711925781571,0.8197782436900395,0.7566556075411044,0.5400616129050599,0.2292155441611008,0.8422852229840557,0.550660051630383,0.22035228537624985,0.764440717010027,0.0025701272592673075,0.13829128297596716,0.14885712626451986,0.5560257288438749,0.36395602512501657,0.8315818175019392,0.7465688892866269,0.2780940026611731,0.365141608821279,0.9995558735614075,0.23898275898163146,0.31508741792481143,0.6720333677723614,0.8825665687813208,0.5019923616041398,0.46922802876180403,0.24456670041049,0.32339555032580325,0.25049238492454495,0.46370506197470307,0.11654333304674025,0.8644323912339205,0.4534618655346122,0.49245396617841597,0.9294527237657797,0.2317926789873711,0.11432818622940133,0.9634909040072219,0.6124932252305673,0.9793926135922275,0.7388124291879253,0.2824089168484373,0.22939370846784046,0.17752034441594555,0.02067495680088427,0.7681899754407168,0.5097022726957948,0.8801413429695872,0.10446841431485465,0.9374710166867196,0.08927653761882903,0.6240598550746961,0.1774659314921999,0.01838944781266627,0.8864939109023966,0.6504489208772258,0.509658040901749,0.9912228114495187,0.8058957350605914,0.02356943670206868,0.0055881879768920895,0.8996612127000922,0.6814812601789647,0.9149888308613738,0.9365968410382732,0.5984440774607762,0.8724985109688759,0.10850213488885574,0.6585682243877552,0.5856266884603162,0.9648024079471746,0.46844480770926256,0.12304098477242043,0.7589886283209263,0.1379096573932519,0.925568353877928,0.1520483176739833,0.09618700741953523,0.885759094905096,0.12121478702341792,0.18204759457515352,0.11841247982575087,0.14700359183303446,0.3341872126943961,0.7223848371933916,0.9333151179993234,0.222540686415322,0.3652466633870415,0.27391909540632897,0.1930571129930002,0.1852811213523774,0.5554009285843116,0.15671303261527159,0.24532864165628832,0.27427041101720795,0.2094238992416182,0.15118264980302631,0.4749811231291311,0.09968638464877688,0.49866116647064296,0.2471716286020994,0.32317577164655276,0.6034688921297653,0.7239916249588507,0.7412007570492115,0.14564715534000816,0.5906140557067656,0.5619898789268318,0.5190578134270797,0.14202403893247006,0.352329102320979,0.9499422489304665,0.9911675244837462,0.5276351999471524,0.10004301937540372,0.16091145228285264,0.1320915450297827,0.6420091173757073,0.18601204568174035,0.5578493348337076,0.1262185421632025,0.7467304409394444,0.8795940870687727,0.09363156708893217,0.06769316779098544,0.7411184373568533,0.8797997563818326,0.8420814682887606,0.49659855148341403,0.3947245349053503,0.18300111249194262,0.44991930839414396,0.12193364662306627,0.9516764270993273,0.9860620483434255,0.14811705789448049,0.7252124514718176,0.9030393313151105,0.08256079641101377,0.6551536393985344,0.07327410568010517,0.22321969813662357,0.8835319430794388,0.1252638319835273];
	    let y = vec![0.9255072060038424,0.9894026642367546,0.7058773996968661,0.034337226049451774,0.5538972275113137,0.7370367843238461,0.8503456029238795,0.4737055532182377,0.7163694926781288,0.7750907174457797,0.6917654978770399,0.44791331998459694,0.08593307162404307,0.8117026988202567,0.5347882675973449,0.854875970057104,0.5309299582745202,0.5150199284988608,0.18578220871089024,0.03068870833528159,0.5464620636708477,0.4573655792754311,0.09109486622227447,0.6178610574510479,0.03210223602582429,0.04220775025312473,0.5083305486633798,0.347773725526081,0.8564424139578706,0.49704373699531845,0.7398184956415659,0.5334163045772005,0.15103866894813034,0.5263547651805053,0.5854678406666686,0.4028994648073525,0.5891212237234238,0.04559949577053679,0.13874491601466588,0.5574811618320878,0.2706075471719046,0.9051989823836701,0.8260266264445514,0.06635349379450217,0.9533117373943247,0.3691113204876265,0.272315934579048,0.1874493005840795,0.8251433776460833,0.4867667285531351,0.8990167593352856,0.6745982708882973,0.7840706808507908,0.1329192013707844,0.21038416002007332,0.5753081006000546,0.617104026368611,0.11037910577096022,0.0713726665374177,0.5301750027993575,0.8608598891188202,0.6653078857095711,0.4779465449966339,0.10418403635046147,0.16349319406404372,0.016012482053820443,0.24828115776804183,0.37970351827869486,0.40021881961071637,0.15416409801087116,0.8756706255738789,0.42376131975584475,0.12061392333898202,0.1996006730837484,0.039560338670019846,0.09035019340449735,0.9906772412076844,0.15628790516335433,0.039360091056611424,0.219594955667623,0.23111508462511265,0.4827586741904548,0.6414161357751934,0.6826634092966644,0.20307954950539642,0.8610017384550043,0.9468562333583703,0.8627350345390521,0.39175652528066507,0.2697403069752483,0.3533320029493128,0.17032858438649978,0.017860943930151363,0.48948391164193705,0.05412318879743849,0.7242757930856889,0.9863489399726316,0.5993938580683118,0.1905584063267295,0.04800904438654807,0.4485347309489762,0.25375127135912223,0.8573363962673536,0.6221969758729415,0.41462742762825733,0.3853385543371117,0.6114745397827084,0.3867862256694723,0.2193468749091878,0.9254451440287118,0.9044293998076369,0.8051938019503666,0.02178980625608573,0.6760393993524367,0.8495767742738604,0.09434919575102196,0.5702132510247883,0.35531020543998026,0.6162473601233166,0.5717524632761647,0.6008217228721605,0.35491257088956973,0.6020680285085473,0.8422557894108469,0.3743466110821231,0.9514048462374936,0.9313132412132523,0.8754562698042369,0.2763779281449621,0.13025969669586124,0.0020519893174979487,0.2201746455369583,0.24501042436685383,0.9811399345407193,0.8009265775100484,0.36554761409579195,0.41740981155725043,0.2700078301819747,0.19592987030734177,0.07284142395167603,0.4026618534044185,0.9050319128344215,0.2622728861988487,0.4346221161801218,0.03816483883874311,0.6031626304374277,0.7827159557454182,0.29782323507877007,0.6671050151095889,0.6243116345667633,0.8089723993684746,0.9129735858805554,0.5174854076321729,0.8721443953701286,0.22436006957055699,0.31954022799986537,0.6704846262461829,0.7009094399407639,0.7333566219157391,0.9021147035691264,0.3928367315112581,0.7957752666266795,0.8113511569039463,0.6061776094454575,0.7061818765247928,0.611473829190616,0.33442152721597374,0.7308091605039434,0.1723144769481798,0.6085903110370151,0.2585284143170724,0.8106524456993819,0.779277167926527,0.2677176396926514,0.09628420521084591,0.08728938505404804,0.17212588222941505,0.2098273633567015,0.8450568862089975,0.9350455244232091,0.9748653600962532,0.5871499613019839,0.3972492420011635,0.960413627012628,0.3602475292968744,0.023761792828813744,0.1327219704349778,0.8491579689088319,0.6040092424875991,0.5842073391456489,0.005829436185643577,0.8064323529030423,0.9202033833970157,0.07507791573788469,0.8149807232498152,0.13029173166628583,0.5852028444937079,0.7288519198704525,0.9359046257123443,0.29053205545867855];
	    let r : f64 = 0.0086867171679292;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_9() {
	let x = vec![0.6858127200342585,0.0009106284430507872,0.16662040330501515,0.8111061751218118,0.9920102815646946,0.14668528917323853,0.5928040356864116,0.906324197177845,0.04859516031609046,0.8938594196358827,0.8415483146942719,0.07265329117384811,0.994867930989418,0.2681024915419362,0.08730898928127762,0.9644334109563185,0.7290058600813446,0.03684986633421161,0.7915284898414208,0.019460379378395287,0.26382224089036344,0.3430228256772895,0.16118597751125763,0.06339423607830152,0.3957573618603537,0.26077670505696027,0.5225103431429708,0.40510706458756685,0.24820794730853424,0.3845891438354605,0.9031727245225896,0.0019632088380048263,0.7063648502953628,0.5772001674897302,0.675328042598312,0.7714866310225826,0.6259760170601069,0.3677086054088743,0.7445933481014134,0.40260945888049116,0.8299877864426068,0.4969451418534587,0.936057457029368,0.827092259612634,0.3701507971633752,0.9308073932778775,0.9245073664212334,0.3218211245083491,0.6757164064611855,0.9504402724152533,0.734309941940898,0.7738102429899847,0.32985645464969715,0.2835755119053093,0.5490900206384564,0.7406419136634124,0.4760072381269098,0.5234724479153909,0.9866538539331167,0.8405112157994166,0.5090994804483935,0.3502763137212075,0.0382393746274845,0.6155330330768548,0.2472997200685082,0.23062025366137084,0.4581449651072558,0.15855421493778699,0.6608576035210872,0.06327282984171967,0.5360820817020868,0.9161063268310443,0.8682452810519878,0.11089284301157376,0.7494173113555611,0.08696518884197424,0.12862778681604492,0.3874214483268763,0.7359579120067978,0.17969858228617452,0.43424498291349267,0.78234689036974,0.7596168767568112,0.7480729551605757,0.17670106430551502,0.2813479269027712,0.7912156095398865,0.052787637251381025,0.5692706558002492,0.5341821733083707,0.29833126262188014,0.4733081142282234,0.6545953579823521,0.15805445880831115,0.2842944220721676,0.6445853097048608,0.09782441163001943,0.9941136596719092,0.1575949663201628,0.6656210668170697,0.7198915364463051,0.5861010039824456,0.5101038656558943,0.4280711665113177,0.7599563221627543,0.2011857066588305,0.9904698338308575,0.23846559269988743,0.35430133382589024,0.6329864914345569,0.18285667186244026,0.1900799653293287,0.5269460126516644,0.08574550436316652,0.5390510642715877,0.17115399984569646,0.9047399923654759,0.5393499515732584,0.7265610163190604,0.32991380035959617,0.8231506923045377,0.5139674565759645,0.7289032320785509,0.1335430808766933,0.40055738623292936,0.24267186571436583,0.7597258616316415,0.3715756488950238,0.48817936746727675,0.5307173507921924,0.1731432959858703,0.9753819734793373,0.5252622453636755,0.25717500388273684,0.849268549315081,0.4370970167210184,0.9990021321372405,0.6766046642829642,0.19925197733535094,0.23433445933510155,0.26703447517530976,0.7344943270779287,0.07684588538458359,0.46632680179973784,0.04617864625649659,0.04177047353399721,0.24101601111458182,0.81456599779897,0.11215069006234157,0.6616529482174731,0.4098810600032229,0.24674518617585706,0.6914924867976974,0.8233893551358145,0.21421482240853718,0.03747325440927818,0.9511824337151821,0.6639893029016632,0.9565853249204183,0.51253029520841,0.4330596992416661,0.7690986056384638,0.2467362691663365,0.46774828156841064,0.6969694167426098,0.404287665736879,0.5173034811550958,0.7145629280844019,0.8632464526390441,0.20986197879779445,0.4982445172844562,0.5366723048693682,0.42350707734631854,0.6778009292099789,0.45469448964155124,0.5184684422165814,0.7415616232218945,0.48589721780045203,0.11896172872997135,0.14207616722825622,0.46380527353924195,0.19955630535917135,0.3867569196215439,0.9787529215291493,0.08800030054019625,0.8544023375743575,0.7970888928961918,0.01671152468783843,0.01576033313833647,0.0324405163128304,0.8755082089554281,0.590422076316513,0.6538003636265578,0.3324674897094977,0.8066715030889489,0.004703652015754067,0.9947081231762681,0.050148184479297364,0.3614301669641856,0.3519018869571996];
	    let y = vec![0.36616078847638744,0.9975586965531632,0.34640322344386254,0.49632805371998956,0.9404183941361715,0.7597491244272683,0.8213367479274892,0.21145669790996202,0.5642178848025502,0.5561446136934218,0.28998982433624354,0.5331843298783425,0.16645843020142959,0.2940518331155997,0.29801408799829765,0.4861990093010128,0.26033616659128034,0.20540571641927208,0.07461408719232787,0.9771920916533179,0.1700270042013221,0.9926117824278636,0.5416721700509629,0.3434593470235596,0.18577281569212156,0.24615409000940658,0.3442379799690771,0.09977365418151374,0.3357846269248794,0.5528795189079653,0.2031362302926566,0.9026850090587052,0.9399692591173446,0.6860201720273983,0.7385489237271596,0.7258676528794196,0.589357829017826,0.7630033636788033,0.7042340468567251,0.7554234392823382,0.07042702119569033,0.372982625379622,0.8060874628232846,0.12185946574325235,0.1258345703632333,0.3822318930423454,0.42363783039020475,0.6523007669749364,0.8376160088613428,0.11045805114954366,0.22997520714841135,0.20870851693282355,0.4821298964793934,0.30828213839633967,0.1814349468363935,0.8071572273671422,0.30079745737453434,0.8977744532272158,0.7856709460991436,0.30568108054347376,0.18224350383184273,0.6785424764686798,0.5387737103537706,0.08728973022224151,0.5457228013907899,0.8414455943508264,0.975192498951223,0.7845112606523865,0.7757583346575332,0.09410319007974688,0.6707075104355499,0.8613944904907317,0.9965686379148856,0.31840141286030843,0.9502322259194569,0.6535585079903751,0.6785592660499985,0.7652417197171586,0.1800095319202899,0.2585860341673102,0.11217274976930913,0.9994104453482499,0.6609174337932872,0.2716604333373268,0.050346684948234466,0.916444711237294,0.2174614828256345,0.26527278850402247,0.15423191426899852,0.9781327043360193,0.2616760503749693,0.25900081627935145,0.13378612371744503,0.396655814044786,0.21919936931673356,0.018735796589520848,0.8202070442237747,0.07785771803078367,0.32093279672606745,0.3823472187672886,0.20981650413375796,0.9506434972161518,0.6070184031236862,0.8573053383925837,0.47233674210532794,0.0762021376945714,0.8788071583475329,0.9650997615959164,0.6402388493608571,0.46363856561275907,0.2810872782381292,0.006221885609268396,0.8540002373149882,0.1408390802240913,0.7860107405784059,0.6584131742175152,0.08657998714436244,0.051104716662788485,0.32186782211414244,0.9592152377871932,0.5374621949685741,0.20329876305057093,0.6952009464594577,0.9407364429692238,0.3552590817979764,0.06843582984107777,0.9048545237068005,0.2094299431708424,0.9233468921938773,0.4515333031055635,0.773661254216534,0.45686770475695826,0.5720142317356727,0.3119471577669002,0.6751379718144365,0.7405424213032379,0.5444721598884958,0.004203636600343286,0.5068746346546422,0.30552403468267786,0.6476108629753174,0.13131103104853648,0.22816241236310764,0.5398287992607848,0.6150243968215102,0.10191800628164405,0.5638459835456752,0.8083791685935005,0.9553751779546705,0.24962324156965288,0.4681676092740743,0.34199713224132633,0.5684558779845057,0.1884969338847976,0.9327461970853774,0.93928914174256,0.3472979046795318,0.36641413887083896,0.7570357865877891,0.9585026731357544,0.4682609089799743,0.25206835446169407,0.4583554616271912,0.34303109435389767,0.8397222609735737,0.7165649746854896,0.5129242606947372,0.6532250327926858,0.5439088729112485,0.6720999306118269,0.5379784326818481,0.406143865097085,0.6970551651166589,0.742616749907671,0.4680198220942958,0.3275313928787461,0.6741221282828974,0.14388532411839883,0.2840192209328426,0.6360135755672003,0.1938850026867085,0.12819594467494821,0.6321998639237235,0.06011262488365565,0.6231175799671195,0.7153588414783378,0.6642423016366262,0.1490463698655421,0.24926674645236024,0.3416225642017069,0.9706363727170009,0.21368327417808353,0.24288854006073635,0.3724118533109049,0.6074798579103855,0.10214062599766605,0.5551692590197819,0.8535098148668734,0.13599328259337218,0.7487890093584278];
	    let r : f64 = 0.00189604740118503;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_10() {
	let x = vec![0.8413756892453704,0.19526691294157383,0.15875545738068797,0.7700842389638374,0.7302481089795327,0.13364698334121528,0.48702477989824255,0.25495898790833504,0.40243513194344005,0.3968562613723613,0.560042323936437,0.6299373710587145,0.033881571345210304,0.764841692774696,0.05184286732580334,0.21468697540796555,0.5201309304948369,0.10428346280217793,0.934107545959054,0.015579337094306145,0.4997695441557982,0.3680785606673397,0.43914803672926217,0.30006087697612627,0.5616790226220998,0.807892055123883,0.05749417274146551,0.014768991572051027,0.9842468281270179,0.7482083804320179,0.863582901704186,0.3562174906104554,0.7601348948935531,0.36688142862301465,0.11980146011362691,0.9613034216616847,0.4207902934458998,0.9998598082546575,0.2328627100907027,0.9700007303006667,0.6828243667882378,0.3297871482161038,0.8296657352906389,0.12490137983390781,0.12941105224987404,0.6670863822173496,0.7452395798003427,0.7291405012332369,0.8685533031835468,0.8638297053783945,0.5940691418348382,0.03768478805428144,0.8770118536906365,0.4068415665939227,0.3420544335909619,0.8306011110527632,0.10511002830917304,0.2751342045093714,0.2883603623816371,0.6499845995391033,0.239192634894129,0.2848336813363098,0.16242771783116372,0.7672616505523109,0.1127447981343116,0.5766710375730161,0.10154289419804885,0.07565453782756904,0.7460429240935176,0.5923829049942826,0.9641340566425324,0.09529504973783243,0.5045696295179306,0.3857365501177267,0.2229052451441953,0.6756430366914922,0.8428213428375593,0.3220600323361972,0.8345428736272112,0.6453254978279539,0.021300652259820807,0.6349254797417015,0.7802733552719847,0.3652461405466335,0.8470108122868704,0.4934989802799925,0.26783639677184923,0.01465829684292852,0.2976266041359289,0.9915627167476014,0.9363745625318385,0.049506470137046565,0.0750130023353035,0.983178205095421,0.5352794706521969,0.5470763961702587,0.6168905260910195,0.9315044508019649,0.9681365334032289,0.5154770020533226,0.8634826374461362,0.4011066343819796,0.7966135637640157,0.07223785536211524,0.18971688616033233,0.810677657603184,0.8510592894552584,0.8391749638368212,0.8751512185731216,0.8270290794689763,0.09713926661426153,0.4150316919921492,0.040379806699121557,0.278860695104998,0.965331395875047,0.09629932903355198,0.47019097085343375,0.3147526173237293,0.9209255585577878,0.7121541874855176,0.008001005097552083,0.8068048488612577,0.6314959487393742,0.50444191447355,0.8356191213664078,0.6466461159170281,0.5151539441762161,0.3974890495063813,0.5137161251746806,0.678393737566052,0.43036553792375654,0.5574754925707522,0.8698037722839066,0.5610071737799669,0.8653798665372827,0.4799163276145666,0.16986287955939094,0.7265631322385502,0.06826019746749867,0.44588770624968355,0.9305359796102473,0.6722967512705851,0.2776472212921698,0.3060882159523659,0.7067395406531845,0.15951033019728122,0.4994707702237545,0.12654700505109595,0.7394769274840172,0.3588521511785764,0.827216996449971,0.7279057982833125,0.5746128590974884,0.9999701214955307,0.5728226769542246,0.8911579490197611,0.864710638747873,0.058061706164024396,0.4830762410689253,0.7030885883471462,0.8291959933222801,0.30675875939323805,0.31033606371374567,0.04536826776620195,0.8130813131943144,0.07918538530786767,0.9336958026830305,0.10045447103545557,0.9194654194460387,0.551767602091449,0.012723434454726679,0.9388425013017142,0.5064249020787005,0.14734461859054448,0.2610237166420303,0.14389268912437436,0.2339513179263456,0.058516333303566315,0.4187285955563761,0.2791489112933817,0.759598040071154,0.6461554876219933,0.5399621544094747,0.6431551141210059,0.34684356108843206,0.3164676748967855,0.28547438495309974,0.43502334421037336,0.8581925100481796,0.4612372269485714,0.028369394255642222,0.8185303278498054,0.8778376433581356,0.8573938001623077,0.5976636266743418,0.30027137647185653,0.08334776628192897,0.8041680792820051,0.6961415396612749,0.9968524504068521];
	    let y = vec![0.35940253808138467,0.7213972261403615,0.4639067300774907,0.47180309198564807,0.038206849878014704,0.9293027368031384,0.7981785365715077,0.0942143398789016,0.17824438650583385,0.008513323602286293,0.14988092523052177,0.48801230566621223,0.18335776393932135,0.5111701751762835,0.3718854746706688,0.4270778368132544,0.8831235697823917,0.6876069319164198,0.46504007130092195,0.08575488127574704,0.7892239434004079,0.7056083811038888,0.8468935885213515,0.9151115736906452,0.9330933311293341,0.3694966345800498,0.8818447257294234,0.07014966058228811,0.29584663445157644,0.36447756408142695,0.9873049790846845,0.6829983349692644,0.08692332527529045,0.9195585031878962,0.7249844968271124,0.8759456066107363,0.9796050997543485,0.6933900328829765,0.005827436589346036,0.5904127348856344,0.47453899155297274,0.9274147624005696,0.5411504671449,0.8090076623934181,0.5890644133962633,0.4323811134695933,0.09641853711347015,0.9151233004414023,0.5796102694620091,0.41436522731217207,0.465299446605725,0.48901685846438536,0.26598960806336813,0.08090490589663246,0.8219243451592019,0.8566299292557277,0.21321850502753614,0.25081585668514794,0.9260434528586421,0.7071993256377099,0.7465991851054333,0.8573130676957648,0.46488642365236654,0.896134893666637,0.7006404280706663,0.3430197897909816,0.6543118593463527,0.376338167771072,0.08833995624612778,0.029094339954557014,0.9478037157797927,0.8166857901035489,0.4668518270126245,0.14560421621446507,0.7848851106613971,0.7390494481523966,0.39201887481428976,0.74979672059978,0.13153092029354974,0.7053745338459467,0.06687554612938884,0.2734778223620483,0.3404703436114116,0.8767895193844407,0.7570302406106586,0.08657335745394434,0.37748661166085284,0.41862761398643866,0.10134744318964517,0.3231310563156702,0.10117269978517018,0.0824763833312645,0.8991592637699698,0.873358291701104,0.9750753080545815,0.18341073024863397,0.9896985151809605,0.3154777041559669,0.8087381202964038,0.5213896473560089,0.7196750091702605,0.8023571442282957,0.09024301213517061,0.7748278434369485,0.8161742032101208,0.7638032103528494,0.5403514489287878,0.2668370657747694,0.8612614068341998,0.48782354061136346,0.526758911400522,0.6997959804881817,0.5971303291882262,0.9082277368122489,0.40939832835369383,0.6389395235130926,0.501226101150986,0.764757006262786,0.9660290482414198,0.9819433540110674,0.042979705686691294,0.10731803220790559,0.6117230157726183,0.9650751552858964,0.6750741460786019,0.12130348221524656,0.7675869001712938,0.7471073024215701,0.09691044058726583,0.5395210212887962,0.7304542215394798,0.5086203921897875,0.270041405156799,0.8958083617097767,0.008004763765916412,0.3814031613098434,0.9321472986482531,0.007011564654664015,0.9933903783272264,0.25806838155549294,0.836130712581859,0.7215998008588328,0.4722184347356646,0.6185800535361643,0.7302210851236719,0.44937819513343824,0.3017644477293827,0.606500210167339,0.31150197737318597,0.8805656067609431,0.7061490134726195,0.4111841322505967,0.8917436643138753,0.17823936542092744,0.34586930379202696,0.8917743225840834,0.18928275767484148,0.2761892754282149,0.2946501373741468,0.2174057861586346,0.7901810180486015,0.5349249226933429,0.749609946718417,0.7036527640643225,0.28454323838181406,0.5931358194504134,0.0691630953064607,0.6819766222543164,0.6708709640121632,0.32427083833458625,0.4262179781067812,0.7511866221259726,0.31491363368873393,0.012122632265722633,0.8421045477525487,0.9483511417833296,0.22974556043817373,0.5921941450962981,0.5913228375640194,0.5761751704305093,0.2822603156844723,0.6424659437136634,0.14455510882357658,0.7281555801707267,0.7119165533757563,0.06754911595020907,0.13428723217773897,0.713715309207116,0.9576003553509134,0.04873621771394665,0.378379470520409,0.012428419340011931,0.46512253127751024,0.7893647405197002,0.2607451099318998,0.10735727461591615,0.16633325987286918,0.3073033003135056,0.2812124322682277,0.698093151419648];
	    let r : f64 = -0.00863721593039826;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_11() {
	let x = vec![0.7312690943567076,0.10704739853901302,0.6456999443494205,0.17857017460595348,0.23789201220250022,0.583299232905927,0.25407229479600835,0.945290107022958,0.4822504232478758,0.7500901764245785,0.41745955942366797,0.29443520980934457,0.14912561745858843,0.9152014036362144,0.815126549175324,0.23991325328234248,0.09155323235951385,0.8632062103978382,0.593447491712519,0.11470834133504393,0.8179872205014497,0.7413226566383555,0.28549229661849107,0.011146519267230648,0.12576371334362446,0.26353615431620747,0.8110458772132552,0.2516762703930936,0.7083644227199758,0.1347827615581817,0.5176497275423831,0.1386229556312163,0.11580091092697598,0.14845934388777915,0.5752470156750662,0.9492729026305627,0.5414372622115449,0.07846656980746614,0.3282920901472519,0.3632524048465695,0.6780664413970889,0.3266729958140523,0.4089003269735917,0.5146917500378041,0.12016318230988587,0.7564487954797552,0.33966337484412723,0.41731427560743783,0.21809046682512678,0.04108086963023705,0.7993770061294403,0.6935286590050934,0.15333509407513757,0.535266866961101,0.5090131903785357,0.22044298042773103,0.5825975053243283,0.5985896631780036,0.47966004982665766,0.6659846179214667,0.6551805124441545,0.8167680185050151,0.6332805087403508,0.7030191177068179,0.6309348370600454,0.4972078765989927,0.3616660332491438,0.11724606391507719,0.18583719205945903,0.8141622951566686,0.9282252230582569,0.6209202174964502,0.07429803591664697,0.3252074947400314,0.08595038680586775,0.18662706771356197,0.6987852688068492,0.19197665733506497,0.9882123154702732,0.8919986289346159,0.8085812895741575,0.2318528868777674,0.3589771223644037,0.3374834595665053,0.1315689603461151,0.77165962956808,0.35741600568498444,0.8368922103824855,0.0579428809559952,0.907419940576048,0.8064521626276796,0.7379475836534772,0.3057618562791373,0.2717821130844599,0.8613667878535064,0.7627271490056702,0.5998137235662466,0.25029651163367617,0.7765148399865053,0.6812729594525344,0.5344512731984751,0.6707526929518354,0.8327583664277396,0.6257894730456541,0.20985564578174132,0.7035307259275432,0.4219932551473725,0.7477426830339675,0.4347571124408057,0.7802705384093417,0.5938591144244967,0.8329217741650051,0.7490521436553502,0.0025697960915018747,0.09589549543428755,0.7349996867690892,0.43114775164735086,0.6073588576528108,0.0013241391090949017,0.4980119221702598,0.9236290490673429,0.3627481341069444,0.7223062003493849,0.16563681343117365,0.8779238459723931,0.31930515766070755,0.13996816340091767,0.4732382671553461,0.014507697283904775,0.6335105800183509,0.7478210000713992,0.5900603998249289,0.6833316737515513,0.4925653658631798,0.6185750997126355,0.9934860287353243,0.5093982065307369,0.14099708894232033,0.5263093580294415,0.1668079593662244,0.19529337761667565,0.5838669991302151,0.5414013272034107,0.6283839399525388,0.7068261695116455,0.1715647832996885,0.9532649317129225,0.9543697651629534,0.1362913372673391,0.24423096544597767,0.9273906182733961,0.33081935757674596,0.5413928396590731,0.4969533966808859,0.8395227679516399,0.9087759737224643,0.6543109373171326,0.7988758878215487,0.4304855379612226,0.3656476689990248,0.1970521863468111,0.8548090925986838,0.5446876473159138,0.56467211463585,0.5524874121485958,0.7529744191021118,0.2931634788340355,0.2656496626546465,0.4368545712945794,0.684095737149897,0.3878943016187073,0.2754959433110957,0.7838413751871185,0.324802404692216,0.14548079652304902,0.4546863768027307,0.2345775189145176,0.18265299660114676,0.6752432545807965,0.6328375929595035,0.36037594099550185,0.6135156427995964,0.6196717912557056,0.6037678004362556,0.7360383554988154,0.06839467396487686,0.6150161382846014,0.12927058386170953,0.340095572676692,0.6879565661588948,0.3852097971417461,0.850864557651261,0.1436266057605835,0.584323449642839,0.23259268612201145,0.19277310108170354,0.5022551354137865,0.1947485039088479,0.9301079314498715,0.4218663821891362];
	    let y = vec![0.9998493795372655,0.4422235172512937,0.3003914953971444,0.9336382744319401,0.04377589437736451,0.3029616574682916,0.9315419170322178,0.07707739963220617,0.595616048343673,0.10551068511930695,0.4444119014075333,0.07358456565890881,0.7284883059711902,0.5139489777876044,0.5197368253136913,0.5818962058416262,0.8432748318418036,0.8649654593178914,0.3011884883930128,0.2998878818377809,0.6403692190646444,0.6933146047270687,0.36056101754070646,0.07429571731804763,0.21785963103224204,0.9173809627960503,0.9603980168008721,0.16267265774780526,0.05409664058709296,0.9616768546815994,0.8981714205344928,0.7634195579299821,0.7324143148609056,0.41539461944931333,0.16646384124657632,0.9232784079315937,0.1880867147583163,0.6615937200059807,0.5876248022349807,0.49597304826556643,0.9626760870953647,0.7635194689123096,0.711221086695455,0.5112577970370428,0.573342597577797,0.3017850197230707,0.955311518707007,0.07529368275814352,0.3133528832375031,0.9324877605816659,0.6908912611006663,0.39605990749399467,0.28345052446617214,0.21762389201127874,0.10774633652762322,0.29071779108510354,0.8796171898706597,0.34696738320072495,0.2548924255329227,0.31047992473694785,0.8382676638240569,0.2940167814880914,0.9387650646438891,0.15924289776370937,0.32320944313463496,0.26039573180403597,0.4862664728073769,0.8195893354290974,0.3212791163976555,0.5918544093265184,0.49087945332439964,0.16867032187413866,0.18646914371168832,0.5145097754302688,0.9319245212094437,0.8936503996300227,0.8015304875822794,0.032767953156099705,0.9838409439750075,0.5709349503420531,0.30962043391783034,0.8710329693481097,0.14713140412313308,0.693643724431578,0.09852135751598212,0.3544386506324404,0.13888654791085808,0.1169241583015097,0.06422249534313051,0.6268812765849502,0.7222677071959861,0.926931128615786,0.5400652270035364,0.6598667253777006,0.09174410270542943,0.9521508097342571,0.03421382291261932,0.686885370930433,0.8764552421958178,0.10393845593996354,0.6339266165404837,0.66059161961231,0.12493134935496863,0.10491312042606726,0.718846147332963,0.4944483651731617,0.44823214987035953,0.09840708744126236,0.0824252592514213,0.8230397924205629,0.36315056078498553,0.653838842758108,0.7985445436689522,0.04448007649552255,0.15460945798286208,0.9425658226826401,0.087970109340899,0.15433163956605034,0.39936184760998117,0.8426198998117029,0.4015320185714497,0.0783358493678955,0.14233293699715122,0.9677527843547208,0.4281936003121184,0.16191427657440782,0.8237228185627381,0.8506626443374916,0.0026503398718671356,0.6214435609248756,0.4608689769112112,0.44747849921332383,0.7382892146117312,0.20554679974262724,0.7478818828904763,0.8855524628886061,0.48644946615065177,0.7313364366122156,0.806390599691997,0.47841736994787853,0.8927147156919,0.9674394709570752,0.6329096486590837,0.831071772921703,0.48429996113039886,0.5646760629816319,0.09052615662933539,0.2937024682759164,0.2772743146234208,0.2456433682412108,0.32775499816208997,0.19801070667035003,0.01910997767105649,0.15383003148219643,0.8205704537964169,0.12358510747867302,0.6009444504886031,0.44211517585730054,0.8281072748356959,0.7755677585325557,0.08148289656886087,0.6209032690073221,0.7423207037274863,0.2253208657857948,0.3098311375103774,0.6783120208246307,0.8950270019336991,0.024647983222539027,0.2341385803202689,0.5188423257831999,0.14170303486235214,0.8874033996303168,0.6221802832548078,0.9390941406163205,0.9188015023077735,0.8470229299559329,0.056624481524379155,0.6012313845990099,0.9763191676266758,0.8878152797095453,0.01137553024831739,0.9967505975269587,0.9119020296287912,0.5418339826444659,0.7668971133344279,0.1020281353548127,0.18441854783177158,0.4569938673349767,0.985223601112778,0.5976793299638054,0.3790090359085818,0.33401829656689286,0.0447614437694136,0.38866640361125304,0.3206010861258618,0.5109725567357578,0.8729737895734399,0.5802296061274095,0.42499003837710503,0.9551331377110938];
	    let r : f64 = 0.0712967824195605;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_12() {
	let x = vec![0.9265877357967075,0.004055452143049476,0.4192139864831145,0.05581073792868607,0.7506810950042944,0.9246726772717452,0.1283677056473146,0.4273710264934406,0.2528642033330184,0.043686040216244004,0.5854107512372259,0.4544146890118028,0.7106949006715131,0.2609231826456193,0.00038402060820275086,0.41543506659664176,0.9238774345228337,0.86294764552494,0.5709593532859004,0.5452202492244246,0.4780386923937282,0.45526881677342745,0.1741288464699221,0.28175355455849804,0.48037800961131416,0.9497061217062268,0.450182423395626,0.2348509215766008,0.85233076656051,0.1365808547062488,0.8289824485649131,0.7141879967308922,0.5780623720120691,0.6725679543423081,0.512744630807624,0.33767409154671757,0.9228985068295786,0.23027953003844703,0.5477696469704307,0.3703131489231505,0.9157979348151852,0.9681474006569516,0.8782267305170546,0.9557074529620682,0.39607567976583713,0.8175939617911387,0.7065544002948724,0.4787373664219624,0.02337972916143405,0.2784538458243063,0.452386027149557,0.6154805504386837,0.7170217170199551,0.3170555590463673,0.6132689979485508,0.7205860721227296,0.4169327957540998,0.7761726148920928,0.8546729060441642,0.5392888728474845,0.9667150753160701,0.03982881858639875,0.6774970966720474,0.9587916961132452,0.5534004805098912,0.7750731484699682,0.1630183869922982,0.3107217146800382,0.6564967480415945,0.8462366101265212,0.47239459533091055,0.6379321248134295,0.35192394381032055,0.9637446502525092,0.1878035232945514,0.6962697074038612,0.8879179961356646,0.5634585861264623,0.8878711375571352,0.7625012399476573,0.2590709476920452,0.8870336112137109,0.3059990140290251,0.7106972477887002,0.2917848007714211,0.6622722671230165,0.2363932626439853,0.6063218541482966,0.5737128715106863,0.31310604932521946,0.8489377536339688,0.9308928271051276,0.12195201344738915,0.24630247757716395,0.3702465328391785,0.7090003657149737,0.09113600586424297,0.8505916772696539,0.802510364361688,0.15513495990510107,0.9030501807554925,0.14098587170763455,0.22522679155755376,0.9551612429464145,0.07940783235887716,0.031550045653096936,0.6862343017948033,0.41761359887719174,0.5429439677782321,0.2251435600733379,0.6310423623395899,0.30268137062615985,0.3874023643284292,0.02989294402630016,0.9568916408451482,0.14573597454560316,0.9584437012158341,0.083653268345246,0.8119448715158072,0.15043505262974655,0.6399210953116098,0.39977331116041814,0.9154976708129025,0.752683814780404,0.8094698465975215,0.8391534960703875,0.023932844827388444,0.9169537527402642,0.2497755651967708,0.214490883907831,0.5946501767008039,0.8371604167625688,0.5014162335947839,0.2481986755924298,0.28734773061269747,0.9186904368676547,0.8825127536053633,0.24422671926254536,0.604202916939748,0.03971512625461515,0.3959359104604283,0.5035856917693348,0.6497091166100507,0.5550148126787373,0.14557828205762224,0.8457491006829458,0.5747436830097885,0.5198303448656376,0.5890139159521278,0.5641164887101648,0.6210500802787831,0.600897685252355,0.7184723920881523,0.30558073378053685,0.2360346663544377,0.0747641936551644,0.6768722883561572,0.18420404261571155,0.2542705516549615,0.6401560205565631,0.6921603691119091,0.03138696732393398,0.2527854698502454,0.6506684537352775,0.7102189727955793,0.5231109020919975,0.39130971918087276,0.012678810576493449,0.03631477971849839,0.9886105784509105,0.4228030903444121,0.19454108521082603,0.37407314565372474,0.49424712163376006,0.9279473501991597,0.26526118005248456,0.055048251445178664,0.02112875075650633,0.40698714810117254,0.6816516471387434,0.033462395436490544,0.9666200168188999,0.03748271799654623,0.7158571916106685,0.045280638136283025,0.521011878204208,0.6883468492570857,0.28007714781018433,0.31943188882922546,0.13316312164636146,0.3433531749267038,0.330930288051294,0.5872844014439943,0.677747055496496,0.4419576031364172,0.24112078182605945,0.4318654767533662,0.4706059132266861,0.17733611217376566,0.8756728596049735];
	    let y = vec![0.43948009544437594,0.7810011767609253,0.6882091481722709,0.18912837288452367,0.15105438390518633,0.040653365268869646,0.48949728566062845,0.27972465820669756,0.09536523776463846,0.6971565667144148,0.9534105021494695,0.2163460007612401,0.08844969966112592,0.4631737173480992,0.1768208735347161,0.5832728024831911,0.111825910845883,0.5849652987892342,0.4970144786319931,0.4971971078147679,0.6307950086970865,0.4672328540128903,0.04843755626882684,0.23880902724805064,0.09996829000790086,0.013200602584380938,0.2817437893064858,0.8387842237197805,0.3083779107513622,0.9247446920633097,0.023567107205262894,0.1893912209624129,0.27199355288624305,0.03401235922664736,0.8142139666766922,0.11181240082049015,0.15403962039232322,0.06619431815652776,0.17370199749726933,0.8861206984833858,0.9410891054385946,0.8368580046558449,0.9340011470682648,0.49957107428561054,0.7676837481740509,0.7338319330291845,0.3960600062542744,0.5250256206494991,0.709703137374227,0.8547812702115188,0.19129835482588242,0.4991625255534683,0.6318614657633953,0.2006350627282676,0.5523945911021174,0.6855125609515365,0.5339633580489385,0.8948664067251493,0.36895468330732173,0.3610416627475337,0.20241683438275826,0.6338659958707581,0.8310085591354823,0.49588033964534084,0.089992110071622,0.23591487227733954,0.08825116174915493,0.4163487710164412,0.5628119354182647,0.29260730908880683,0.8974476247188814,0.08639538121990353,0.972019346133405,0.856763349695785,0.4705053006045331,0.459569351341343,0.6553026654347418,0.36375294684932025,0.7442635587144981,0.2402247449263316,0.04428564805181623,0.6778749903023805,0.22610479876267853,0.3052700391237412,0.5859075231842193,0.8075241675185663,0.08596363672754148,0.3567236677772132,0.47191435591706243,0.17708382893365993,0.2973985786281528,0.12939577827613535,0.865528640235374,0.34437217448857105,0.21376527210716267,0.6068213252013556,0.24030136928965662,0.0844454217879469,0.039078378460589924,0.9880201333073372,0.1363462419714655,0.33314777671786977,0.2879149730216549,0.14211248082952954,0.04277560761702259,0.7406261546337033,0.9155551306080754,0.7243988274204496,0.03191563803884956,0.6580336304771836,0.6222453866560964,0.18642043340937953,0.9572150214260622,0.4289200864473567,0.48605836720266704,0.02714850420262993,0.5102866282587956,0.0728374607944049,0.3811036382791041,0.07522018422539145,0.47810300896328883,0.9548602228743469,0.8874993870983526,0.6323005603064102,0.5220508812183688,0.9435634949935703,0.586474583557131,0.34524733701417554,0.11423221289438545,0.01563296753867005,0.864375732714379,0.01369274033956902,0.17709411734022917,0.23098210767877514,0.5056496721602957,0.03422414522527084,0.1636164960516816,0.07725846168210926,0.8053174176700527,0.9466149753086615,0.8945619236601625,0.3817063908226258,0.12178043596873456,0.7521394809504128,0.3150917633200374,0.09271170483800373,0.9923264574705668,0.732799330077795,0.907334002933922,0.6056463666165546,0.05382254894281291,0.08659572446664399,0.2469677348486886,0.001722754538822202,0.7541256135413409,0.16700580856343006,0.14350861940057358,0.9734427393962743,0.015306110088556535,0.9087849411779829,0.552080051457183,0.6303242652074758,0.23135941840456986,0.7005154838616537,0.33866804400931094,0.9064271126599838,0.0969769775894348,0.6548131283629754,0.26755768842784444,0.5713961964717527,0.5058381067469797,0.9023173768259151,0.5510975985579588,0.5302641647126288,0.8531675138938986,0.4654541846833766,0.6888910106017249,0.4459215765253324,0.5668042444412508,0.10255941597872453,0.050737313081124946,0.8114910231536269,0.8593568017755452,0.8228816198745955,0.285176247070403,0.2959160919415831,0.8045317216101725,0.15644045011973173,0.44137676129365266,0.7698296936153224,0.5681809598653028,0.5020684813091069,0.9971226610616916,0.775154058663509,0.7257342212726425,0.6246132923973692,0.26564297035391615,0.6297855869657554,0.34273078183619177,0.11714564745012102];
	    let r : f64 = -0.00013050326258156456;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_13() {
	let x = vec![0.13875080828556063,0.7294664988684701,0.6181868532724404,0.39714980770899033,0.9231048073419239,0.6161426011467515,0.5810133951067425,0.7665564505084119,0.6012179222738412,0.05014155032713197,0.753746896631716,0.09997892659181928,0.009614633842192521,0.30907081454214325,0.6710398787266901,0.837853159546255,0.4529899334065727,0.27774631932767035,0.017139336483349865,0.5992951376665785,0.2637095177181329,0.7596006320412038,0.3580989287981061,0.7254883926595266,0.5251537776504404,0.015105680322264559,0.7517382177157911,0.3293293335748799,0.44161428712592676,0.5847362395948822,0.7077383214265403,0.5221631550518997,0.19557139009605295,0.428216278500835,0.9361064127067161,0.8404941998747884,0.5119950131040684,0.07202658057741984,0.8611650698041206,0.8385683883490224,0.7590672891743264,0.5266332220277432,0.5382665122037058,0.46729420420958045,0.22756523524367878,0.7473489947524168,0.013085524083264799,0.974585420686581,0.5762631136854622,0.2779896156691506,0.19702092755391087,0.7488967604027494,0.2311601448520496,0.6674288619355053,0.43705303274406015,0.031164189951813692,0.8802163691005059,0.18187670925354327,0.5609547752287549,0.345319559158593,0.10906777750036689,0.7944444243418777,0.465186129766639,0.8172558673561487,0.33736807108683176,0.8009586997962553,0.4746211374147584,0.7375989560656706,0.8005123717959773,0.9151486261090872,0.10766218228168922,0.30102762039811304,0.5916451268834366,0.06219763027804426,0.9452519833990036,0.9045078165138412,0.08836747097315756,0.6817063269108322,0.859614668023875,0.7951212374941051,0.259092644674192,0.1809030557902035,0.03649548299518601,0.3770465733358799,0.784353093302486,0.7187655614963432,0.5433887065413037,0.8551341040344207,0.9959113284207549,0.5078774932502983,0.5690203641947861,0.6004304944826735,0.2911110484554045,0.8518344643312514,0.9016269931852713,0.3818708911126657,0.8837716616180433,0.5885086899267268,0.8694642837616803,0.8985419287168249,0.8769533897085201,0.9378125881797267,0.37649407990865713,0.5919403915675633,0.4649730302713293,0.8606645988333489,0.7310794324068364,0.4964369481181713,0.6513195980573734,0.944911265957946,0.41262166802376377,0.6541364849272477,0.8758380804602295,0.3964247955205602,0.6035706293269243,0.2635655907293091,0.4288761504637104,0.5252282400670567,0.8177522969423812,0.30851183272122606,0.6038134318023052,0.5928986984129377,0.6909191632858188,0.5521777288813707,0.7817180146447228,0.13173611000649066,0.9762538270893847,0.8664047276875958,0.4564276067837272,0.3274134867254116,0.951302885538357,0.32235692867821597,0.4846564012876219,0.6351969726010289,0.10795021129852844,0.6124059246914231,0.070443169378965,0.24007930034512193,0.46087386402384123,0.01722548562955306,0.8509073584299082,0.9070894024021249,0.32744247403650195,0.38025649826411934,0.9749280413173155,0.25295565947551113,0.7461606836446842,0.8085038409658244,0.9876015204667388,0.15426681867325776,0.2631343917182798,0.0791880700202896,0.7077561196753729,0.2954587316758044,0.9847709389969498,0.18719813899590676,0.08098556983333527,0.9000836608380306,0.09525925059618812,0.8801396014290984,0.8794347329128602,0.014019543158707126,0.886371349059441,0.23526253409202602,0.9210586957524769,0.28736702663349856,0.6162685340599334,0.6168116621742455,0.38119391487829024,0.8696826972201664,0.7721207774402583,0.21445230590646303,0.6406787368059212,0.1851997936560047,0.2753240886543905,0.48305485086204303,0.7458601632259031,0.4938542079599534,0.15040832888336708,0.46018691129125466,0.26960266894510576,0.3587517497806637,0.1316337858080654,0.6680987662715074,0.09045928561932504,0.42448041681430193,0.4324752483369846,0.7957091671439223,0.056895772069495365,0.4061486630073169,0.4307990459339376,0.35089280461944505,0.30924682262597547,0.48829375472067593,0.8127898417056143,0.22028708892047555,0.17481560408578,0.30802660944560156,0.8842024592970387,0.013785491905052405];
	    let y = vec![0.8308249669760651,0.346173252341175,0.5317731539152409,0.2837786103347918,0.8342756262603048,0.3130333129736773,0.19068828841917818,0.19292635871385955,0.15948056550545797,0.536309480711527,0.47237465218303465,0.022052276810682003,0.9521161913762745,0.7446657351560851,0.03285563146411852,0.1700410450679256,0.8108708487273151,0.009126070068925185,0.3828953350025397,0.11008855486276681,0.11677447057753565,0.17367603794757658,0.3932601518166505,0.8197236390524715,0.9933019502165019,0.8466244172915911,0.6736239286317539,0.9533640430986007,0.3023701422682802,0.434904248740398,0.15223120820996394,0.5399842531547908,0.5889513679128683,0.03429684921311171,0.5095214092853386,0.47258103215984537,0.710454227437575,0.05673929238565423,0.46420757873009577,0.8428289395394118,0.14082752949671007,0.508720717737653,0.8891439374125557,0.5941722958512984,0.9595758079716694,0.5905819777268295,0.30828930499083995,0.44660550492489237,0.4631331986744657,0.5394960655532546,0.049917227583685886,0.7959509365699954,0.5205946409374932,0.4992463773904664,0.001426465099825469,0.4709758628453623,0.8376444932460904,0.5064066270554787,0.9010016073206233,0.46455354062695364,0.5790375162428513,0.07252391791899337,0.9270990493837853,0.679144229110723,0.15529600917573405,0.8625158536217987,0.31220756168345243,0.336155807206021,0.046550196045972214,0.35918164140633313,0.13214723948233686,0.3625049769620047,0.5822136398237001,0.517654810592082,0.2739956897300926,0.15612657014752962,0.9797989005183236,0.9948936838283596,0.49921071223923386,0.00835053166732258,0.28344953290064157,0.10844832981946495,0.6197541516465386,0.4029770456138587,0.18793711300584737,0.9152634756825819,0.45423276530490286,0.13518520740835238,0.4239888272790723,0.6779855482816497,0.3576249390141327,0.9692024753701437,0.10843637577048804,0.436518785122874,0.43167898292480866,0.6235706318758585,0.04732871843659092,0.4984751389681382,0.709407031557113,0.7293004566387359,0.0997857326019177,0.7439748221459593,0.23966421729883358,0.5558844684934557,0.4261299415481943,0.8148892034887761,0.7590258930924735,0.13405961887570406,0.5860469119916905,0.6812423748470597,0.044870426377494166,0.010200979718130165,0.7290631492577675,0.6145095329899112,0.10576276489556025,0.6977856936816507,0.5952825217023363,0.47446291146576347,0.5572176052423187,0.9486511381791456,0.9143642748666022,0.5736327570487441,0.3526609987854461,0.479418081168132,0.8598935135223327,0.820700145589777,0.8792767332944815,0.5211227980793361,0.8473284461166743,0.8255209383105481,0.9432000686583988,0.9700625598369315,0.2369721213646906,0.5884661924021243,0.2952699337043062,0.6732941969654853,0.2583018124918014,0.710965933898345,0.4783890734737395,0.02253984398721387,0.4401869527952915,0.7475696153013108,0.8646011383473555,0.7352345950635447,0.5500831401492381,0.04780330465505522,0.9252538776995246,0.28741381477346895,0.5039152105179712,0.6063241139659425,0.9757777238574848,0.42684239846087557,0.743098018264384,0.8211316323546277,0.4540834798786987,0.045620479234491196,0.036448290395067584,0.6585751802556462,0.26261403880317213,0.40982748266172875,0.4551239872626668,0.90735316390942,0.21629158024574358,0.5607108070266015,0.05213861662831343,0.6875757840385877,0.9653744624397237,0.8872063964392333,0.7431528445534011,0.1980909741818564,0.0024227914342837,0.811776550316204,0.48969382924915816,0.19166320978814622,0.34136516817613916,0.9655853709180577,0.7776873016398778,0.9105227594743072,0.11367445465719761,0.017952650194879127,0.9694923638186171,0.11558044427809,0.04569224056461929,0.993561969750297,0.5895852883713885,0.7916432798599432,0.3213333538820694,0.26069852467108856,0.571046477663996,0.3633294993294959,0.05156436099662742,0.6351837483724712,0.7330762610506867,0.911418185329228,0.566094979022619,0.580452983430533,0.7046532375736985,0.1433970159559963,0.8219903858372414,0.7978465857534814];
	    let r : f64 = 0.013000825020625517;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_14() {
	let x = vec![0.1477070386440945,0.6885280141260257,0.6281538814575353,0.26175566676321993,0.5969975257295764,0.9183161399386607,0.25037446543324593,0.9900303748451966,0.5849957538440534,0.7816181344083531,0.8488092282434311,0.010976677812836955,0.7463672171996394,0.8080083953825185,3.957858026271133e-05,0.40711802061663016,0.30847515066033837,0.5315319796825955,0.9836004583709561,0.6983580308648257,0.1776344660333513,0.05349719857724511,0.7869802892012437,0.5846779664931465,0.7554871236628677,0.17618171266396176,0.45984775631633645,0.12285882059710695,0.7507088706484489,0.6338526069738067,0.39048595521181284,0.6449532726149931,0.08444314355859062,0.4668465547845059,0.43622215270484554,0.04712370396250731,0.4135021988089602,0.697290914494537,0.22095410833016316,0.6872346560419413,0.8886450124874816,0.013187386535323697,0.20997428480745917,0.100280212929162,0.7002761922584777,0.08740842626848777,0.9813082841848544,0.14442609547591356,0.9052916983877469,0.16092139934011795,0.729011759830695,0.21169341037979494,0.041058110943071435,0.41492836827707147,0.0871647439646428,0.9323209911225366,0.0738318875666869,0.3783697868456527,0.08747448610075204,0.5911459609020989,0.7968991995335253,0.3591268168397559,0.4912220053795189,0.606518280979964,0.09720907353868113,0.9385263086872812,0.2437274339111427,0.2712051312737601,0.9076706893432717,0.1529097290426228,0.3410472190459949,0.8096365132317069,0.139011234002972,0.05752852520934093,0.03932887187159129,0.4272468642047099,0.9612282994012183,0.2819786319990437,0.721662179199615,0.8243378047400259,0.909974318173747,0.05779791010096469,0.6924235004121694,0.08482044601351957,0.9977192766439574,0.7524787710446488,0.5518697893233854,0.5356939904188444,0.11653602635743054,0.7539092212813454,0.29898000239572264,0.9368715554489624,0.6172036593100484,0.27948042760603575,0.6840346216489892,0.8848887622078873,0.25978749127708567,0.648168321313502,0.9833616607878389,0.07127330077330662,0.7140181061478791,0.37323137547296037,0.7844626334310603,0.13973465880731895,0.7543569886580643,0.13443183101234069,0.5989829960042461,0.4489499097801586,0.13669434296291094,0.23001024692485594,0.3429660227280833,0.7793825552187679,0.4709784156895348,0.08649178865771479,0.25986673107330516,0.8338771247960888,0.06039342661988811,0.902541733468445,0.9085237901768449,0.05021639682561718,0.6359001634166903,0.5003912340232457,0.28313500181381746,0.8747196716066463,0.5326647741979226,0.012556335674345998,0.9288245701188698,0.20842035158987127,0.9155509633313663,0.9084111825994647,0.9139437813338491,0.8901714124700745,0.13186800406936527,0.8573266182791608,0.49799309134467284,0.03977745250142084,0.9799623397703643,0.196085949062342,0.9805025160375563,0.8285741249075671,0.4043934032055413,0.9365494161372688,0.8414978596770035,0.6156922879896813,0.04452665370524833,0.06176966868450118,0.4182917446366855,0.06845026226095285,0.21546531509175348,0.04598501302794111,0.9380847911157196,0.6222903067457464,0.42008078003687277,0.8919478587795152,0.14851357535202536,0.7836572056936555,0.8208567308548927,0.6335997713781536,0.44345157953122616,0.457702790259506,0.3694347788001834,0.02313761744656273,0.9558754249613437,0.22033015889872476,0.12920167357655787,0.6737863774306659,0.03173756060720889,0.8255654735279601,0.9787026387806584,0.5421832294506487,0.04058170512627346,0.3378298397168825,0.0655287281794612,0.7060621585454256,0.9807601612505644,0.10169494939116364,0.4440472816463015,0.9272513542002878,0.8074966960559837,0.03918720532711184,0.6829645859931347,0.48790819854913703,0.8198428640190711,0.6652964994821174,0.015993943072268868,0.41454178030529787,0.2903104718145918,0.1591587737829172,0.03902928339923539,0.6999681513167191,0.05510146098523605,0.8867857077927027,0.10242230367454086,0.24196644328945338,0.019124248259518972,0.6916072207125711,0.7199577653695897,0.4397321182031986,0.7282574831220264,0.5667226938506267];
	    let y = vec![0.8641138386237714,0.7313127453986402,0.9831291337898606,0.8469171516864064,0.4823724055806955,0.757046941056538,0.22956197367297115,0.5007321760968432,0.2297769934290378,0.3635406593892423,0.9819617612888204,0.02188038548586213,0.5347294053189113,0.5801628313065365,0.46766841665965253,0.3601989095893273,0.07985139661286444,0.8373718800263437,0.8342987272936282,0.0804034738833197,0.019949401685929624,0.8286485262427518,0.503782176672828,0.7490713563745209,0.9833119960524768,0.7299531501777577,0.8574312625803546,0.3499267612393214,0.5265835096287279,0.7115968193680421,0.5836574111497147,0.8061268202567263,0.007064114357354434,0.9796644609994979,0.30111329600539827,0.48033425927922313,0.23611511829115506,0.4359241695419701,0.8520054896564273,0.1769198247577478,0.34662629352749974,0.7768655369915147,0.7687886436736118,0.2686985706005419,0.030834507689050605,0.8822770499760881,0.16815986896471824,0.7274718331108123,0.3518078334222011,0.7734449529382512,0.10980893464045949,0.5347326774980931,0.915440462735948,0.6052282786646965,0.9935470874479196,0.7645464626876486,0.9868703494630714,0.19455055810535848,0.9569374002830217,0.16164570195401906,0.2835998580276273,0.27758838913047723,0.014260596555296323,0.11512065599783194,0.12752947948769755,0.04384999324604544,0.09292721543618698,0.783178019624954,0.9047092369531736,0.05740300331328552,0.5895132673210318,0.9291606396021036,0.15500610903839207,0.32953304345612877,0.649460453902256,0.4732682963315876,0.2467728379574855,0.6481470670446325,0.4185610113633893,0.591004852403594,0.7531897240914729,0.9826265099065402,0.6759632852151302,0.3210038474981317,0.7428361162994624,0.9398933967569808,0.9592963256254332,0.07845089892357104,0.6157485808310958,0.9071104925012261,0.4331005785891455,0.41621602760830034,0.2925172511231441,0.2853982133690529,0.420656350726211,0.1261051522835278,0.5782004153639237,0.9888301783129211,0.10680544576261719,0.4686917334459808,0.7127848487124103,0.5801878309199747,0.7930062526858651,0.26943247597004827,0.521024174738885,0.41249642541574627,0.15130109322011298,0.9129185518894041,0.041393737253031415,0.831607926286234,0.6947273325458747,0.6575666909816956,0.5526120130733212,0.24227766178788834,0.5922438765872962,0.855368158181012,0.6199422715443413,0.49547467144446555,0.9388054454346499,0.737651749897877,0.9358118945274503,0.08897515566698022,0.40936313154217574,0.06008443838031574,0.8516968968301697,0.922517848858272,0.8904854944230255,0.5033069697869256,0.6188442086300011,0.09020506184380583,0.6423465288998554,0.8184997822274808,0.08824396959655012,0.4387472402089069,0.48747182779397125,0.01578538940666141,0.9025736925804431,0.9163899567173333,0.40532684167666144,0.484469838727864,0.5083908125383005,0.07001781101678506,0.41361433084372023,0.7754087869914056,0.3675429333886713,0.5302238646395295,0.9300711649824414,0.39565297764897234,0.5831979771901341,0.43669493228846523,0.4766768074462753,0.968089243014847,0.9672779097016068,0.7715656203542924,0.8086891547106249,0.21450256133983803,0.914011869304908,0.7366306610359673,0.2785416133362426,0.7419931385024136,0.5061368789172433,0.5986891026330029,0.6262631031224875,0.5216836892930184,0.6549645514787313,0.6985282308276879,0.16284741655058899,0.8589217237189422,0.06730185657321774,0.9268451755084928,0.4339597064984343,0.37652377971603224,0.09010225332526112,0.22701050374979648,0.7125074815085527,0.8047853306275605,0.03468664158381718,0.6183083245546611,0.4094964172102251,0.4068369521844515,0.0054435537660108,0.07583406694255579,0.5592261606016552,0.6182064319368706,0.49913091878793014,0.47715561056883493,0.09128219446107888,0.7016465832799731,0.6125564908216001,0.06820380173360752,0.5479991242728302,0.2864217307710135,0.7253593942650287,0.40582308680070633,0.19841285370281891,0.9536246268636076,0.27352062046718184,0.996197980171167,0.6611209156541191,0.7635800014216441];
	    let r : f64 = 0.04185254631365785;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_15() {
	let x = vec![0.3274543864809134,0.5616387259669987,0.41927904178742736,0.731821011574097,0.04497872293077121,0.8579885076922431,0.6585077446380556,0.023127506340035908,0.3341671346740511,0.598741254817141,0.6028819509968059,0.4209792963682386,0.5539437362123103,0.2355193407995474,0.24397912679738187,0.729363519231326,0.1854952678938805,0.37004918121659347,0.4165441411093118,0.36499011524818137,0.06273079202087306,0.09876349638073056,0.42669444660641,0.9904218939916067,0.6665118853402883,0.9465452264976988,0.9107836534290018,0.5807117656816659,0.7734591629938433,0.8355667638837294,0.36014669936460453,0.1360011233576276,0.9950516501299779,0.33079792170053235,0.7736001278977453,0.01799890385073999,0.5155622977737544,0.06622259280980336,0.08710655683747803,0.8565996843192236,0.28352992316053194,0.8525148764972826,0.8317524564136775,0.1157956900405549,0.8666161571995028,0.8085742215448699,0.4068807823028918,0.3724502671480837,0.486200871201274,0.8952361724319752,0.5240755448779666,0.7489641991674733,0.5607495150182054,0.9735862257871022,0.5447220424760935,0.1611248622998852,0.732704784724325,0.4260422523326238,0.7044311797633318,0.021430110356364773,0.9937553549435126,0.38128729420305874,0.5817322078639448,0.9008708339485791,0.6175304983916297,0.8328803164697142,0.6818019654958054,0.6502279758399573,0.09193427130214149,0.16198182476687673,0.14293009047667793,0.27046191378723217,0.32740803291314025,0.499061893410346,0.9315496067401502,0.8696071084937879,0.4264059050630815,0.9261568134962052,0.7870640328146231,0.9226910906799936,0.8350376782064436,0.13755758170365917,0.7426180828920371,0.18674135096883515,0.6718495261815074,0.6325086102425604,0.48679895085093994,0.40684263478417537,0.017419870461923836,0.724602808398859,0.7618061415847147,0.06273941917253467,0.17912365866987245,0.21478786446814713,0.9527588505528837,0.6206882923308517,0.3877433018095292,0.5118972837727529,0.11187650460657039,0.3210933472116434,0.24705611656128423,0.14597921800304559,0.47319151071478915,0.25572002943865113,0.47388487138960134,0.1667180670163545,0.8319875635062501,0.8902155188199419,0.4999465125389043,0.9483154785004345,0.6647740408431274,0.1929668763018796,0.4778156887759045,0.656465928399545,0.9266867841326976,0.710833245458987,0.04646126270637141,0.04264864549076908,0.6705986358568207,0.06822999151776021,0.5864368846057929,0.7508953946472626,0.12978735250588647,0.1320215047706511,0.12662198717427353,0.729032050460926,0.1139508741928672,0.33107464982749,0.027881591370614744,0.480132100169698,0.581269425744413,0.006923169201622281,0.6094632007951841,0.6045182006573829,0.22016952873421514,0.8313004386478247,0.8999068824030904,0.6691854708980481,0.659408818038101,0.5517523802087696,0.13919324090717955,0.6730480514096987,0.3093132410442212,0.9113424970995695,0.6677510156831157,0.08522178441885009,0.08152550884573284,0.41102694607720636,0.20766571728620553,0.6874032955763173,0.31621791214773676,0.9787201209459145,0.4563228154749016,0.6906657528150961,0.01954727178609894,0.4386594477646444,0.6706528381121877,0.4495715099556088,0.12579520759534224,0.47661462676528166,0.22942768237227118,0.28093381193810196,0.41628292760988206,0.667679718896785,0.7872542010227966,0.6442636613093811,0.013864708856661911,0.9227021596896119,0.06545417947024301,0.09456197008868639,0.5452194510419112,0.81801670359236,0.47223108579214157,0.8681883366732477,0.6103604142856524,0.9274183800728155,0.46562254404109293,0.6777035837921389,0.41717058151557584,0.22076084916518546,0.4743298934501964,0.24532733443889831,0.5657740748120289,0.2709479513903871,0.6898399169399472,0.004755592870333891,0.6339222455307779,0.3783295018655819,0.434047139849672,0.34242686734015204,0.4093447086871562,0.06771665908975677,0.8113389125067719,0.28853189946624336,0.08968451376594533,0.5454098517652141,0.8626030524196739,0.060963655847047216,0.33770956716165035,0.33393229539894054];
	    let y = vec![0.9137868948339483,0.36811704258954303,0.2993493271435623,0.40758320977387097,0.06444467045857438,0.8617656063430629,0.6379128805156122,0.49008042817349207,0.6403408606349471,0.25286784877015633,0.2482861211330959,0.1855968161906637,0.7866804612527807,0.025746595450152676,0.15713803977978869,0.2847111204678111,0.6623764400299089,0.8988468631881144,0.4158446125076254,0.32947957603787015,0.9299026977304296,0.7844799695033899,0.5913518173956482,0.8009125004300013,0.5438659521057735,0.7630468122586893,0.32025988500518676,0.5168883332356884,0.7099710887084131,0.6960258774153786,0.3920838345676657,0.5135437489395286,0.6709272724742473,0.6087163780872233,0.3135331882068101,0.5668522014784526,0.7813516991244802,0.5660791776499129,0.6905909917851679,0.6380704668084884,0.33093512362282307,0.7456364536024239,0.6828343619791951,0.8845431033768036,0.5689779630661056,0.3850755146796737,0.06569625148578828,0.30510047630416337,0.21142592081939282,0.44703130521646917,0.5588251452957963,0.8009073540903048,0.12444594381046747,0.23526017625595286,0.6444013503864886,0.19940228280044237,0.5642768367256915,0.4805457904265481,0.857437867361997,0.862795245069186,0.9146074530842301,0.656882800037154,0.7278224934448854,0.961490129561509,0.2857201579481734,0.2556291047817212,0.19270106762548012,0.5500390066051459,0.5442490309592514,0.8323011305899548,0.5132623513702067,0.249521457366358,0.9292595936083837,0.5924110601820086,0.2597549322849576,0.7299295727327154,0.5322815316121936,0.6742036290317508,0.9412827264145655,0.7851702102580683,0.4087440142841636,0.6928868625757808,0.9353187945456745,0.6765401566276231,0.9980170873919613,0.6944388367825781,0.9500002019304438,0.07369008404775279,0.3611541175455011,0.1391131150320648,0.3308169196588413,0.7683816424754178,0.38937005025310634,0.1616567212196841,0.7866791109194101,0.18890807314313518,0.9983493616597723,0.24366941776887474,0.5409671103287593,0.7653029581834653,0.7197662934917876,0.5281365166871979,0.2240946000081836,0.9314701043490727,0.9841488359136537,0.18459051503679025,0.711960143311449,0.7181960918576038,0.8066683841746993,0.9105529396475784,0.3173260363216236,0.6530055520737413,0.67515305269214,0.8708501094968502,0.6072543625212028,0.16810799102885843,0.49058386637785834,0.2925402950058241,0.3372763689923872,0.46595484575411306,0.7085899538528727,0.6655387436506571,0.13763724258937016,0.6531942735605045,0.5870243665534017,0.06480054909799515,0.4128589196798167,0.5255741080063459,0.21049339163163228,0.8083154082069406,0.4217281086840351,0.33336024603983405,0.14998202903181213,0.9937899520532014,0.24979718011379615,0.47964817188109365,0.23365278801903433,0.2024103292912669,0.6486711796328086,0.9726130535807357,0.3582062596130139,0.7368216820357738,0.34786491470792913,0.19989645396220135,0.37220374689040037,0.4118362121829282,0.8741808539340539,0.9069984670566505,0.26894352195519866,0.4276914980960289,0.6532141436620105,0.9360777076910559,0.05412340393851123,0.3862335485320765,0.9061495650264124,0.06470015461704903,0.6547050228046353,0.39380956302488523,0.9513280534697945,0.382893648401629,0.03657517780714359,0.11142879189783839,0.8860833596713619,0.8472308303201228,0.22356614383136597,0.154749279308658,0.751571582115579,0.4546263210571886,0.7615187954915048,0.9281058306923813,0.8982139838507329,0.417667244448372,0.6768651980436658,0.2380492062800359,0.30453266144451174,0.8057086636131189,0.12724981133082713,0.4330032858365258,0.4322570578363748,0.5852598704658152,0.36544998151217445,0.005162333234436045,0.9318553580529829,0.6507973686150389,0.5351734630171323,0.6250408688721689,0.7717170488222848,0.3122445401452216,0.18078650692275322,0.7628985481756515,0.8846333652393172,0.20279720049558525,0.34329418129392353,0.44099570993266035,0.45674662012938494,0.9145040084498486,0.6612824769073259,0.1857014713897862,0.5649513568309754,0.24585321974444996];
	    let r : f64 = 0.07838295957398937;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_16() {
	let x = vec![0.9014977820382019,0.7733126477508712,0.7796413153148579,0.9187024909569347,0.00534411441161009,0.0556819308823715,0.680166079846323,0.16135022865321758,0.9014887770998892,0.7542334477748874,0.8469518925414172,0.18554859747378338,0.41446282481317476,0.16832401945519848,0.7686436760337094,0.4250592066227693,0.5878770298962418,0.4845277125237355,0.5054987086405244,0.018516727271571276,0.8083084104752717,0.7829881327467948,0.8418506395056373,0.14616936634253053,0.5891636263729363,0.6975030426363146,0.5367738557308993,0.9945724205438474,0.47244733479988676,0.3186015668095258,0.22734740160063183,0.7405387413118032,0.009774192654776304,0.8821250772125454,0.5866384135037959,0.6855453549287756,0.5163675886498961,0.9232749968409438,0.1719805039689516,0.9511051759855538,0.945627923024942,0.19641288617930408,0.4544695834081732,0.33413181172039286,0.9265023500384028,0.6233486280362799,0.8671824265697015,0.9475064106499936,0.6637102160159922,0.6010612060337246,0.9317881317268344,0.49248813275173575,0.9420636177245412,0.3462368934281085,0.280570485304925,0.026393187476649982,0.13510829163765647,0.11684285221726787,0.3389378463856344,0.5002272614376643,0.025692055801205038,0.8214429465091977,0.8046358112472175,0.3600451191592198,0.3893222445515798,0.40047697922705483,0.8860602631737052,0.5573179253559677,0.6407196706495241,0.11414238902998597,0.7183118833786294,0.3007697401902064,0.7467223770179451,0.8978615627180385,0.08763199190855464,0.5692539671056642,0.8958173579704088,0.3441545828971271,0.07301223749019548,0.6241938861934292,0.25292600618853034,0.3016077661220635,0.03868372407118814,0.5848682791015909,0.6878605411213538,0.13709397212334873,0.9200075503263309,0.731919521019479,0.5276844848220633,0.3632617871284538,0.8835206355409185,0.10546815839655033,0.5696813932599151,0.11742404134428008,0.31229301524601205,0.4897999966143607,0.08479725508652014,0.8566006081745848,0.7555712047194254,0.626488709209791,0.16263341141813825,0.9935015268344768,0.06502298201063039,0.33246932310180366,0.7446334158028184,0.9826897304016841,0.5141050637470377,0.3433775859172611,0.13406895329219048,0.21372441850113522,0.763293007491821,0.6218413679065049,0.7319702998480875,0.8656443962182883,0.8049807063652905,0.5559221655030323,0.6947171831174676,0.5600512307079043,0.0679796956051234,0.7140250728185891,0.4730361997577609,0.6389639791499121,0.5394005178988001,0.9407810527060443,0.3205987349065016,0.6230397292148615,0.6242676771991803,0.3580824455518833,0.9484708175497197,0.7576080977067621,0.39843655703703573,0.16833026345637814,0.31436946094927054,0.22074921188583307,0.7168604652412341,0.09269821095777797,0.6492241331039159,0.31429349471903767,0.3509861567253053,0.857367907883503,0.003188003749860391,0.25034743284452265,0.5471302224969972,0.0318052356131181,0.39393872500621974,0.6963055706689077,0.5860181719230045,0.5545923098433635,0.4401290578420838,0.19531652910471609,0.6799024922210557,0.2608745910693725,0.7363822124258993,0.4190007582480392,0.630429815652486,0.11845234610434885,0.2259185502479094,0.8216976927753699,0.8998046676226594,0.8973016534030264,0.5453447875217589,0.479605019582805,0.49263600999792023,0.7643798512358313,0.5982192296939874,0.6366526236304519,0.8272507562745285,0.6004456841589388,0.2601741257472958,0.831120030479633,0.9642104563754644,0.9854974174423475,0.36216030130553356,0.5424010638805393,0.23698887721675232,0.9044249923591741,0.16353820769298888,0.26686381292283423,0.9410544031775543,0.7930231115771441,0.3619244846542362,0.8570343517599198,0.0011928270622660886,0.3009991529909106,0.8962692369339574,0.5456207834376394,0.1279695723828772,0.3798603623264305,0.4740402239839311,0.5182573280034292,0.9383487432420298,0.16151598026173108,0.2158668099221609,0.4132869652661928,0.09912218894198055,0.24615783295670213,0.3412342248521164,0.43062395971672074,0.04542768969290345,0.2810552611902589];
	    let y = vec![0.16784432858245957,0.7299999859061599,0.018644176341844676,0.6278075132718379,0.03699040572116008,0.0465086875442674,0.12215556542878359,0.03354098867805422,0.17074125657191608,0.8383233544379686,0.4362922219873142,0.09574010162289293,0.8986214679067852,0.6605801671168848,0.6967430853680507,0.012257420058708113,0.5150125836485714,0.9364245744910942,0.4336729389868992,0.7846157049405436,0.5639503519012049,0.014020426019336396,0.7438982454578902,0.2344114283648404,0.7402604005596426,0.5494395270447284,0.21760991124523343,0.4162949590742677,0.36439514148807195,0.1393702792252426,0.7578724710811977,0.35307706249969795,0.08278617589913151,0.030791945503360507,0.18491998968988443,0.684435948496567,0.0680722814369662,0.9219704045177466,0.022028731817272496,0.011972166615954127,0.962551165149099,0.22131020523336853,0.7995941548651164,0.7127725610075486,0.03971695591278013,0.05618442739195517,0.49650718708995234,0.31738823823113493,0.22662603267325554,0.6602826374398252,0.34517554074629453,0.9594297114694964,0.12751183045068282,0.7087740583974464,0.66707098206297,0.7766240095318822,0.10937249645233682,0.15159339541619754,0.8956694328479723,0.6425985148048289,0.1395897315061415,0.06256714319041679,0.47697536387965234,0.32175521053090506,0.8342187017186543,0.4078995498990321,0.419459984535964,0.7496422583721523,0.447310303740566,0.15430851381031108,0.4682661372414899,0.9245828999091242,0.8550389552736147,0.39895510948392265,0.4239499095734476,0.1264323775162869,0.4602650132930092,0.4205661963872377,0.12459878597274199,0.5577957912231167,0.9886633611915877,0.14064810844584363,0.10382803451293643,0.9049939613995607,0.14018074325492547,0.09086423982797942,0.24759067848683158,0.5523625015792236,0.8016271559355309,0.6962154716057102,0.4130471821128886,0.0050092539205480735,0.28613699645361235,0.8863574152561089,0.35619307309847636,0.7875731780272363,0.4707834800139702,0.9666604112944237,0.22800860313837779,0.4877686341212617,0.3189701818145799,0.876593138785013,0.5172794691996949,0.17727542972338883,0.6301927191654362,0.3709292523802892,0.8229178634303693,0.05953227049051357,0.39140210798657316,0.5413575565702854,0.3394687545610381,0.1758153181970692,0.06142300612999463,0.3859982067472403,0.36512489170907747,0.27354031060206574,0.4224694834517062,0.5168906922775229,0.24597518876517455,0.2220500625717654,0.9263700272496022,0.8853829117975086,0.5135479688345829,0.26222755730385117,0.558400513202656,0.376803888317391,0.9193293426072808,0.2696029326514925,0.9855669094231629,0.5069611619900847,0.1530590704214012,0.9172990328196694,0.8535725470670458,0.07487018252488808,0.8725646894714255,0.8354751863635543,0.705118105892666,0.6923481006240667,0.3122447512244346,0.06576103664503852,0.08888572241175474,0.7783087603298237,0.38005373598725345,0.6498577381859102,0.44677847818318406,0.30784460582498463,0.4131994854193818,0.9746335976920778,0.0007234883352800203,0.20020899930635971,0.6236896365838279,0.24630821183388907,0.4699219852638957,0.8966219763560013,0.058833321708455566,0.6586464982795993,0.46876334614362736,0.09854771404428408,0.3679535188293348,0.7598674197548465,0.8434907090510737,0.14199105914796217,0.7331329111616877,0.5989382287285894,0.127665142496187,0.991131413925952,0.14485461555310652,0.2205891355047087,0.43662741919441084,0.7376068144806706,0.6600503413389622,0.5182217741928823,0.4283989814339568,0.08594621215977627,0.11537148298883615,0.6753096040562043,0.5848837996889844,0.03197023789516762,0.6124295857890679,0.3838476197986658,0.97259547027548,0.5012208478872702,0.728616545997861,0.7532936425609866,0.3003384000346233,0.10336072495807846,0.5350004787744166,0.835066492928385,0.7884451370880416,0.8602509755511039,0.1467409414548726,0.650791396031372,0.7910802671731341,0.2677487493034245,0.2404942756245061,0.03891148332448857,0.4069839136196093,0.920018742433355,0.8791084572042063,0.23747657766212438];
	    let r : f64 = 0.040022500562514066;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_17() {
	let x = vec![0.006272358462288463,0.4358430536155332,0.20104106252312814,0.017357490877834003,0.9760421770023203,0.5118729866094918,0.9356216149732134,0.9099603040245812,0.0667550156014387,0.6365192989320013,0.5773732480573861,0.2803332063023781,0.5633015733657574,0.6408807048534971,0.6882913254126853,0.42079300821664645,0.4255516025150964,0.7353820046707663,0.3405567006044631,0.34556512665881145,0.6217891929940658,0.6090262457526144,0.8742202152473879,0.6256325742225728,0.7653739085981767,0.09481364318687091,0.9368647592251722,0.9812927120274874,0.274273254499677,0.5357017202365678,0.7450950125333632,0.6332971052142145,0.06477521803130548,0.06413875779746059,0.33781788953284664,0.8935846393992888,0.025259784803090324,0.33193293074184405,0.3736013317802047,0.8615149966087849,0.3667373798225383,0.8208230608958506,0.9730380241848551,0.5007070278567551,0.3070188046114227,0.6433594087226074,0.12909029341903433,0.3978085574300051,0.2290588157138903,0.6648699406229689,0.36382748997897374,0.6781780274571417,0.8848875539120161,0.04669811364381282,0.8868759295722309,0.0560915317319457,0.4691005865236665,0.335490474703235,0.9819829069087164,0.17789632240006192,0.15542019475833757,0.6666283286742924,0.06767520151119832,0.22065345563897587,0.39118956561811735,0.5761465134888029,0.5398784914291395,0.8423153044440791,0.29665011777603434,0.8403688207467975,0.2824661097440353,0.3923180706242805,0.9528482779963293,0.27266064406070667,0.06644447674838905,0.3293734208436314,0.3466524174398239,0.2988769014330075,0.24410306112682467,0.08451957853490799,0.18161868822889593,0.12065546780069658,0.36339136101141334,0.1892189928968654,0.6188543337699504,0.42353592041922683,0.848782292432742,0.6975892400484291,0.07039790827225556,0.27664142450848284,0.44577866434487134,0.6098286062726154,0.6522305609605134,0.36874716120930895,0.6711535051256138,0.6562118141996275,0.4359595239117956,0.9276143510504565,0.999589711073354,0.8812899553439321,0.5277400191973355,0.1340030800938501,0.4026333494188139,0.9282039341060048,0.13877312888516335,0.0998601815063005,0.14847901809775477,0.31541331484253177,0.8517888207377765,0.8821163157046704,0.7051233429587331,0.07481525306836279,0.09424738282695388,0.8736025558028022,0.3652799269254655,0.6577812443386236,0.28350479271006246,0.34135465256039554,0.12277388574923853,0.8813985274068603,0.902309653115845,0.06280280715736386,0.08698949771370335,0.5976159895837764,0.49086162257262944,0.905688969019619,0.5671538764992169,0.75237870372902,0.5510050004586357,0.9264663402473055,0.8926151908044457,0.5485219999867532,0.27758918971929136,0.4143496184705552,0.43334376354800497,0.027347996723884882,0.3819280192509197,0.915326274903394,0.07819282343547207,0.5936494441171167,0.0490490418287125,0.546639342819759,0.06877984260723602,0.05800205253911206,0.9531788345628758,0.6042109273793305,0.06731789588625792,0.6802838006489118,0.701412579275636,0.6044157000431067,0.08127271763958999,0.8077849166047676,0.26446279164250996,0.12132689629838889,0.011755133518638439,0.4470060800435909,0.8648625971468292,0.8290214406587103,0.533749350529135,0.09854012623821917,0.8313414870573563,0.20612808283395712,0.5228101522618983,0.500523552166429,0.1958277662454292,0.8590852968398976,0.783086322589541,0.9458153170084196,0.4832056448699812,0.9754616230548633,0.4374765622171112,0.3354493037055033,0.3847792573453228,0.8419545509036489,0.36261076796457015,0.949218769494266,0.2610426582750329,0.4226483400096699,0.3430684631925306,0.7114541367568971,0.6158865841329657,0.9434739013636207,0.6995170317011322,0.9873634437450148,0.8606905581885215,0.40683220619723337,0.7667117493415853,0.017014521993402698,0.05419794629579067,0.36927462483999085,0.7487237871664874,0.5141901394634623,0.5273324034053525,0.32492007702557035,0.5577045719822196,0.5030094492397719,0.7462906881189113,0.020699922807540294,0.6616062079349863,0.30841084030403276];
	    let y = vec![0.4062699836471436,0.9411099538553408,0.11595938638306325,0.34270233012483653,0.6307031061365048,0.47151294763171836,0.44315971409998145,0.03639506711851215,0.6466360458460395,0.5779197854648236,0.15729880175514077,0.3243598074291636,0.5773654516133194,0.11482446983416617,0.5263106482840878,0.6654021453136105,0.734533823466573,0.2230356320916358,0.07189343412497595,0.44207241127925523,0.357118832041568,0.33449476671821554,0.07745163041370928,0.7088601102064208,0.5681479824230792,0.38726537842669706,0.1796850217746876,0.38031833567431317,0.6179320352535301,0.41140658131082664,0.6310916594357275,0.3421731736317444,0.6028077574393722,0.9816795578891151,0.11134140410089755,0.8980173015112438,0.027039325230534428,0.9669380217340272,0.8614190299871295,0.7437338179638167,0.43917311346161425,0.2885994829590586,0.9090284979229439,0.7829939349247085,0.47815635204356866,0.6195397348433782,0.8835755217800428,0.19760366700682963,0.6804329536704627,0.09913659995782509,0.33087296501622543,0.08495565008246053,0.5953544381428292,0.0658369410174805,0.13671339109304081,0.45302445779942957,0.16401918964246465,0.49056034252697645,0.54626437904125,0.5066915269019361,0.8570707750754908,0.7651659285927356,0.023722702420912678,0.8849509005711877,0.5743359164186015,0.38544583785474595,0.6321916139037119,0.17868542975619306,0.9760372182053308,0.6529714817874765,0.21429555962143443,0.2039679495000667,0.37576072170810493,0.8137375804878934,0.8020869953974081,0.04491839979323342,0.6992964852290722,0.5338395208299004,0.030488620486360807,0.5978989427944211,0.09805570078056758,0.536380064378088,0.4260785724575624,0.4454007368989088,0.2346823357990112,0.6458592754838471,0.42891908523426336,0.4918349950699339,0.02997164024976129,0.5458827011883018,0.27903614588392633,0.5253114549826129,0.12419064612393227,0.9956891609005798,0.8607924662090121,0.6878110932835421,0.5820083060729505,0.9438075330247994,0.9201920569575033,0.6017050539899441,0.8456778328182778,0.6481286635740627,0.04254713363558882,0.6672959115012013,0.23243978149175892,0.08517527386704293,0.9619293921960848,0.7263157320504422,0.5132490272225634,0.6475322959745937,0.48380982119361804,0.9471314013923627,0.18182313243694392,0.8529248456717688,0.21423205586984762,0.021009865340083977,0.35860128180215345,0.07172495890888864,0.04206806634439797,0.031035963862775073,0.36054906852256785,0.13386711159568032,0.16204443307330763,0.3225444226898281,0.6139062642512294,0.5943034855634762,0.07999694972419358,0.35052233374734443,0.41764786097955664,0.24484178768873843,0.3159610500345609,0.4451351528946822,0.7251226393789341,0.6869028907401143,0.43326343177114734,0.2007814858715662,0.4205904638874983,0.5326902430315024,0.2184862507797779,0.12241645828435832,0.7433053609418061,0.9573521836428416,0.3007543293083377,0.39107043605156755,0.4524576210616553,0.8674158783299202,0.7954874930857102,0.46329682670104166,0.5568467623449134,0.9438832756511945,0.8976913939868938,0.40599401696145576,0.1696352703041093,0.5766810899283963,0.9793820909035446,0.5253346483983712,0.48817145096447623,0.9631996047903689,0.4795124214965818,0.46968377054583677,0.6126906242996706,0.44080764948915707,0.3976075614037393,0.5497631666512885,0.8932836599554475,0.3005769043700851,0.3541877494910288,0.9390415715798242,0.7033973870262971,0.36139863141554573,0.8572190356861655,0.8831498123946062,0.2770603303896657,0.8079990441637126,0.9151260112565391,0.7194016832533857,0.7050705335051224,0.562795027593983,0.7368744157085481,0.5129020938273464,0.26701303599205695,0.9461042461091805,0.24973810551108433,0.5008970669552381,0.6682432797150623,0.7288866524929929,0.7820023837364146,0.4230171303136856,0.3007912489910095,0.27569941849663804,0.2154898516802316,0.4194169736597886,0.4703198372146903,0.2257938979702796,0.5805590901184028,0.9846886627240934,0.8805297711946317,0.39924916317753145,0.42145295819988626,0.752787723633499];
	    let r : f64 = 0.05868896722418061;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_18() {
	let x = vec![0.24314438753819212,0.6207557298264703,0.9914580962295778,0.6474047648902643,0.6697993118966377,0.3823208479933716,0.9221498966057877,0.1368749678422665,0.22204627498749885,0.39867963657078254,0.7191831827770762,0.5522696074277513,0.1789035321745962,0.42335462101736454,0.14664121455785173,0.08576142922764451,0.2941908654244926,0.5586715470399074,0.7670545594220315,0.4811043668034901,0.8875094425646437,0.4170360138929847,0.7666387427326169,0.9813359649372567,0.20692583489816674,0.7430606537283025,0.50767941018167,0.35173190478761607,0.8418574859684994,0.7422537172196634,0.23455162049576683,0.5345037970634067,0.7425762782097448,0.4920403871814826,0.3710501030002872,0.5193398005192419,0.5467897865746864,0.8664576722539725,0.4197308563982155,0.2318172511631884,0.1591491787442627,0.711059701886375,0.23771781013642923,0.37081308445794137,0.9314655149339094,0.3430423519860709,0.7442259985010538,0.16041729897443957,0.5409937671421422,0.0826499639543885,0.8180055571922077,0.4657157025262766,0.21266067537853328,0.6039979013945013,0.7856998835995825,0.5434191840550753,0.9099801915961635,0.3787756085022791,0.2505949827581311,0.014296383558072612,0.7803463180282603,0.9805374622396242,0.8603144390098835,0.2881915932240716,0.5490181934577842,0.4574398722496522,0.5438703000537118,0.6618713532544321,0.27048761616446015,0.20245247994969529,0.13098341065825703,0.23271534436060015,0.20397645538371723,0.16177956698713336,0.29423384630849403,0.7487635934795285,0.7464972107940909,0.7124895287133882,0.12578243426852842,0.3982385600695729,0.22058953216889432,0.68453502409075,0.8771709417031153,0.6691567789482677,0.7396233922097578,0.17305523166027126,0.4437160337150985,0.12316595284071663,0.008602921474596403,0.26859389189768834,0.4026828543637405,0.9835059563350834,0.8505876739569755,0.385416447995907,0.10896474030833425,0.7696481622650979,0.16086829434303873,0.6765835775404176,0.8408914021246585,0.48032971087431864,0.2928417036180496,0.054543993210259156,0.6160448914262917,0.7877200468384377,0.22307939311907365,0.5393164575514633,0.7879074714042004,0.9864457557865327,0.9843487581030158,0.1749823498265437,0.579110335295006,0.02069691497860504,0.9276517818007156,0.7603951883764607,0.3710962701606665,0.6329542627676215,0.6263375743385702,0.13286567360485935,0.9102982391667556,0.9188167054779184,0.02887122359802874,0.7417114716571469,0.40090750011055654,0.2866487306886988,0.6034258908295727,0.023998520052181727,0.2799695538821625,0.3144131760038611,0.8175939597685772,0.018869997599329058,0.3530025967550259,0.850451598495842,0.6255639903260546,0.5614281325302996,0.8771212179376516,0.7507146857427826,0.4210954003071855,0.6791824829326181,0.6492128777318372,0.34187342427096157,0.265206310530092,0.3011464320740229,0.4068515653517333,0.7307218888539375,0.4684387101792886,0.45104364193178603,0.6050886297702214,0.27813717226076984,0.7965680201329682,0.3454359064647273,0.6855704325788831,0.8409908716034468,0.9626898025002425,0.3529897407781386,0.8309920306168223,0.640051340163601,0.695793026233604,0.031616613918706515,0.5194204095939818,0.5355048780599548,0.5544306171712406,0.22661716941119903,0.9271765475520557,0.22032956010009297,0.6515641843289268,0.37623063915178967,0.3871145440506709,0.29821308603318997,0.7262640011664084,0.7426912142048026,0.39213315380317504,0.32301067201899447,0.606727978018875,0.15369714508132437,0.4802252582514388,0.6315444874418362,0.4765957208666496,0.022214481364074,0.1568520635786036,0.39026793818589944,0.7815417035159531,0.5787093646527032,0.15573129758000492,0.1935813006058208,0.614999664421902,0.42507518456234783,0.9197468871491125,0.42744851855101296,0.018263324054465513,0.19460387844684512,0.6226071925338003,0.6153467286494633,0.7039074746502233,0.9944827591654597,0.13875561127926117,0.6249537063661295,0.06621046107759421,0.8413981961379426,0.5684553238651419,0.2834640475585697];
	    let y = vec![0.3346361598286265,0.18182083294872842,0.938599938084056,0.4590795856923138,0.995675948937882,0.5678861641429493,0.59991741182329,0.3067672556805118,0.9618351760212617,0.5018513508503328,0.23112148519926312,0.537942404068396,0.39182137211358625,0.53577402546778,0.4119276628956393,0.061560454831948164,0.48302436245772407,0.750312781291548,0.9236846412019319,0.434001102260163,0.4435958529814097,0.03709405965996171,0.3443791860361095,0.47895992413149124,0.5270895847230717,0.6840812908726844,0.18221529768801992,0.9549582698269675,0.6831552296493398,0.3885593795898459,0.4110893609579749,0.2875515213496478,0.16306928306352364,0.21014501680954345,0.5413809737027002,0.5641715407957377,0.3398399306399058,0.22136944404825565,0.1398462590341506,0.6161391240552385,0.2799878349844276,0.2017426181772065,0.20892760779205244,0.40590523317152993,0.4418472682625727,0.15725238166447908,0.874897076163934,0.49123076706311275,0.09820819328915464,0.9021521580780864,0.15123464862604574,0.3401014426720792,0.650067102172663,0.46643997667321446,0.8011798593874306,0.34597057417693977,0.6709828972285654,0.13466049598668728,0.25082393655880686,0.8694104993083491,0.7018101968935344,0.35636751517754917,0.8830974409041967,0.7303213908300388,0.7741119077174738,0.9878430057236411,0.27352487107862067,0.8237361363575958,0.3919020933641908,0.17641196740541387,0.8603485168516412,0.3507812023568184,0.8104372215467436,0.7113339807583275,0.3342367199948302,0.5136256563096353,0.3770147403002956,0.3181330257251843,0.8570526098381509,0.2793279124239,0.42515712326092125,0.8670263700734125,0.12321157152512963,0.0681908418813797,0.22487136844970612,0.8951078891148524,0.8807513930438822,0.13718063350987386,0.8183106259708948,0.6874325517610643,0.5310193682093279,0.01054516033500974,0.7881735324551578,0.8041981445481771,0.9530618378362342,0.05348769596942571,0.09982920058298617,0.3927428258700709,0.8189917878319146,0.06378627139043036,0.1419485762959526,0.49329548656499045,0.18944238096397914,0.18365805412464686,0.6506302800458332,0.1758475361006503,0.9207329070482524,0.5084746711839063,0.7448281274512895,0.718284071088334,0.03404947343001252,0.9459623598929532,0.023738092818190726,0.8927274754654612,0.8679009692709533,0.4683639335859877,0.31316821206913803,0.1432991652279073,0.5175934250038297,0.6485110848509391,0.349245235793078,0.631091689962842,0.1784455904530402,0.2621514913465025,0.1723892700643792,0.21569056355717997,0.9431411370779625,0.1540989021381879,0.7450175666085443,0.692155987620845,0.5842419682512464,0.7190731265808107,0.8284365394338545,0.14978100879165157,0.3260243656516447,0.6087296913848722,0.8584336709442025,0.5384328336256676,0.9917112614103176,0.9513541109715531,0.5574735525514712,0.09315021178398253,0.12068934014558286,0.03171796164429397,0.2913797842782948,0.06971068385809032,0.37427098612479215,0.4079360973368046,0.551239879354818,0.12911198787079903,0.27223091538243505,0.023008035118985193,0.8915449081843188,0.9869215448211678,0.25730310483269625,0.28038315544184367,0.8340791737911603,0.33618290420637986,0.44092231258053016,0.8023978787554523,0.31618664174091904,0.03661932202577434,0.5608114504207794,0.34166286312400895,0.2119391714594081,0.24415354168614944,0.24894830762570908,0.4189896585581888,0.6755817727229152,0.5318369691951987,0.8371862782603193,0.1627827287011192,0.6990779346058487,0.2109358261176585,0.47756671667715866,0.354224811908586,0.12980640084331996,0.6157963088873896,0.8457046502272098,0.4805811318621981,0.5845184719556378,0.41081853704607596,0.39091314987725523,0.6059968727093904,0.8251584144683397,0.9460536327504282,0.0449212906669062,0.9439372906437091,0.6268615598572431,0.9193266890898983,0.9924595202594215,0.8403166780815934,0.7259585143686127,0.6575668228208295,0.4808228117464317,0.5192276647454445,0.6730428469340133,0.21837287514561854,0.7593989857058352,0.26074360492630844];
	    let r : f64 = -0.017434935873396836;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn spearman_float_200_19() {
	let x = vec![0.7425594872222775,0.41731740944182205,0.22270202397401007,0.6597007128983369,0.32762477131761647,0.13250452974884663,0.13895793378221766,0.8199731939328492,0.7165918603268983,0.7654781990720086,0.05644369744927569,0.9484507354199325,0.8881945600314269,0.5218441817588302,0.5794456343016929,0.10432404507660498,0.9723095025295371,0.6749156700880167,0.772728711223346,0.04913413674802214,0.8504227398312793,0.73987610017336,0.4988146851515899,0.13056405097864432,0.6694900752062546,0.48417720262361885,0.10148345649899915,0.10032386894001644,0.8325841569479926,0.29985154567730676,0.2701551258324192,0.1918997415268161,0.0308143601561911,0.9626887200732984,0.49582357310074776,0.4560088293691814,0.9277578636421915,0.3798800652357086,0.5343659544489999,0.6582801162075437,0.9004419714458675,0.769200912280145,0.7785632002104056,0.8283782317055836,0.11431937660663927,0.35054141527507676,0.02388908290476144,0.8189546668604859,0.6445196328723831,0.21194084891480935,0.5692574798364934,0.8951778627075406,0.8963674489790879,0.7357995998931811,0.9342701509558605,0.7187560603417193,0.6281634805523387,0.5708646579003723,0.014109549913825181,0.10199610644513202,0.016529282043096893,0.7410672358925227,0.8458485709538764,0.16335063873691313,0.6022105200902863,0.729217535677664,0.3823992107529308,0.008126026937444686,0.5114529086605278,0.9664364854496611,0.7422650355575959,0.48519665030795656,0.28070358263330375,0.9763538795094926,0.3788823435515034,0.6763427689727518,0.14678850514080277,0.2845874151842547,0.7988221574371669,0.48882279413668595,0.5952450414493015,0.008935249733651451,0.7094970783665117,0.5571768401242378,0.9263581141073887,0.3885499865893095,0.376763545407396,0.5486935696220007,0.16948325370643613,0.8921197042000929,0.9225694316929592,0.9693620134924865,0.4218013636151219,0.24471185647528648,0.7969445369099579,0.5975404370344447,0.7387799103884231,0.33813146800364924,0.042186643428101966,0.6852434596358525,0.8647975483759522,0.9568786615398522,0.28185988190612477,0.9891800409726964,0.9751628008345452,0.8219198792799248,0.15278984647543636,0.0405977315864372,0.654758309596434,0.2769798613420723,0.3341720412301631,0.5965054887149757,0.665483617081571,0.676774716836093,0.34833114501368756,0.4062658258457248,0.8187155765120554,0.04647392351249324,0.012730759028079075,0.9272836140049326,0.42148239678393684,0.7038302590118217,0.49930612188184864,0.8471948031991725,0.47422358779890206,0.026001586603566773,0.3742963759871596,0.4479823733184818,0.4161644306620562,0.3242955942925536,0.5669082434784924,0.37563389728192575,0.33998347315716304,0.4175300187591209,0.6138340470357484,0.4306118285401428,0.860233184488907,0.7762679445352898,0.5429374140307944,0.06431393560659138,0.029874270890368093,0.17823041241773463,0.33109074815147965,0.07735033282748804,0.8871265694483818,0.540109791285673,0.7778787640357252,0.8659610896343517,0.12908636795052975,0.9731453281740375,0.8721015247693062,0.08749550051934263,0.3444840191504124,0.9830444466222558,0.7860028631778018,0.3556703258922004,0.03808520928190151,0.20903483301190195,0.665098505974332,0.5776831969946294,0.979586827576612,0.8769914571024569,0.6810466584601369,0.5913320129781161,0.863345435239541,0.35652773895006784,0.1568382199606213,0.6892212804664801,0.29151314433748066,0.10406461198593242,0.2601105867097254,0.8180591609068425,0.9983097662175434,0.04396046165742673,0.5205409337231891,0.26890027239628767,0.9682696307336539,0.7754730471312286,0.6233693466324763,0.023511114950280132,0.800120839017141,0.14117060557202832,0.5164239567311394,0.06262234522683763,0.07832645787916759,0.9462833195956729,0.9908659846462451,0.6081693388351834,0.2643970038066684,0.8586774991010889,0.3371488435301312,0.3822110550648533,0.16663267413077154,0.67268380604657,0.927562732383976,0.4458095850576046,0.23688198241215608,0.4373977883218848,0.8671488396958358,0.3646172214271147];
	    let y = vec![0.06930368924187658,0.7947248628903131,0.8688688429050052,0.1670435432841807,0.9174215386549263,0.24107516510516147,0.42406280283028586,0.9723232524199271,0.9396074154291186,0.2788082494490731,0.19390138347000818,0.5987234533603178,0.12978628954274485,0.9913722684125026,0.7979268044984503,0.28555178829601935,0.2300366809111547,0.22167306059839098,0.30760129172396056,0.2882004600511703,0.743337268356667,0.8764344858011665,0.673322995987573,0.06506463371006155,0.9223405039134,0.25513594346865576,0.9321740114556987,0.3730877548573719,0.09065149660007488,0.16012843829079182,0.9831797934678383,0.761833756086694,0.3299368452354279,0.8413896567314249,0.36797403081549007,0.29568510883746324,0.5349927416176878,0.7980678953498043,0.11415988512030473,0.06608235425221987,0.20582027510005152,0.08003637077756742,0.2487570872691709,0.00990454417552078,0.14998340346781325,0.19332861921775202,0.25921504857153044,0.9573640095687223,0.24063697608227008,0.3345581889348124,0.13109887301800438,0.08093467681133248,0.873572372869199,0.3657479577345434,0.524870175689368,0.6967046351833504,0.7490031485946144,0.9081462345076927,0.1248752748025368,0.5535516220440633,0.046984393669805335,0.5510997896365067,0.6142176002616273,0.30551857145505723,0.4415529435050902,0.8622091330060803,0.4810641751425744,0.7461431975739087,0.6233247099424718,0.44221745381671707,0.22978509536185177,0.27534328307848543,0.649128201211728,0.2180433348426024,0.8677453257232723,0.6669443077838437,0.5792280493646192,0.39244155617867604,0.5930152312192588,0.0016808402206204276,0.6198248094685108,0.3078287301476179,0.824154491089012,0.8264144698792272,0.5295721819857794,0.7743639392449779,0.5875035791963493,0.6799073125777942,0.8555317405215646,0.37547563663486216,0.8584653817160557,0.1542189036092647,0.40206685073985216,0.055830755939666354,0.1864972230291,0.4032110040431468,0.8644662458175832,0.6613765266723438,0.6561104178967733,0.8976784546710072,0.011196580005873091,0.13109414761861504,0.5635598716789145,0.08113098805207641,0.5804550865462538,0.7519206143660125,0.02053185732513063,0.3228178034823438,0.6472993385208874,0.5988020313638215,0.9515689216932519,0.7610233723234096,0.7161610241398602,0.5927810285768463,0.7542099945290232,0.5416863428133731,0.11437833561671495,0.798915956113876,0.09594386251939313,0.18673849556902167,0.14471554660843822,0.19172754558824034,0.6817526064478586,0.12736112410319333,0.44387305834371715,0.4298355524253602,0.7795681327573464,0.562476391490865,0.395780668034191,0.2094136691936237,0.9366319134173973,0.9139575756933205,0.28716823068216446,0.8555820536299111,0.7321043030243364,0.5925231447695589,0.04186871519116597,0.39605102247564195,0.5948532710886453,0.4351943335034999,0.1747115184114546,0.761818013029588,0.6782155651931642,0.2162728844815648,0.38197464741933596,0.6196726316886211,0.8718117848668879,0.39876673339504287,0.22065262791516727,0.6023215557450088,0.8911111922976603,0.20945150280919522,0.34960497086806663,0.637828925956902,0.5923006160275838,0.9129805794336538,0.7521210330470716,0.7383077097248273,0.6416031329615496,0.2828874810797485,0.6945103924703299,0.5743754232100224,0.0763097138680181,0.04664192154835778,0.757683996102849,0.4887853193816937,0.072406997198738,0.10327060770628949,0.5443350474837895,0.20365937941869505,0.22455645735939345,0.04799938016257288,0.8835592078428514,0.8910355612168844,0.6079707820487421,0.42631837303554954,0.44706911562634244,0.9428472297113105,0.9549398816503727,0.09572715642285112,0.8411159493889472,0.08990769729430681,0.37983810077470326,0.008803510343605603,0.9243708083504713,0.7332717591414465,0.32759935215532354,0.2017660566003946,0.06668136467757702,0.8220426183677823,0.3705722808475217,0.7904089293564037,0.6224944467893309,0.9425550183568963,0.28830042275468915,0.22705357837772955,0.03980821590285055,0.47604167791761876,0.0952535336659267,0.6556461343334001];
	    let r : f64 = 0.05906097652441312;
	    let result = spearmanr(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





#[test]
fn kendall_float_200_0() {
	let x = vec![0.04361843203187099,0.9055664814016466,0.29921761466976027,0.8805560861491213,0.45026451638719645,0.28830048066276226,0.8555149742762584,0.8765620168126458,0.022924466271833643,0.6581456058091942,0.7998954788826295,0.47643375773945973,0.9789223764666686,0.37125468426314867,0.3317075187142249,0.35366899233345306,0.29505504510120173,0.4186617398136855,0.1312396272894173,0.24522654988727177,0.8379700129885751,0.8528877172826945,0.44351619439714796,0.8010192984102414,0.5741056310222469,0.30618043438134435,0.42092172932864436,0.01670088807688186,0.37146547011894104,0.4589090696137168,0.7409319523326121,0.5600826782613948,0.5211814388476832,0.9197721863094966,0.2266690885963777,0.6621411631696995,0.5898413299140862,0.5822819474926173,0.43459012719626466,0.22208391985523468,0.17823607000942787,0.4192716463424281,0.4040733978009424,0.7395897802623492,0.16880261881873793,0.2676986147859479,0.700690417110417,0.40613436349724497,0.6544900533985645,0.29355506735905335,0.34581810059433205,0.4583578879700705,0.6004793276236803,0.7402262968217153,0.42826212709068556,0.44797256599439916,0.3251324657045468,0.9605035834754179,0.34601325249437476,0.8077799243396377,0.5567341989671143,0.020785680050215638,0.0025497259208369094,0.8090187939509674,0.4630215583852507,0.7119015074800561,0.8318810752397255,0.0394451319775353,0.32444618384113577,0.7551597927360576,0.9702179379953987,0.2558940918582643,0.8375829936439453,0.3932070178176035,0.6326166346791412,0.9151670692993429,0.575039227080763,0.9739348926933405,0.06924607154193274,0.2396732382451522,0.5355384430719413,0.7917251637630074,0.09789118725364077,0.7921569185700258,0.5536214681983543,0.3158416443687819,0.7112321873911094,0.42936253116786527,0.06629310579537129,0.7420599831987285,0.12571543855391498,0.09587436614493794,0.35612596781303296,0.7384303498989655,0.7542389254344892,0.6844255627902928,0.5683890760539635,0.37497091863402976,0.7253254842632992,0.575936258615345,0.21707452493357482,0.5567159737754785,0.6034176932801506,0.4240521208317004,0.9199511708718253,0.15203204752820376,0.5211055862573185,0.7701382385066233,0.03510664472477487,0.9164046821830116,0.7518875343285056,0.2121820050636678,0.35867307591229225,0.42523908578541314,0.19135452198590974,0.86344309406068,0.6898905889752449,0.8523686482879924,0.29370048257767656,0.8193844594695713,0.09301034140934072,0.43819195414779044,0.21333879225403385,0.6108094357440281,0.3701079942437079,0.9860934152686037,0.4811770679783174,0.4934638096401016,0.2709599576055701,0.2758762470271241,0.45089001390350336,0.5492318047746897,0.9706881698514283,0.9935950900572069,0.24859636448703992,0.1242204798649128,0.8273114555917077,0.049473216081472926,0.15435021859816556,0.5031834173626217,0.30877067628680344,0.7887028792435928,0.22067123777818753,0.0828459680012531,0.34154060425336685,0.25982998043069083,0.19512298102722392,0.42985813826947405,0.4643594647402819,0.39164920218333577,0.8409997940223717,0.5977711565031134,0.5894066840379356,0.28820131435185015,0.8391608397869494,0.3197968917379327,0.43494691592853685,0.4648052774697743,0.3288316683865161,0.9800102229063663,0.5563852879531017,0.6393258574384602,0.20112390983139983,0.03511923310453935,0.4029073058915592,0.33188912171561213,0.07998838950638931,0.28591666947148575,0.2583854385999169,0.1570150799244825,0.2962381891923541,0.9868032233586943,0.19251085480055363,0.6831355627092992,0.3043095407178996,0.2375204202705239,0.5533841168018399,0.22041351995161607,0.4514891196140929,0.4262218490217584,0.13344844797759847,0.7306840642495027,0.855337433022269,0.35083454862863805,0.5204819327965171,0.6423265981366155,0.44947953267711616,0.7838723381434425,0.5494451191413481,0.43366733543101854,0.2728127511602797,0.2555980242709469,0.38659289505856953,0.04133534252783988,0.6840682898384114,0.40405699079780566,0.6462945284681278,0.9337359120577371,0.9885028626693969,0.15432249298812717];
	    let y = vec![0.7950481295051407,0.2451298274454451,0.7946974721260114,0.8925092412344684,0.48035865866754246,0.06513559532455171,0.7222152361899764,0.5795553881761831,0.8187166967928025,0.8168908299048602,0.5140485771490602,0.7375791576851483,0.9663053437052446,0.37189048672349034,0.07038679506502887,0.9522344263987929,0.6285354377875677,0.7959007079003984,0.7899613590216978,0.6757877992938672,0.07995033428165521,0.0022843476695022513,0.23592351964293456,0.4457179275828159,0.9452928496263516,0.02103791106669528,0.9926518297868903,0.1893395863219297,0.2995757296324225,0.7685359581673195,0.15948218960495775,0.5973070081343957,0.39438049539700937,0.4545822030421801,0.7058972627143453,0.6697881542318713,0.7816444574096718,0.69511904946636,0.023051347388297616,0.17159353989979265,0.49747907209620745,0.2519753375573689,0.6326673707042269,0.5522651774451757,0.6146606583520385,0.8404819878309553,0.3928162224968327,0.5657199116674038,0.5621993531358213,0.12663637045133846,0.648215903865092,0.5509838456368068,0.33140293225230233,0.6734141549366701,0.09447977371658134,0.18301562249880177,0.5129289849794526,0.587099592344675,0.4228222428707795,0.5820160607122717,0.6113475517528102,0.05959526727941589,0.7939188923169713,0.21102127873880094,0.4394195868247094,0.7886865475474851,0.008911304454838787,0.9766439338372864,0.12710561490107652,0.5868238083899989,0.21487639764498556,0.9027879454053055,0.6512065929777078,0.673698922910027,0.5418910415594504,0.2674986606791482,0.32085361883349983,0.25257505971237915,0.9891294179047058,0.46462157016423455,0.5773299606863292,0.6699989458905936,0.9104446688453262,0.4346566408266056,0.025219844709319927,0.31906040810496794,0.409645269185432,0.3598671624755534,0.7991068100819103,0.8177386837428893,0.9384797145976905,0.04666506364200751,0.09911519326381424,0.9164383289180078,0.6506854959933756,0.6782084939761831,0.11212254092191631,0.17610248163978393,0.6400049298496486,0.03630594912662266,0.9580685466459826,0.25174542357266294,0.48631075655445655,0.6032256798729448,0.7535041149620978,0.6698232100480068,0.9634329446710374,0.17553451799344166,0.12042466310064648,0.21055990364884658,0.3914135608907926,0.46511598007767774,0.6959987912495628,0.23131660666719034,0.7894487592212092,0.5442915585161145,0.903200637231645,0.8936144185340881,0.9686931938800181,0.192553193959902,0.7413240636341876,0.9845640376038974,0.07553765954228853,0.3316963532230234,0.504712820701241,0.021857246173214162,0.10531773058783034,0.3154629794686753,0.9437732887279291,0.713140315005093,0.03327976612356198,0.562307409337844,0.10523721236526484,0.6392958393434298,0.064996548172497,0.7712796608758632,0.24228339121808606,0.7547826015423339,0.4555971583673246,0.5239618679029285,0.2691348687413354,0.7247915280639725,0.567402697011018,0.793218632318005,0.8633921279141394,0.5590091905157166,0.6645287744545414,0.6739135844985926,0.01089911433386237,0.028796176959391406,0.26101084896672666,0.49474419082548904,0.04682844741466996,0.3166558751292968,0.8623732247464565,0.9651959602736435,0.9695733563091249,0.8970183809826027,0.6069354297612667,0.27109390177493387,0.4270983083199462,0.6283282970612768,0.08777022615530983,0.7705617305587896,0.7183119316309476,0.9101001559823813,0.2272695174316266,0.3021350671278258,0.2880994222883425,0.4382162254355426,0.21519160156176098,0.34074433044530217,0.3215629952003656,0.7944359653200128,0.7984327573798613,0.1868752049284399,0.9907499827663516,0.35735199526353656,0.021739745957502832,0.19143067590469065,0.6606253151576847,0.7201895028444409,0.13666473614717056,0.351237861406674,0.2568487014965972,0.8962543556909429,0.5366907602076274,0.3584769286825289,0.2750734593195421,0.6199154213140521,0.23007051932513778,0.2963230406803491,0.7674465268983983,0.22667979083643774,0.14367032888752962,0.38161518684223006,0.6058451525699055,0.2051323109652955,0.7076955313711228,0.8290126282213639];
	    let r : f64 = -0.07487437185929648;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_1() {
	let x = vec![0.9820652963425169,0.36865536957766076,0.7311894666106586,0.25417518385646953,0.3408351302807464,0.020955227459354075,0.8960931189285438,0.560395382364439,0.1209575167463971,0.6606935331098717,0.3174079843355616,0.48342153384644704,0.1397851550524708,0.7448444621408298,0.17086804021887403,0.749948966855688,0.310395367660098,0.9373977456039535,0.7772380631277566,0.7854482172221301,0.09675917242768495,0.4861288079478653,0.8662886627167036,0.43989637624782774,0.15886685384635613,0.003356283637059976,0.6322060457902028,0.03841243289109986,0.9261842484410366,0.766865702680658,0.5521229200871348,0.4801154809436836,0.7760499510114647,0.6323341680574298,0.6129703016366039,0.4711517102354317,0.5044699392435779,0.5248686462284029,0.9043632880596815,0.17460762879010705,0.8773184886553259,0.3185955649137565,0.1161650282350507,0.6094049267915157,0.9201691652611242,0.372623358669829,0.840315039333482,0.18047466806159895,0.4747598939884766,0.45027179592811295,0.4819398110201717,0.7219172800457386,0.2280491589596586,0.9677245079144832,0.9685749343603008,0.9365041540593944,0.3741487841358383,0.9488690986215268,0.6521049877587627,0.4598199130952628,0.8097738380300682,0.6409653109778113,0.3567682004608457,0.5154019382486917,0.016933198654679793,0.7636638903953946,0.9826226002626214,0.9956965519807847,0.95255277036334,0.6642114716313489,0.24252378632157778,0.39967485437851524,0.9044860905890029,0.7973674983846043,0.7542160662772012,0.8196386945740232,0.028516501373361147,0.23548320866016204,0.6538472931857603,0.36455012678693066,0.8980070216042352,0.7654116186471347,0.42118303894912945,0.6024976069136108,0.17605562084310988,0.9130813544774109,0.6577809473542418,0.2731518852581495,0.3669016172977,0.7688957731576546,0.025748889030365874,0.035714109203567546,0.31186923711795345,0.643454179513356,0.8048048821051218,0.3117167787280186,0.05219062194215274,0.36852044591761834,0.693044728887622,0.7481405879295169,0.2189469138434329,0.9494284508414014,0.33293704396736423,0.6261890229620539,0.9479350057498752,0.19539799692111337,0.43131654054122015,0.8356535927936214,0.016884296567453494,0.16296321722354423,0.7686129541379236,0.7941736287787718,0.40744002347585195,0.3800889521127926,0.05837137644594348,0.6036515499940177,0.14300690018997853,0.1823670915514659,0.6123148796898796,0.5825361221013554,0.5798927418991945,0.9876629394770425,0.07360733335446445,0.05497964325111737,0.13617725679780468,0.7827699733392486,0.602266860416427,0.5117645992587662,0.2625543983345503,0.8674625745311892,0.17188729551750592,0.6386025693271521,0.9197311764835479,0.6322562669044361,0.8526139066321766,0.36834951900842583,0.9968668983758951,0.632177824434503,0.8071748731690662,0.36314361228934156,0.9787760253199046,0.7549534149732121,0.1075634732202585,0.2390488578194645,0.9568936129696353,0.9720971203625647,0.9388676802275381,0.7706391391307236,0.2839652771499628,0.042575851844465884,0.33611390268523167,0.31937035462121555,0.18304721057318696,0.5968728148915923,0.05242464550796988,0.3256741960933064,0.874109234017422,0.7607598367203854,0.01623349586110212,0.03417540046800305,0.7039116112046678,0.6348406949758522,0.06545365321560137,0.16453825939397848,0.3871650186919542,0.4045583127485669,0.854548255476577,0.5818126114743203,0.6075075218650278,0.8258787184253998,0.8537413543979983,0.6248240221985917,0.7516076137962276,0.22216856313087996,0.3892525480049517,0.045215217782989314,0.3508958683512332,0.7442120863682268,0.45042222959013867,0.5225225368259129,0.22634818917787092,0.17372214846586687,0.5539057133188255,0.24436713187897596,0.2667057850583826,0.8152099416826609,0.3886948893492115,0.1580376257254723,0.9695360040554691,0.45206543542156585,0.633879640723336,0.33013629252743026,0.7567712868022748,0.33075299975908534,0.5211366481898102,0.3403978552919089,0.9311557018177176,0.5779915698830221,0.339845257424224,0.0974421668533626];
	    let y = vec![0.13101247124391358,0.21243290922977187,0.3445237931199461,0.3664464787316485,0.5802384312079307,0.8882999116529953,0.0070367653151369725,0.6710251041032496,0.16563570038281594,0.12674778578365753,0.9438736758604532,0.7333817778056723,0.019505422765244695,0.2374203964935625,0.1312440045964739,0.39701131766753117,0.8954135301623866,0.5581627645247538,0.8768259598331031,0.4087661306864103,0.3347097934292008,0.08027592043872289,0.8456937787187941,0.5974548038730739,0.9156606189682178,0.762412995463393,0.388423939780011,0.7376634685503017,0.60208993174576,0.4023107814932265,0.17082312664559274,0.8336350756161719,0.5500711934231488,0.7429807857994771,0.006223605673615018,0.43089555586306005,0.05048680819026852,0.31846727338434333,0.7314511469492447,0.7199918450423274,0.6762043597189094,0.027140129548895997,0.7655982449919125,0.6854882641044016,0.9980341378513924,0.7411587963033299,0.2239682272069099,0.0017630645107221676,0.999429809291686,0.31135578750698467,0.3836669687787613,0.9777650582587036,0.31500898966248325,0.5574410726920709,0.819014594751742,0.577219063252114,0.1853366663534668,0.5062069065203018,0.4179653283164888,0.2332403082452007,0.9233237584241061,0.6635252888110775,0.8299070036436139,0.9195219734270684,0.965370888691568,0.25280737038124024,0.15427590017497017,0.8027317089710982,0.8971281816990192,0.08290722927455252,0.23427601617837468,0.9132501654516443,0.5508316403916279,0.17782181021607102,0.19998159897346945,0.5146140378661228,0.010121086964666737,0.4368934983881042,0.5584731597869805,0.07698896693942348,0.9678021872315282,0.1498561570607676,0.7869730936974145,0.5381217679977771,0.7929573446053585,0.5125703753480986,0.38807939215124865,0.4744238845904173,0.22539891310564486,0.3743090633044588,0.10649645638510441,0.9347526718057605,0.9549207933406582,0.16636079595873798,0.8949925994057781,0.9151001599828226,0.14896680214440017,0.9361445125802695,0.767107519279079,0.4067382343969632,0.047222759090675526,0.5344023136123855,0.5148583558689966,0.6349890001578422,0.15467936305156393,0.23667417352234343,0.7164795500459623,0.0875034422020371,0.3426370343805276,0.00829646400162709,0.8530691833173597,0.7274418683031325,0.42043678843228216,0.3933069756916463,0.01764442695828261,0.47135575989323963,0.9784038329055886,0.9416958838356257,0.21067668894522262,0.3150952075011525,0.41613907210707124,0.896504484844618,0.8427459093391019,0.8173663132542411,0.7685858842034216,0.961922360303637,0.5797860209457673,0.5904461847924686,0.6508572263180953,0.8521027791966774,0.34095583530662454,0.4848383777545312,0.48637896948455095,0.9898455687510106,0.5416381024526385,0.300402582429948,0.8746583495374577,0.6497148139493516,0.5363664126827433,0.15765910433297803,0.13144607077343373,0.8761739199748526,0.3220331731442966,0.9022311310744419,0.47651379536098926,0.16397512779969436,0.4420798354324542,0.31059254522440205,0.8004663029887136,0.11259699708366133,0.7481446238725059,0.14549157132681256,0.4633536400575581,0.7754593503349052,0.5437515509340538,0.5989526581665944,0.1379847896111508,0.2411883331822956,0.21628170897635712,0.16048072979542427,0.5445029053069473,0.03541578279012858,0.9746659047442406,0.8543675252010597,0.3511864375473861,0.06655142964731697,0.34565287598940686,0.628938318981942,0.8296312586461925,0.15346884183685416,0.8033243047446993,0.7756151265239093,0.03728863388592718,0.6908774089127985,0.30559981256886537,0.2579059892994965,0.7862485025801358,0.8006006469506134,0.4861190900710808,0.5352577879771143,0.19110563777879974,0.19468598672924975,0.2221117125654808,0.8216258124437097,0.7213229401575758,0.45842541731383146,0.33989365903881263,0.8428991007872931,0.4720521387157921,0.8321214458326205,0.6963077930266355,0.9313464342419555,0.9518173544918691,0.3759195757091449,0.9939914116454537,0.8537953294151993,0.2267733993404768,0.7172331582076128,0.3235604488252216,0.6064357950758144];
	    let r : f64 = 0.009246231155778894;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_2() {
	let x = vec![0.4193003830233035,0.30630490001787636,0.551985302867196,0.7408680493978147,0.7211362647554453,0.0010109036658882964,0.6132128041085486,0.21116568999947882,0.6577915144685814,0.5649762700196981,0.5632749148530193,0.08610969630305632,0.9339812290524043,0.149963497705342,0.18504352434848736,0.3186503109685398,0.35945458994698043,0.734606396599013,0.3314103623497008,0.45868401660717373,0.8510827948300421,0.38129747418348947,0.982010922783146,0.7335838343461986,0.5505858334431181,0.4286348966095568,0.6306163083829134,0.41852926274822955,0.06901842829978666,0.9826326418794161,0.453587490484319,0.2444188756650194,0.47542604980289527,0.5669859161205162,0.03796810682048468,0.14620589399682404,0.759562322631167,0.45031255494923583,0.29204806133707506,0.1993319560805018,0.6434385265872493,0.07069164546311824,0.2766194489501663,0.6851527593200989,0.623060675161019,0.18531213555428983,0.0705199515213355,0.851211937943307,0.3770336198274008,0.4751056909764393,0.12987972998204622,0.7602243669273481,0.028968577982816823,0.5745855619893931,0.05657921140065203,0.644079059997215,0.2391815429899169,0.38317820476660613,0.8106773472304414,0.5569205892941415,0.9671324710323265,0.20015961403494942,0.15540074132793003,0.08901653491116313,0.8640470969321165,0.2250073630548708,0.861193470417003,0.2583278105985862,0.6008251162089262,0.976377425769144,0.13094725866831958,0.1279568460275734,0.14392315170750536,0.6439287880488703,0.25076415002192964,0.13925031775382102,0.7508738702320851,0.9656101324333652,0.8713837967648846,0.31907531343341733,0.5481625175978306,0.10111015726337313,0.7110704117285797,0.8141802609834826,0.8285322080192983,0.5058812715211132,0.08983496356454157,0.8732343712740274,0.8145499598295027,0.46895184518271993,0.9724397577986966,0.8747175528105223,0.14054000686593038,0.829145192460048,0.5402385614948749,0.38063539429829385,0.9218316331023727,0.19789532694184675,0.2533770980267477,0.9377794526525792,0.258758709557698,0.6722664444991785,0.3637514193043174,0.2146677835590548,0.5387984381887859,0.20934764454528387,0.9650091403255886,0.26041660382853615,0.9914393542360806,0.9525293074765224,0.5227180663815403,0.2642159005247182,0.3127498925608613,0.5012020669347341,0.8088603731005819,0.04322199323784459,0.8391248573395634,0.7851320279863065,0.23675950901248077,0.6884483542258324,0.3890240857922147,0.3399169794980761,0.906819766850758,0.24670455489709886,0.1433620055627527,0.384138568181986,0.4891678938205295,0.4958595602709388,0.5994945633256292,0.20730294159512042,0.6143991602173163,0.4603134820091779,0.958371417213197,0.3353597273182509,0.1877532066961327,0.9863018184302204,0.6243541568498773,0.8871369487481862,0.8709529220790024,0.2827102175223789,0.8736126240005174,0.9282751301088095,0.5850022800969629,0.8531782370901123,0.6151538241059572,0.18058298342653112,0.47265264975029786,0.014997731660904567,0.6243943905838945,0.9018208012875025,0.8298568261038608,0.693243005226331,0.8759051383027385,0.8806042851553036,0.9842440597781722,0.07505557589539114,0.8713927935903409,0.026558483711225267,0.19929342281567497,0.25781349827035205,0.8512396209506005,0.29392459561313067,0.022815388981901497,0.7481386153671747,0.8423662498889751,0.7354256019801866,0.3056274227432566,0.10106935035536235,0.1300354721594431,0.8336541395036412,0.8825332992595734,0.4822856120696978,0.8665032385065726,0.7153386739915499,0.5714054477332073,0.9951397130485148,0.3114083471978619,0.38668957105382773,0.6571280011417989,0.23710572044214595,0.9805473774320065,0.6176305404575511,0.8834592599857826,0.5456812011262431,0.4467010531090786,0.0018037814035949395,0.25929229606692117,0.26486414895693244,0.14543266054811965,0.2775242882797979,0.7168615177105196,0.74138330430734,0.8466802807452609,0.8614375501368366,0.1256586965056522,0.5806967810771235,0.5385597306121417,0.20798210132152017,0.7983928970103567,0.5093518347575493];
	    let y = vec![0.09572433004171388,0.6347895151219787,0.5991361431657671,0.7173077947197111,0.6179116985200225,0.2537007816046244,0.02421881792650238,0.9226276140765365,0.5688817500017277,0.45619558489532686,0.03008507945423955,0.3122253268152667,0.2509567714300287,0.6686790449518316,0.7327165593133685,0.5481657230537553,0.871181660950032,0.615239743272876,0.4571018994528311,0.5275866159806313,0.19602401049710094,0.14436627422745096,0.14231815309421125,0.3424182384383244,0.4003104476531697,0.7163949149507829,0.2710030191725391,0.08998462727154122,0.44463328482762565,0.5395072427054607,0.9457214237968978,0.6358365768577464,0.4210628968418786,0.7894658982019499,0.7773358432297065,0.3485568958351156,0.9682279858860258,0.3980243491957919,0.08877043900921144,0.9380067689749916,0.2306686796448687,0.9562895860725356,0.6419746074697792,0.62965123127694,0.5777139262173426,0.5582227980051143,0.3401416247617516,0.3710465859228649,0.7722238436252151,0.262701545031483,0.3536279233835927,0.8083059321473475,0.8689222065537164,0.02466368977473421,0.6204028640751974,0.81592949280332,0.0355799011246124,0.48356078189314156,0.5756155257325123,0.7800114040537945,0.1451452762545664,0.8654584984638504,0.3138845523312721,0.494501426555635,0.9975447489558836,0.27905403062361656,0.5428236693965097,0.948377624807327,0.3896309975734904,0.9307227339137332,0.20657337231084294,0.44197356381100783,0.7378030286434273,0.16162978772129233,0.6294271276674117,0.07364672825057761,0.2101783159672217,0.09900105167776363,0.259388585269582,0.5234961904822809,0.150065303322931,0.11971611920844838,0.33296986534791473,0.16146579983820009,0.7972187445305805,0.9161268165555968,0.39324873326488663,0.24222458717744622,0.3580577453495116,0.14987744988696006,0.8442388743556232,0.9362018432198409,0.007784714821654437,0.41718384510010764,0.10961642632600299,0.3766687275702739,0.9289713438796265,0.8282880160456223,0.7046899296967023,0.27860068974793406,0.6643442459432014,0.9053473527422502,0.8355148258236973,0.5260696288062858,0.33288220762845944,0.3053823974958607,0.48768952537259846,0.2946506399716662,0.7065548910930166,0.6424893551392334,0.4639810750761415,0.7824580463853069,0.7304364774044202,0.5440026121705674,0.6493742443394039,0.28359668178846487,0.07004145501666525,0.4100497842020212,0.4952763507226656,0.33494485917784833,0.5231149561748591,0.004916474957590511,0.10036615469424826,0.5877764187821736,0.9505361541631884,0.41570760605711965,0.7559275584470017,0.07334850295934026,0.15619984059086656,0.3324305355768423,0.34531346267692065,0.05093382713646921,0.7875838042082707,0.5129119147379377,0.3366666883738142,0.8069924767709638,0.9084831592311335,0.4180593199865099,0.5355972156571108,0.3646112873319055,0.40835327979651936,0.36521752131540897,0.6432182220957396,0.5223851927687982,0.7370299224767565,0.3745100578248277,0.011688950120596009,0.22199452289381183,0.2095145416171288,0.054277541370265525,0.27516284721980033,0.5892528307783005,0.47377214694017444,0.6994645426501861,0.2684744729234292,0.029753008527243496,0.4561495899536524,0.509203553249888,0.8481513402410951,0.6678454409433389,0.39510642766167936,0.8555250056619463,0.7765158337690822,0.7995603971803709,0.5087709159298425,0.8484620538203638,0.4408640187769508,0.07001994626199504,0.6005123845114537,0.0592411010414029,0.5873414182029253,0.1069095436115528,0.029987033979830824,0.7386830062343772,0.23207328786015124,0.018042886300130845,0.42627287057294205,0.7408870400616933,0.9025892321797877,0.9671578127328563,0.6243989733902893,0.6746265245488849,0.9681563828259256,0.36972452590785343,0.5319151630067036,0.8941913849626627,0.7718762619060106,0.3800924176871213,0.38961691914433694,0.12374510929372717,0.6561494584712037,0.06555302235667082,0.14159789592783045,0.996858431422206,0.1261318803978757,0.05401717208372914,0.9923789136976304,0.6282256314806848,0.9099762668855066,0.287461560212262];
	    let r : f64 = -0.00964824120603015;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_3() {
	let x = vec![0.42649046335303986,0.5805375774242404,0.14889711403019712,0.9161677964863431,0.17554586262412508,0.17018626323056407,0.3053263748991212,0.5823480108380475,0.3442084671759028,0.5892181714001089,0.7295093314908622,0.28653993744209605,0.3892216879442453,0.7194347958758609,0.1470491663829091,0.025858167282793998,0.8694262780689727,0.5835227532318468,0.8086362888653027,0.8384939202977711,0.8938856248345055,0.6003841342557638,0.38671921050721547,0.8512511781575902,0.38038040383330507,0.5901991924202504,0.8760755378529452,0.38615964644671985,0.6226910103530818,0.44227349064501176,0.7241383537428752,0.5370781531090177,0.39516772683749424,0.571474710820239,0.7142430387983486,0.1752669164111741,0.9224885661209883,0.40660383968580394,0.045376845518398046,0.1193850282086415,0.8392738460895017,0.8158365645462967,0.9550244135832631,0.5499304230608129,0.7138005252521987,0.36110148900360384,0.8351369032539816,0.2326405932009844,0.7341014950984902,0.9287748348632329,0.8240730101276625,0.9199981476357733,0.065294970534164,0.4593720131943576,0.9848370166490995,0.28868843637971764,0.3816490013054199,0.5273005110078252,0.4318598618037145,0.31687017932700035,0.2076319538216388,0.19309322063054846,0.8290737745618927,0.4635863201564201,0.9557750833827121,0.9948198980446246,0.9839321171296113,0.4669007081655171,0.9868933145037728,0.5201623649300828,0.31062049304736905,0.49144005829656123,0.40229877322787233,0.9511719420894899,0.034187333009898735,0.6337532354021324,0.2678137684249633,0.3894329889293595,0.009230682864792672,0.8270816961010276,0.8280377188399444,0.5391280033151538,0.5197866744665935,0.5272297466368214,0.30899953114513634,0.6115183818750348,0.876830922023722,0.2867894293595017,0.33787794032860907,0.5191796869282949,0.2163323417614409,0.589169933574554,0.41769891712575313,0.7853369771484466,0.04115988707712015,0.02244582922370919,0.6156911928571219,0.7218468641416557,0.9464788613319134,0.6042086769542834,0.3469735814941014,0.21146564117923716,0.5607462608000291,0.279763867576336,0.38606267131245176,0.9030176372587246,0.3204788662440796,0.5614792624927002,0.23490932391364527,0.58744409326488,0.9147700969416939,0.6026674993133889,0.933725583459143,0.5945829905157266,0.18107359031550263,0.3015867338248216,0.5341394637214892,0.7972009137318704,0.007522646276300837,0.3586808680923561,0.08469521864112184,0.38312327175331184,0.7345702112316985,0.32277447675949433,0.9354147059031912,0.4134065024044342,0.3750517120889908,0.9880294021223145,0.3610541356859075,0.797971090787222,0.9754108122087909,0.5352627975007729,0.7133534028420577,0.15160107857283567,0.4183432082311397,0.8110616718190611,0.05206605926060803,0.672761498966902,0.4916977573818657,0.4510759298506355,0.43548380374231466,0.08891942903867966,0.07618830298513624,0.8896295097035691,0.3571056346174023,0.9767089478086595,0.0306521150943736,0.5777182598233042,0.4666105735745615,0.22887244435757015,0.37643423812181553,0.9940752351392903,0.06583555319240597,0.44894281065387553,0.9821565449312688,0.3394954676819636,0.05890712042052859,0.23440703254428497,0.8473897713829779,0.1815493483236179,0.18890970315846334,0.8010473003611672,0.4717465921862146,0.4990648781657109,0.7283084514515905,0.5549593483664236,0.48205667729931345,0.6892063716663682,0.5749974380126726,0.18844753565139905,0.6671620160370266,0.26489795498337443,0.7840670595316463,0.38303472387087234,0.9200391354158434,0.008113609433010094,0.5844103716455783,0.11723373553231764,0.16859480830587592,0.16479609111068483,0.4725880105663287,0.45117560560168757,0.30112750644407393,0.8130601996941589,0.8654319871917646,0.22242734666699693,0.2520736259604087,0.23773539431434798,0.30384057201573533,0.886888446053813,0.9816962785646889,0.17590432971893122,0.5488619190483053,0.7223274821812338,0.3335552958376812,0.04333348259218339,0.8976675148094696,0.6882391413969118,0.27357416353982256,0.4832154409368804];
	    let y = vec![0.6362762684476931,0.5704627636605862,0.9413755819779018,0.693077497983365,0.32718666688524434,0.800064408412596,0.8633535872018366,0.3860168834880414,0.4398876739919385,0.08445327640554334,0.5435134814161787,0.27198240340786917,0.2322801530696862,0.46848408862808233,0.5228029968341843,0.7160014831400283,0.7351211691309073,0.778479754620306,0.8080400643220416,0.8418204609573368,0.6656481234520689,0.058049540343164785,0.8591976495569853,0.4497283191644247,0.13355998428300375,0.30609011763863614,0.02864731823323685,0.6116232211951247,0.11151781433464325,0.615899344694626,0.5802320513672108,0.05870164789097099,0.7125232765556284,0.8093006406604099,0.39691060794881095,0.3323191690749243,0.8276411949129269,0.44828352284141637,0.3970862233215786,0.194882338144991,0.6382012055863654,0.9178413724204271,0.9369633683677548,0.6102923364480497,0.31829311908158486,0.37744822167980907,0.16263095179452292,0.148724760809535,0.8722881858298934,0.8726489363955845,0.9004781505535633,0.1239777971484961,0.24941340171470905,0.621642000420279,0.9739020845961235,0.37153216833035185,0.3077565991297493,0.470363772350357,0.9418147543854245,0.2143916035931719,0.9555289531211428,0.18889946397610602,0.6531332895420163,0.428601009919236,0.8878440263127676,0.2971634018379593,0.8620442206034297,0.31930102795274784,0.14518233267558,0.9632573740848023,0.3186426340679961,0.25070755708730197,0.08289517735230079,0.8162335265324557,0.5809663313102045,0.43072088981655055,0.65611182988418,0.5644161260615213,0.46308684497170916,0.5502331795146438,0.3149506671756478,0.10445468535285296,0.8097317817084507,0.48772224039657464,0.8518196035026698,0.37520250777043007,0.2617090359451215,0.7622555455116976,0.11352315683405767,0.5662189255680742,0.1880364108361856,0.15856486959173655,0.901866580374954,0.17804641088313278,0.16671613030976817,0.029974357851098032,0.9632141130896478,0.5082620490462142,0.4329747878372253,0.7310857804481778,0.8227441993899915,0.27187534250933787,0.4042307351264155,0.7067699184237944,0.3172475247118711,0.48024862795357004,0.07892301115424039,0.9893827700841937,0.7098122629299745,0.8121714402649661,0.6262523751535161,0.7415731516793654,0.4059411393735197,0.16302735268403712,0.8142725005774667,0.5325129065031702,0.12948835929701308,0.10298584963233559,0.358339352581055,0.6141319271254401,0.5560539147451078,0.4815282716559447,0.3557295114840322,0.6824285187857918,0.995499252580675,0.5250796381752681,0.03784620619690404,0.16743056792024336,0.10658570426662728,0.15858928089633695,0.9898619417340867,0.3945799958481926,0.74720008648399,0.9208813909347389,0.866957609976303,0.10113568765338499,0.14698648111678048,0.7994543948733307,0.16468004816782833,0.27083204194175103,0.21404878056733523,0.4294320134026399,0.04610074057413238,0.9970894843466437,0.7773458858328889,0.6831581443013558,0.8072229336213718,0.9609211810810712,0.43869009344908894,0.2500376122251037,0.663162535074978,0.2520750724931542,0.7597427835035552,0.8090749204184886,0.34459834693160996,0.7922600530348385,0.8677296602966597,0.8634818348350779,0.6311028739364796,0.9565110720061226,0.544145875922658,0.1465632191174686,0.7586029364206083,0.5636334724664979,0.9651124959768282,0.009285563008625819,0.21383310081163354,0.31465343930224177,0.30761816416311183,0.10851663653713017,0.7733598990303647,0.23845783502750173,0.04234002083969679,0.13661376738200237,0.4638625514993976,0.670745043789952,0.932350831993414,0.13925440648999798,0.6504860100119279,0.09589637618725577,0.9654455291868544,0.11172585714507788,0.7579279072802819,0.27938365323827763,0.9379391059584449,0.2324370857220136,0.9040709290886075,0.5233740071828078,0.20646858248378186,0.4361772697691557,0.5538438284896265,0.4357314147047864,0.3700164396024128,0.5904589245715169,0.8148473509893251,0.2847127715032284,0.041813936081484204,0.16080038499494875,0.24891817660543503,0.7521213878253674];
	    let r : f64 = 0.056783919597989944;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_4() {
	let x = vec![0.5475107014242041,0.16059085272472784,0.5269684398327404,0.9513314958610208,0.7079569148043733,0.050115064792541575,0.9260452588243292,0.23487642492027272,0.23963747152741477,0.6219551389303775,0.9955022491902187,0.663871680636151,0.4095344655381147,0.03678383507767824,0.6360286882389007,0.14096427185338523,0.19794659879627996,0.5258468533322459,0.04883074145465405,0.9874325628041719,0.9414656393557961,0.3975745348646875,0.725405677726342,0.8330125926201443,0.6397298530990203,0.14994953623613405,0.36629601041664406,0.7229391956027656,0.48427690064972295,0.6651876746039128,0.5818760957303072,0.38004490196617713,0.641457330935027,0.7471284602617293,0.13958593796901753,0.5455845895482845,0.5571054572012364,0.02804664231248577,0.3747830375793113,0.7159217896932827,0.1684277303960917,0.9275477556381142,0.9458754639225062,0.7390112488504662,0.7576178328705727,0.2964730366954952,0.30448965865315236,0.360327058360322,0.9699573012281113,0.9241428641750206,0.9521832896812358,0.8225033422483562,0.2526037672509891,0.797224277151345,0.49175963242250165,0.28319559213900214,0.3876715319031866,0.6728328064675009,0.6235801610581467,0.09738739974485933,0.3321080109838569,0.8216886698770467,0.7855473758484087,0.43890219283022736,0.6656736206964552,0.3591110626718923,0.513478996738449,0.9906300514030385,0.4890822275737331,0.9110252505920154,0.32970527369473634,0.47525244087821594,0.35005145041070007,0.5151032465943451,0.2728776770144683,0.44653813577724155,0.8397285388914408,0.7342083558665168,0.40902642594089056,0.4679172517962218,0.2775571248311409,0.20517652450540713,0.2061627256732257,0.31857278457236726,0.6227127642005175,0.21363476824157213,0.3654083460945381,0.8923268065650122,0.4318792531257317,0.5568232662024682,0.1907983378459488,0.0012428785520359753,0.6598344344534492,0.46741424432591383,0.9448977735886153,0.2664493732506902,0.01125374552721814,0.4430657643404522,0.054481151330442734,0.6189154218780363,0.02563662062516381,0.7314528560582336,0.043081241168606565,0.6885686922811185,0.022229102998040817,0.3302523416547881,0.4377902166015517,0.6869738126603083,0.4102292631607871,0.9340741775249329,0.8153110404285002,0.6038200636872237,0.6415666483096137,0.6602465519955449,0.8279081733833606,0.6212683473370837,0.016123602362648648,0.42912732632029904,0.41758542749422933,0.8516652889706289,0.4552475441448567,0.6077073644135764,0.8863617094301428,0.35881878497953834,0.8180822139666701,0.6440589904166099,0.16992196754080657,0.4063952427253644,0.12457975659188747,0.6261791073774232,0.9527186348257134,0.11810092832455732,0.6278571040363253,0.23367363452335543,0.14729765627855707,0.7967105195092117,0.8378009427978951,0.5659615725983815,0.7475451905520389,0.9261853574073308,0.04358929108708165,0.5452114871074804,0.9390208876619998,0.4424299381982566,0.8724666679193411,0.051697246818351084,0.25988342685447186,0.8295327220684411,0.7060616905731094,0.013695725254794122,0.17424310780876073,0.7321659824645158,0.33944581737361257,0.25146608958381833,0.6910267715127829,0.01491766059907218,0.30610077198685426,0.23539078029771976,0.4678828729920568,0.8408905808231455,0.41621312664057786,0.8015267378952567,0.06721551275924675,0.5426810116209879,0.12878505545391872,0.3456919709428714,0.9477401616040478,0.7113034880340986,0.3260877979799516,0.11585650203693132,0.017732310870121504,0.820660251939906,0.018841944610102912,0.1297313305573784,0.7838395270468237,0.6454207574765845,0.4947961214287262,0.8202933913874366,0.4085350127521068,0.037425507923437906,0.29972701228619847,0.5825450953729882,0.8029471187632092,0.7569312713614768,0.5671594531882593,0.8621188235449425,0.015563930854241126,0.5932248613924233,0.5851651098740559,0.032583554869881626,0.38107311809691713,0.8821005287201233,0.5613287037744398,0.23696593292578627,0.7215972504609456,0.9206117877123187,0.8858341255804555,0.695949533551946,0.945189230506554,0.7734137007659873];
	    let y = vec![0.10834740403513987,0.34755948496737454,0.3198080382709988,0.37273848009319666,0.9747396798374598,0.19230537385088387,0.5131125498380464,0.8651061010552163,0.7408156673354178,0.6732630450435361,0.19422621206103807,0.8369852542697704,0.382152684244943,0.21957920020096133,0.8042564766130856,0.3785367265028029,0.1299403279364041,0.6806623528285914,0.9770617999502036,0.6535679909759273,0.33343047846309204,0.29143134289611905,0.49711497246358527,0.07664652084593748,0.04509227670651561,0.6120180065812768,0.1550911058150536,0.040296614226669414,0.005287159283209331,0.8054819268280285,0.5452784090557258,0.9724028563551174,0.736322656671782,0.4598686273751088,0.4604031524416726,0.845940062371932,0.4259703951829762,0.8071809537536363,0.30369910707523606,0.12010483488313584,0.5702238193548698,0.87464403062306,0.41672605432360554,0.06486178060071424,0.15167140315799243,0.5060246921987694,0.9335945267649207,0.9169934336947505,0.6867753404719096,0.2292103811777494,0.7216885205682088,0.3627286997810055,0.4190388137456993,0.27646376327695543,0.851896876786622,0.5121744355319149,0.8992989689255334,0.0385287942942657,0.2988894816349874,0.9512712153534058,0.35056553930223744,0.7709387739500128,0.651277786078456,0.10433923898625175,0.3857455998389192,0.1685756285996579,0.6794569926788753,0.6050008956108359,0.3651389119653615,0.1057311250534716,0.5014968903971098,0.4329033074317835,0.7373022584631921,0.13933719013181944,0.20093235290336064,0.9079516287337422,0.9035757316811268,0.7107320157121642,0.34811677723586887,0.2640386184943173,0.655492908516477,0.5404167722872798,0.3063967861290462,0.7303783121267399,0.5662677145000241,0.02082880027144529,0.7535623819098967,0.32653362728115976,0.16687292445613588,0.4382469154447456,0.6810293763341915,0.7038311419940732,0.5819365529601856,0.8992916255950691,0.7906897311075427,0.9262814692126969,0.13561777567054278,0.12332354577404714,0.5127407171827956,0.15336467025553735,0.770572208055395,0.761215736048151,0.04852202909991121,0.32408688529645624,0.48707561820915246,0.373994730371106,0.5797918764224185,0.2622986505260795,0.8325889082787078,0.7959609179142871,0.9217312615510507,0.42439175956904884,0.7858468866661612,0.043354382699123506,0.7636935140170561,0.46110884181496403,0.4123249363840634,0.9573070002467353,0.08341193781825229,0.725694259349298,0.22434665603765247,0.532417575492694,0.5681332395335631,0.9720020740873715,0.2581138522172055,0.5895777494238656,0.2240704502099634,0.37441015859936655,0.6495168657476652,0.34021260259603736,0.8059858577113155,0.8913022124543812,0.08470331652670793,0.9926323336010371,0.10724209083711456,0.007815659073690862,0.061793360063737146,0.416301244501575,0.9232835759770311,0.49272267946252524,0.19282608991959982,0.7546845729063829,0.5547873362790197,0.07130592918641143,0.1345563784388455,0.9174417498769464,0.5085597622129049,0.43879711640357943,0.6327886957841568,0.491263356083958,0.2281389875980272,0.5569781172964526,0.18016939546145117,0.5635923616078627,0.5996475432639783,0.09661745030676139,0.07742214730821584,0.6759014380595268,0.4904808907354724,0.13166535882842056,0.08570623986393189,0.8055780609926884,0.2712808011678358,0.6791136550776229,0.06350540956264095,0.8966904746673844,0.14826411571059983,0.6498605511635879,0.3781959695239221,0.3001652407533669,0.8935803630048096,0.621098222556665,0.3442846896380978,0.7162162144337076,0.3694662464235854,0.5408061351278077,0.8236290667545932,0.043194837542125386,0.6399908486517076,0.06885230085023597,0.19075797763416857,0.5054753727629369,0.4643818943287419,0.6215933925094954,0.8540063049994232,0.9352226553135723,0.6980169925328219,0.9848032466289124,0.29881326520090823,0.7775559362347241,0.6196269699012794,0.5629576380297153,0.491392115217392,0.24098846022510245,0.5818275510082512,0.7752557319476385,0.7219402933555952,0.34681153345573323,0.9389103149053671,0.0983302053894548];
	    let r : f64 = 0.014070351758793969;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_5() {
	let x = vec![0.9693551253762956,0.5540681905381656,0.7245609070624087,0.8729916521743302,0.26174968596007786,0.4236099286205851,0.9833892736368676,0.8932759939318179,0.5886578067259479,0.2548817582597369,0.232621839354191,0.010675556309502454,0.2395017056669796,0.947289168060818,0.6199344001443494,0.3800476993444447,0.12586102346877692,0.7888197425471771,0.8215706895448879,0.7814186636818851,0.6018320906471059,0.6580542536812538,0.3027275115589714,0.5203758486188756,0.49294965699227355,0.1726972125849605,0.48706339092111595,0.3700724172998836,0.046835287046017804,0.12732470853499445,0.23921297404530428,0.5162369944976674,0.05714499133010842,0.15873797984762905,0.7564796533457073,0.38191376073929906,0.28476659555089046,0.7999333758505391,0.9736872651919408,0.017813732345824396,0.6713366451842877,0.3746993394038385,0.1838756587435072,0.85418750275886,0.4275175756700915,0.4475259365873381,0.383393206415533,0.4216895256956599,0.12450534702347438,0.7030111686775781,0.2724268875719249,0.6975676257118052,0.7960710146887201,0.7369834589002366,0.18951284295924897,0.380524481954727,0.25880276020199977,0.31778082570023003,0.9413468640945305,0.5919570321712154,0.3878603665685658,0.2783810428561243,0.6963864561963535,0.5801636563595066,0.022524977833754845,0.41182383551170365,0.9349176795175803,0.4795517847168971,0.07671139806388916,0.11406333213404019,0.2382008524308341,0.3063796996344944,0.4217774296719782,0.3093609402702622,0.9699267455173161,0.7286033494953443,0.5629584200512243,0.12658763385548033,0.9174628418647879,0.7092400004621378,0.07653007396916645,0.9077851184455421,0.31693195467582536,0.5438780555925844,0.7035724533675041,0.31003381601754854,0.22519793381366926,0.25341538445423273,0.22143158011411512,0.7432419548921938,0.2006995861454316,0.22907045399920134,0.46687375066950176,0.12103573646599497,0.11349739941382642,0.7501551824788252,0.7444906551512013,0.896504492419049,0.2517491202076124,0.893014935975353,0.6590055852266238,0.033496754670722884,0.8024711727541786,0.23607489839511786,0.040135130828109156,0.007030938164616751,0.899157164327117,0.00014493347391930644,0.1657241767101736,0.3445670041455354,0.8945854751538215,0.35226327619323117,0.5051347353310308,0.1163988503038984,0.8341898221576124,0.9032667054079286,0.9255915231907702,0.8924485581033601,0.3480032287430428,0.586472168169031,0.7186388755535402,0.04423247988806711,0.43045784529614983,0.025200272135119772,0.17749524285362817,0.6342396815595673,0.5430815402538115,0.40816169490504495,0.07729128574610045,0.25675565243047327,0.5456640504244251,0.9588475829382757,0.7051651894607104,0.23499041040451307,0.8796541069109728,0.7587692979339914,0.7775317940872157,0.5330477371291324,0.31153194919466964,0.10920194556493801,0.7007391121737078,0.655780706655888,0.6835352013539734,0.1036493061016619,0.34088753076092027,0.3588902929158596,0.5031651077022495,0.3867739406891072,0.9923840539834757,0.8599003383578622,0.5135309815769118,0.3177331318626532,0.35995338679264777,0.047893792900301935,0.30968933369947016,0.15135913893978115,0.23721830715568049,0.4271586858255664,0.05850758709834469,0.20403997843198052,0.2371980705179313,0.4579421104746104,0.5665666817816938,0.3910616122687014,0.5208718490717612,0.8766832529336187,0.7841298102915145,0.13130654973620515,0.9296270309266926,0.8231552341463906,0.3132689786704922,0.8646178405529223,0.8119390720206888,0.26811756212926396,0.5948692949372589,0.20895278210299173,0.15919242818186108,0.4470439827462296,0.7516660144631135,0.15765592471275125,0.1509054272908129,0.7468516750218659,0.534373098323903,0.4865065067723824,0.29877953989479933,0.6528849487842934,0.8821278144038693,0.29141231078305174,0.7594740783076378,0.9262680816831403,0.6184531950926796,0.5970663724598734,0.08998173313277702,0.08482835299452984,0.22736818849291296,0.3506782341588187,0.9824873478386378,0.9018039352961255,0.7575172807371359,0.08354528303138675];
	    let y = vec![0.9630227723948783,0.3977064473214338,0.547312736331731,0.675752204345047,0.8890370105150934,0.4446850243155873,0.894604009942193,0.9497732716379359,0.6773066258103805,0.42843099027242504,0.9234394093622951,0.2643361477635163,0.863599601491722,0.5605661528470356,0.8077906779650667,0.44922407968031075,0.3413828454512462,0.7129092997875165,0.7030191766739647,0.5847345428376614,0.641557060975917,0.17070391162477216,0.19431018146241708,0.6944080158549455,0.89133586977459,0.2724537956874663,0.4968942250865497,0.08664571272598698,0.9320093285320898,0.0070973912669494155,0.2207630722417102,0.1259027627535102,0.3040652229851418,0.9051549107694953,0.23437545408778426,0.15758434369662033,0.7282519673207203,0.1524455503279334,0.5298807374351155,0.5585199809230807,0.17667465088813294,0.8804402539606848,0.8875348179801028,0.04878291057273043,0.12741748914508122,0.17753630285517585,0.02319566893172631,0.9801624766371624,0.8004033050030599,0.19887084433314228,0.1591264558871981,0.9908852235772513,0.36690984100780066,0.2902925896003775,0.5822766239595396,0.12597076796877116,0.07784174595401105,0.43846378257069274,0.8418507280884264,0.942210387686296,0.22033827240819026,0.9861887612790944,0.11839920911289592,0.7129479665181081,0.9089524495989092,0.06600606554347,0.4801227704030373,0.7274550522760176,0.4067446383725185,0.6225171469055154,0.5508549370912238,0.9142222914295737,0.12204229918391996,0.6390172241524655,0.7889870144283719,0.962537371318018,0.24612854818421137,0.0029928032752934985,0.9736888396828065,0.17902686746782626,0.642258419757638,0.01913873629538032,0.959022355094517,0.7658586079886897,0.6398987770779656,0.41848515631643357,0.4919086960131692,0.22625211406557266,0.8379269659176307,0.5409911650407443,0.024274665019423547,0.703049775614356,0.8118176394322205,0.10397522415692984,0.7259866175554257,0.8184969925180817,0.6219574898614807,0.0011394637819097664,0.5083095827605859,0.9271226592555624,0.048829478972735374,0.6601015185237892,0.06564758115163083,0.8052550254640467,0.9785983458892679,0.7772344954437135,0.25142699329622287,0.21769956293058412,0.5511320078179908,0.3050637419848755,0.7202411475839394,0.5798070221519847,0.5424448422053977,0.36357636723981124,0.9332524576861021,0.1755641295600242,0.9473309556752632,0.21880551343617904,0.3347947397387009,0.249918143036005,0.7717435587070095,0.914266451950128,0.46355956205530013,0.8810877906508368,0.02928381055977658,0.746819194249842,0.349365558622025,0.12849525705485243,0.45572642350102643,0.5965082902054971,0.7273389851826634,0.9261629932020623,0.6438673800604411,0.33366038560831823,0.05500446910931367,0.6304151678053889,0.3028212028362045,0.4665497783163689,0.20795032590619633,0.5556868453508768,0.3118595336634681,0.985890650493675,0.7669036509385276,0.7921304064949767,0.1907507246479817,0.9742301651131792,0.4054877219860148,0.10708981023561881,0.2630434888900143,0.8575036626065125,0.9990206470600539,0.6465452192982707,0.7795114528010048,0.9052796282747521,0.4072263849024529,0.1764916454787896,0.8408520727268651,0.05281171145994468,0.6882339619197757,0.5113397465179129,0.5528276998886038,0.8254368958346874,0.5705325420660893,0.9596851826101714,0.07639071882878146,0.055936830954877004,0.2746619193418234,0.6299364114191752,0.16536737508806731,0.41046893432657905,0.8027941133177242,0.38414222824821265,0.07799606936603598,0.03185289384605283,0.3561022019612955,0.46981673758135634,0.42199858175444105,0.8857705637242913,0.004262749490781537,0.8823115588155185,0.42901886317714644,0.44888399855484096,0.73055960392737,0.8222479590953663,0.21105558841762684,0.636867338250407,0.19317445041783443,0.7771590773602837,0.0071902967404327,0.9761889364872298,0.8893404752759391,0.636540068373438,0.9553214694850028,0.14505813381485422,0.059627194666189265,0.1357430279691827,0.689465214324628,0.6636841539642332,0.46657094834538637,0.1552302092922173];
	    let r : f64 = -0.0192964824120603;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_6() {
	let x = vec![0.7948355947176642,0.7322375367525459,0.3279388166729077,0.4835383707385923,0.22662847286433319,0.4237386465982884,0.04138170023876031,0.2883755633002495,0.023645750426056433,0.6066787265805844,0.5922722398736923,0.5676145160980088,0.26566466177696024,0.1762131280877156,0.4731623816403746,0.7371093891118987,0.23349714509845165,0.4834859911966113,0.7848861725749415,0.8677399233417831,0.7235298380574567,0.4191815176271979,0.4588638373978692,0.8304518835891498,0.15968412069713278,0.9070488678967878,0.39661435535832945,0.6779485364264668,0.21599932468718075,0.9334359985278381,0.03508772558193374,0.5321255947108354,0.09091718940027405,0.2532545505295467,0.6131958365202843,0.9808590768377042,0.1523775309391091,0.08488896473935292,0.8373872774669758,0.5077357414198215,0.2502107105684389,0.022644930718064726,0.26112019873307435,0.7740801429066995,0.46352163792907886,0.24201659343770565,0.12685851433290685,0.41023842122541776,0.7840026118557548,0.8936304683963232,0.3301297531574551,0.801202157782732,0.9516483649468583,0.8911629948474741,0.4697988673462705,0.9379823158518662,0.7493736921952077,0.19310397830919412,0.3471884218468638,0.700939965912488,0.32797762792674645,0.2034691055428718,0.032645081257406505,0.6178050757072509,0.9730549839129211,0.9971230888794119,0.5772481224194469,0.05620173466915124,0.7255231253210831,0.8355289394245803,0.5682055488537507,0.6330481794052989,0.667180976493243,0.007942842553899543,0.41651130020610616,0.3725210780085575,0.8445786571108009,0.4876895442111323,0.5484629978614795,0.7096550327467084,0.6821134973286226,0.42698864104375156,0.2410763391478815,0.7273622367437764,0.72673957617441,0.43368891277044763,0.6231729496016334,0.4988418237211002,0.5892971340819197,0.6524384394134544,0.553200957541256,0.8090699132262671,0.8823578691643439,0.7932120755284233,0.4092895615826053,0.5075330725007895,0.6281922825331366,0.9494516478459031,0.14170438340238567,0.19413391063099605,0.7765201070429637,0.7245883056477644,0.8074853972653517,0.07685505814698324,0.2741397852298576,0.7993389894115691,0.029100748689709466,0.8020883909982324,0.06088295087084139,0.04341926852850997,0.9381332006403511,0.34706931451232215,0.7031952128374586,0.9058264182284721,0.06791276131680168,0.5144006578425798,0.13070915012060957,0.497156628066441,0.16209133340538096,0.10906663328067356,0.3164410716924748,0.06315782471568654,0.2217730429370799,0.28708096720155063,0.6854831010056526,0.266758264668,0.9075654181842997,0.7983034448081335,0.29177501431983843,0.7081213068579243,0.636508451146495,0.9632533425445736,0.507798588291245,0.9044957775934229,0.9892027302229904,0.5860479895450242,0.772980981382482,0.8696629704932151,0.8634639348063833,0.08673611541753512,0.6719997546962819,0.6921646278152417,0.6951427717152397,0.6321630134443882,0.9186500279764215,0.7437663702067334,0.3004827308981315,0.657863824911019,0.18576575154259045,0.9898230670966222,0.9333532693672855,0.47402247755395,0.1936095493068014,0.7075607839118514,0.5803480344247088,0.46101693510522135,0.5760315195579011,0.3632408988681699,0.9581083665663402,0.6556262211743678,0.4868378241026752,0.28440654292321066,0.5395839076483475,0.2627208225142922,0.8789314871306346,0.8275247983240566,0.4037338035189325,0.5681210190277507,0.9330376587945846,0.30235807714653684,0.26193842768581643,0.8073942421977373,0.12399312384601435,0.2597175930680915,0.04791228654663604,0.06858375088328339,0.1889536907910483,0.02990026207747898,0.39996147197388865,0.23378797671119045,0.5750660012667891,0.08928274164715888,0.11121339173348477,0.09057021275892208,0.3342761888487027,0.27582605135370986,0.8860279017023892,0.6762917478454985,0.0248612453877447,0.4577785117812634,0.6011807392023872,0.5012962492403296,0.678587470421091,0.08464205420081128,0.04517654806993576,0.5434401534292973,0.2645546981448297,0.6085467917817793,0.2872844713544085,0.781089254832441];
	    let y = vec![0.2748968981038963,0.6997777866420785,0.039770813781369374,0.6633799903054138,0.8901426303202549,0.85968416406363,0.22518805958492027,0.9705139786539417,0.08729925584706777,0.31040336331852125,0.5894140940292232,0.1982952591985193,0.2604132361933985,0.1932199186718908,0.1995983255120688,0.3539600264232067,0.9979674383026331,0.22506123457721872,0.5779660583644451,0.8527814627216412,0.23378262780912595,0.6781176491526468,0.9531769770549641,0.3560270479735551,0.13767355922934454,0.7085443913658946,0.6472363918637449,0.4749549228028679,0.7491686045341903,0.9095569965969298,0.1624766527549235,0.6035298035239037,0.29524753108671853,0.7921045987151168,0.9711861927889388,0.7419084963887402,0.8484838920426943,0.4181220013447764,0.2067972023684237,0.6725834886877143,0.7091925101031082,0.6169027182095066,0.965014740504164,0.4215096351928733,0.8719372840877189,0.9021944299321834,0.03580660131567326,0.5209912521449765,0.4877138183938706,0.9439953748031664,0.8542277596278728,0.8940413596643192,0.1777634914648667,0.8954796504570731,0.6420672425032544,0.8528341577985625,0.9956570340079611,0.3140321473036628,0.1655659315903546,0.5826397489731108,0.5430903136455812,0.6547446349753167,0.46504116097566606,0.7016442268672404,0.021733057034747483,0.01776107197644683,0.4185498283291704,0.47178211082540367,0.07611176888923821,0.6257279721186704,0.8920884966610816,0.15898506998925532,0.1744260692995111,0.20435587689690826,0.4920551591071588,0.7449798083101326,0.15878275080272009,0.743349871410499,0.4272761851931173,0.5411112211071307,0.652042986483682,0.655284888655965,0.6892361515392083,0.389567377834243,0.28393790629085314,0.9250817587823492,0.3102496875611711,0.9980990696717456,0.4468661306652466,0.071716443034186,0.2638496354330032,0.8447073168606133,0.746146149984046,0.8212158777159274,0.8855012332655793,0.559108882152784,0.19794469502194734,0.9580143902384711,0.7751632975068242,0.5301862744233516,0.7233606954428717,0.9080682703728176,0.32421863254103045,0.48371095033228706,0.31445019157021625,0.7543656044177278,0.29529842923501803,0.10665149740248459,0.15989572785228712,0.30438014801057367,0.9262250893109134,0.7333241213282584,0.8475612276895534,0.09249687734535195,0.7029448765348927,0.9823290671669513,0.08255933984160468,0.25166694190729955,0.2380844309161254,0.6340426278996031,0.19447717744131066,0.09079765685468244,0.16911280123388817,0.13493622828147023,0.723584371916368,0.853014328865502,0.2313767012089334,0.027930373408714182,0.8030191997110205,0.46527806509401204,0.9581098042654226,0.24093828116394378,0.77681461081753,0.8451716344017366,0.42955311834403465,0.648972164141468,0.07435249488567042,0.5864292091040759,0.33930974345819154,0.6518054657660413,0.5648932307738641,0.49449713819925434,0.1479754318160933,0.3645978795906073,0.9675864536167623,0.1980974656051805,0.1342034604743213,0.8827848901724984,0.9165966007419277,0.28436465354486584,0.9171262021782673,0.16238642588236474,0.009394061100821194,0.279044151452853,0.979690972546257,0.9835709518605359,0.5261828305986033,0.16940381112504044,0.890624029026679,0.7561548511929505,0.9599631560136258,0.15966775592177906,0.7479915281405394,0.5887558832778261,0.5215643582928395,0.2845461921205924,0.31105032066198435,0.6871335976582715,0.20745597458702703,0.7916661784712875,0.15334295096152073,0.24936920344281577,0.6283141881219474,0.14138561138167205,0.03764521392855891,0.5202644769666935,0.7733875597558094,0.0671151449119014,0.42889592243498154,0.7077069723846857,0.8422082512607739,0.6711423735976502,0.9392538091635685,0.18109086341728753,0.9840812822521371,0.3596620173928121,0.09099988716011587,0.5818431573434905,0.389232716578932,0.6851617643125758,0.7791570974395811,0.39443657964105727,0.8406329501099741,0.6065058663329982,0.5707783468574611,0.43642743629892733,0.9712172488638344,0.018099337715267172,0.310115296659224,0.8725634724079017];
	    let r : f64 = 0.05879396984924623;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_7() {
	let x = vec![0.9528575800831119,0.6221780491009236,0.08819869075126319,0.03368737191561555,0.47873237711989236,0.10719414059399668,0.5278251901627589,0.5082846997161062,0.3750151592180281,0.049326680716720195,0.6457194508291049,0.9870506784000113,0.11355426646683142,0.30767427621971566,0.7673898501406936,0.08727327202424029,0.4598959196494733,0.11664842076055182,0.9147176378055206,0.2922334244499437,0.8047526661618635,0.7391464976282991,0.15057900124566248,0.784557930130254,0.7700761726728438,0.456353537001038,0.4428940493528547,0.41385412233334096,0.5514265511885342,0.0045792842987273374,0.1734312110438383,0.6157388962233045,0.34864573439948465,0.29177516693679895,0.9684243925111311,0.9248722292301519,0.20336189102521174,0.4683146551125793,0.5906868135958969,0.17183448983203709,0.6436599458557283,0.3790051144213944,0.7521167058475037,0.8196952824664753,0.4456908042060763,0.9334495513804002,0.039835599636989905,0.027176446150136035,0.30543147629592193,0.32270892245351523,0.14494875503187654,0.579344693348388,0.20615077101617818,0.07587462687895274,0.8202940539034071,0.8546802423306284,0.8332629403743157,0.9437553598606037,0.9513045830809775,0.014647285567969792,0.1959543582005825,0.21155678902576314,0.01197127454699154,0.7777107693344274,0.6949251396504278,0.1785340618023653,0.8688087432965087,0.5146288815417319,0.6048027115665396,0.3287933071469098,0.9492841192603908,0.9390183635019018,0.20372391774516296,0.94838837417812,0.4778813659245805,0.931106635733482,0.12610220186810872,0.12738582137836374,0.5898594060763167,0.1272952100502508,0.024991042874737857,0.707942298513269,0.891559273124671,0.830668302397678,0.09447488773719037,0.16116125743195797,0.020384182101265136,0.8538657133025989,0.0794574719394413,0.5780266614047844,0.2488381495139741,0.28491288124451675,0.23574702323232177,0.6763269552894747,0.9852110325966249,0.44279928286445525,0.2447386093857189,0.4589577252355369,0.35888757819019546,0.28044509273959284,0.6177347208413754,0.9003383631039481,0.45630156261563426,0.9882661662556138,0.373119698757006,0.892289358542392,0.01604755757437204,0.2345960461985035,0.5241883158733633,0.5546558687353357,0.8360554187005934,0.7179770512434741,0.06794767848391858,0.6947110496096003,0.34645928157102013,0.5207022379944843,0.11231674818303716,0.7161803666169708,0.29473898501121454,0.9719012765078107,0.25186481492393775,0.4869376840238264,0.9213512501349662,0.3509830651285435,0.8856881733866896,0.8993341325067831,0.5148982682246197,0.7347208213336831,0.868535914665216,0.44129624279186086,0.6655627712844455,0.8662430832008657,0.36155765543082596,0.5498730948923437,0.002697876865686788,0.4253482319983841,0.47533593973592714,0.008717238605569277,0.9799920890257657,0.008163104934206133,0.9860107008328378,0.8501306299827073,0.5803847167633176,0.4629235699668238,0.6862620423660445,0.06387914571823883,0.9926701073386437,0.45619659977272975,0.15599732578006986,0.5967387815488785,0.25777050743376717,0.8366740094173385,0.6076941265351159,0.5160376444273695,0.6532223272967619,0.9407027025442459,0.5435028065748857,0.49746963111058373,0.38828328208523655,0.8437258215754708,0.14780620483508666,0.8049171435798174,0.8061376800409589,0.08413036399496887,0.17108158195105472,0.09124724546206076,0.07739330067945449,0.654930114891121,0.6828305618878183,0.8244986863186952,0.16056154028974745,0.8516361502804359,0.1154332381926495,0.3399705638847983,0.7932715679273854,0.2837889624675112,0.07373484548453069,0.29822237961859355,0.22225340810004823,0.8340616175288145,0.9429718872662293,0.9261563690034195,0.3914106866825896,0.47468730476216214,0.24935823844333171,0.9514499516276136,0.5788214753207658,0.6805367795779623,0.29968686583049664,0.8650259361665336,0.5753863969731535,0.4917431754762137,0.3420995121825121,0.339311242649899,0.0054297545714111495,0.24631048187571958,0.18027066323325458,0.9391890515701563,0.8308323364213146,0.2279105142144643];
	    let y = vec![0.7377795065116346,0.8560332742089871,0.23282860496153834,0.8170271745198778,0.3723019804529809,0.7488878149880949,0.07877865597148248,0.2799834416468452,0.7013058221557366,0.08989961974177507,0.9345503680428562,0.1812699782418412,0.6152576797624136,0.32797524766656827,0.681934086139655,0.6555825249666672,0.12006832315219096,0.5036798275608533,0.723964659296292,0.03206594858822909,0.07233079423959254,0.6412965125384913,0.021468931185404494,0.5514900978584791,0.5488836662279922,0.8443856014772391,0.08705483034331685,0.151203891247079,0.41049503282024,0.7413203569969319,0.26625525444662446,0.8183500680070398,0.24169161584656362,0.9714095349547863,0.7266311008210535,0.8769645315954071,0.6571364274256981,0.3359205312912924,0.609349297161403,0.8900851988513863,0.6333639544782254,0.13519754271032092,0.6114265454546329,0.5279821541044696,0.69415746450748,0.6911313475565652,0.5446644604435976,0.5625622234448386,0.21666876494911136,0.990768687213574,0.19947286928893737,0.8997806542310809,0.20086938178197933,0.13338682727327122,0.3015991377779751,0.0735277610548003,0.6853164862443312,0.9083256365986836,0.8114225182946095,0.6421228315007537,0.6579852055696114,0.49351612848850746,0.13754533945134484,0.1030224799634627,0.5507059897610604,0.27868734079299584,0.39517346135377196,0.9694538760721075,0.9875209468893014,0.1303672572391018,0.36374648368908113,0.36486598120342684,0.12169430201075837,0.7455917364873724,0.45387188419974267,0.4632227357403085,0.8799654282956337,0.7116099977457604,0.9723673752455683,0.7015618290920322,0.5091920692350611,0.1931332532018737,0.5428682673752153,0.17975744020306084,0.4321091387985906,0.7632215811583125,0.8038188425319164,0.4677522697899358,0.5759946482193048,0.00958090779731291,0.7626465425045381,0.8876714702736512,0.895618644005459,0.2911933385658858,0.13736824379351298,0.5634136035398838,0.22703897542415785,0.4215719259178169,0.3400309031509946,0.46590049759033336,0.4599557451001297,0.49784418943207864,0.29545635751916777,0.35747319971787705,0.31414073831246037,0.9902841937431535,0.2953290138567656,0.8880016222227091,0.5182035535846681,0.3797654117385112,0.819716231376946,0.4438065111952755,0.4577111184246141,0.6986914539517505,0.10424963096295836,0.3849411639359219,0.8488529063148982,0.8242133785119944,0.5995102895076826,0.03190163677433444,0.8232582164061092,0.07561976956295835,0.28450348683707305,0.2123983827122108,0.6992426412084954,0.7097950287821461,0.5496475633843508,0.40838926403014086,0.721845024265209,0.4830497577117071,0.3573050544079699,0.5385780084154023,0.3661808916110344,0.7124595945421995,0.08926802170958426,0.6964501945274499,0.993330290600432,0.2506506606546186,0.3272071248886381,0.0587621113683775,0.4557803525712941,0.8899116799989994,0.2756002014671237,0.9225002230697095,0.8265552191834883,0.2383972495296176,0.05976454755060567,0.8277163826276076,0.8967871734590115,0.5633033871805508,0.33324365559853786,0.12683705305266813,0.17328504974788406,0.14317200357839854,0.17157244516393322,0.7110269816614436,0.9193409089028586,0.3749347412946217,0.7776844652898561,0.41165293612138176,0.8101067803711627,0.8969694336051949,0.006646882349147454,0.3041629011858924,0.32572454408933793,0.5079838357347981,0.12333120070026704,0.39898939106793385,0.4120654593228855,0.7016044129536279,0.3077588492444856,0.07633470241016993,0.9760185475467196,0.3033615209578876,0.8741963867446504,0.21366457307034992,0.3131032106596269,0.5488813595370462,0.731431287616234,0.13583451530785662,0.6769954183142473,0.6539876819683763,0.3253493755079332,0.8552342053024631,0.2342774885874087,0.6916236627882262,0.8101121579479357,0.11165685744746667,0.3653385892468243,0.18654610067604416,0.08016681574354956,0.09812062448687697,0.1928119817055216,0.03817911639334859,0.736791513583119,0.5334356908910906,0.6799298555420005,0.682015479435866,0.3948650352939086,0.4615175500632237];
	    let r : f64 = 0.03185929648241206;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_8() {
	let x = vec![0.993484882776388,0.3407533164639056,0.5595317254021384,0.39307240865597426,0.6968445542595771,0.6913856515652349,0.15201722572711796,0.8674552229104596,0.8276748034022894,0.668886963823878,0.6668797439723085,0.44639813838772147,0.9945420533028045,0.8085444014776324,0.8745092910152628,0.7402923010842355,0.6343271320724659,0.9493356668912486,0.9238690383349525,0.8630031539079979,0.9061488666732429,0.9813369239702179,0.6335495892618027,0.6871213065199231,0.0818244529825426,0.6347610662792849,0.372246667458075,0.5033192018420376,0.9495226391187747,0.3832186721100247,0.8851816617061173,0.9269876438149335,0.3161092486545669,0.4696914085179733,0.2324812918896173,0.3356310130777115,0.752921241914994,0.2582235054383354,0.39240133169361735,0.6669117562123795,0.8031864771580152,0.9891740063105707,0.30189656801039644,0.9924047528856248,0.19680823293890326,0.685289395489983,0.18957680021888923,0.9146467348040295,0.18362692976584993,0.7775358052616969,0.7721487076311285,0.7628914847479364,0.0900174487185963,0.7833803729817944,0.5577292557231819,0.2754692409547089,0.2581455794798828,0.5803721268144406,0.07439318505313075,0.20477699705721586,0.892747733690468,0.26522045953324325,0.854185253562832,0.34066962884993235,0.359026396062613,0.5493852045430005,0.4252187933011604,0.705264455460006,0.045312091557554224,0.8546044891184581,0.6078336742929165,0.31908061587336534,0.5368052733232304,0.7824103961687239,0.9052029705482915,0.33789725631851775,0.5661285472244568,0.23662704836540083,0.7712975602414358,0.01202727089761868,0.5836466912054477,0.9757196773557603,0.1217173214588072,0.7277922712922054,0.19105115076055035,0.4766800912293041,0.9578212247513295,0.8071274713947857,0.12299227997657336,0.8867695905611365,0.6965544170220743,0.5321635681316287,0.8103075690949841,0.4868569567299955,0.21455448303838087,0.543771746422746,0.0635885900658022,0.3176335912472469,0.9765451903289529,0.8843125734833398,0.19275634521296225,0.9532569567191768,0.2936112498217911,0.7136599158857493,0.07901139243307731,0.8233104346822854,0.1441613819615034,0.35908560403486023,0.12657445161301362,0.7633982077373161,0.8750219876278847,0.8559676238852368,0.12155576819963498,0.17971142532428186,0.13602312936568672,0.06808143248365428,0.26506249864765263,0.5841905373216317,0.5735248522401397,0.9677648921899104,0.5441986196108662,0.7450776866577105,0.13759145595145605,0.47239974418210273,0.013792303150427898,0.14214703220201874,0.5392058182699062,0.17584401584565856,0.7468315063815625,0.693214545287999,0.7243402674100244,0.403669891535993,0.02782514404445091,0.9733204795656687,0.7632232901225328,0.12393816392278667,0.2650438477049304,0.317425158008263,0.9586044355481288,0.2845000182351125,0.40120792317029064,0.3667046211241155,0.6109816303878316,0.06845600389623674,0.6055314261067546,0.2443479629938864,0.6509706256499974,0.7277327412924105,0.2717678681796559,0.29074568684989577,0.6995812540779067,0.2501658305986795,0.630896100388971,0.04710660738220995,0.7511233038047813,0.23782701835143316,0.9098102905027894,0.0007753404692056876,0.2653133006187586,0.6106302938216565,0.8041127210646677,0.9234503045982093,0.7585544729822895,0.2502970415336935,0.37625730610711816,0.3526489965158215,0.8004247701534724,0.7513827546572767,0.4734170981862782,0.17238894720788533,0.4734621859663056,0.6249701133776673,0.00969013031253707,0.20898922994414737,0.06723857697996316,0.91412721910508,0.8047318452619442,0.9180382410720025,0.03996962442422536,0.7190880951797796,0.9132463634808486,0.715933650640266,0.6088144664112871,0.3112450338525534,0.869209232372435,0.5675131502714462,0.8938081611819138,0.03130835765786055,0.2700040758368085,0.4448121685162447,0.35714989884075776,0.8584087062242292,0.15341527960761248,0.6050051899341442,0.08868199427050705,0.3281110532321857,0.4596905012466549,0.5062317443987033,0.6126024250258473,0.8209138553665077];
	    let y = vec![0.1345491989644827,0.5649761836397906,0.5980929945880901,0.22243389835490168,0.9194042364576597,0.8835854331298387,0.3615642309142687,0.3007776714998853,0.7238809293538716,0.38202203115582944,0.9789980016003926,0.6258751658656049,0.4097084928416953,0.7891149142271375,0.601254657365725,0.4215183419992593,0.7456075288162347,0.7874659843744914,0.5898119900310759,0.033481795624305644,0.4651237593830324,0.5215638666777214,0.45006962796083927,0.2982081605138661,0.2333323398705328,0.564700815320811,0.03311776313410264,0.9748167370932519,0.8618456217555539,0.06366666836325474,0.251545747329848,0.4946582396863566,0.4045926107315927,0.6826647463082285,0.6042378302927878,0.42369822373518606,0.3298144538358714,0.11894060599558476,0.6377663145417846,0.14141528048540553,0.3056577425268675,0.6777976960209399,0.8561690587564283,0.8452049849243293,0.233515239651244,0.9468375474014865,0.36141975772082613,0.4245572139178997,0.13117480113725055,0.7827109161895318,0.6840247528472383,0.5942462273432331,0.9968219947347413,0.9405456593277918,0.8899389623375067,0.9185306116586015,0.592690338516256,0.10292453930060053,0.8151741292154095,0.3442560983555032,0.7432602408980654,0.6322913232681223,0.9529382251244303,0.1721225631805111,0.6988003186639542,0.20542710611139936,0.6490709172892308,0.013664180788071079,0.40603047176706575,0.5620232179524038,0.8407588103667836,0.6762558205434119,0.06823832448670253,0.4693195261640697,0.4072884052733955,0.8175862452492941,0.47067730667357455,0.17231148774187255,0.3075207904535041,0.34349859489903234,0.06755201143908462,0.9841903300776785,0.2555737472380627,0.7042195664834698,0.21794696088417642,0.12205518160255235,0.23627242822037708,0.20339231745563813,0.23931056281577068,0.8928521754510949,0.7522814282155937,0.1773939889157966,0.221429544867229,0.9535232029200454,0.9084023443291519,0.9477500689086293,0.4551549410400064,0.6701458634127064,0.5313337213287361,0.04001150662683506,0.14998213335037103,0.7118185405368145,0.5257506292543952,0.5699421083919437,0.48064241253837736,0.11015147564028027,0.5033446708643784,0.9940285449905988,0.8709471346484536,0.37581460184284277,0.7574344052732559,0.3547968452646205,0.8473042940757228,0.29419431177439204,0.6881014421845464,0.8368057709870124,0.8604770192076671,0.3059765350290883,0.5852052680720038,0.7694743762890095,0.1959756862069505,0.6914090585411885,0.8903496072286948,0.16343613501555132,0.27247373223605365,0.29705677108798645,0.12724921947180434,0.15126107060190275,0.25080110675651657,0.7776910133340112,0.9994115980740512,0.9894888828900427,0.35640250297497544,0.7411845932795625,0.5903967103345287,0.5177196821423878,0.7054210777282752,0.3287717135663323,0.9558339149932734,0.49267149859708104,0.9463098229250722,0.328613110597768,0.9937724998414071,0.5090758978547845,0.42301626546441884,0.9865787706942597,0.8387092977211016,0.8098038983264563,0.6221358537175936,0.12527396377748012,0.34136674893731056,0.5791715566048992,0.5920432322447561,0.0011268791752346852,0.13323664848603045,0.48045563322934903,0.27534390507950535,0.8042411225509045,0.45671975081259764,0.11750253614562345,0.6434067283388726,0.43627550398713333,0.018582102992749427,0.6577120630296116,0.7361100537302567,0.6805244816639844,0.18506094299056397,0.6372198777182978,0.6972577569066358,0.8582635258274846,0.9083618382535991,0.2676467728670312,0.37267541734152954,0.862611267742367,0.22023860579404386,0.8117260015917718,0.2980808056573553,0.8054502899955064,0.19758162054498518,0.4714697753456121,0.3198422326582887,0.19865138660145687,0.9432074840998002,0.05397494342798348,0.8836920535246668,0.8558230478280828,0.49116909255253305,0.3827385936784742,0.13710272086579423,0.8294471912754116,0.937330381876758,0.025120824257803043,0.536157166057307,0.28642466334684813,0.1562929799710594,0.6471046616760339,0.14926040031994814,0.41828502497336106,0.04096585053842838,0.36194025561281074];
	    let r : f64 = 0.049346733668341705;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_9() {
	let x = vec![0.6988436367494086,0.23464135859029822,0.9868693549042894,0.6320550140590686,0.3651926756884567,0.9017986291293459,0.612986886284998,0.7541000960063506,0.022914919664445144,0.33647967874891893,0.15341377339350193,0.10213233117425224,0.31935836122754524,0.4244170184837722,0.2672754387087949,0.9981098216093831,0.38754181353891803,0.636061168484513,0.8433183985051048,0.16136878595268067,0.26270728702642,0.7654521343164519,0.5132511694976798,0.18711970715581994,0.8711983752583805,0.2447708472070228,0.614060644669797,0.19959011522846037,0.23830990790137474,0.9202457455524627,0.38492670134435925,0.22773163326452783,0.4943452917527801,0.3650361413280865,0.12083257011734005,0.11499152471494622,0.645057699289836,0.9544914406343826,0.3361624652899262,0.9346691000602823,0.3555378201386158,0.4019564783525583,0.1320820890417942,0.5508338004012897,0.33052697983047263,0.8090828992843743,0.7519709523703962,0.7213909022245169,0.4823755348346326,0.6264599415186456,0.20732672182757472,0.4775534919765162,0.930492387555757,0.4542721469699056,0.6216012508887462,0.4522928228828459,0.2748907638271645,0.6855922593401051,0.784514300894587,0.300268872549704,0.7892107954120505,0.5949495936912189,0.703486438330442,0.05129183374640567,0.9652190652113597,0.3055704322596784,0.14723533919904386,0.661269168371428,0.6920178836328024,0.4612998999128909,0.7531019254838398,0.9019428291694794,0.462380154057218,0.3942060998495128,0.7604364463646645,0.3611106276061712,0.754761481730982,0.028387810940104785,0.33432133899959404,0.6233263337527225,0.29311342009037655,0.049540571934542754,0.8125620549694089,0.35642771402016293,0.1423760338528064,0.7094005746553045,0.5775320735868125,0.47515084425285525,0.61825662732501,0.2820951928562375,0.6331828117610265,0.8545076019071876,0.26866884562234306,0.2977249961698152,0.675894045441039,0.993312471708664,0.8823586458372431,0.521088391616483,0.5313559944166019,0.7332250848032155,0.769129279643034,0.5059119847913724,0.08621688572009423,0.18090868332808285,0.08392785394842561,0.6063353885972177,0.39596121150231256,0.08147026006083402,0.11940841701858096,0.35915874731686936,0.7679759234647164,0.7214884509945207,0.8694742405403529,0.290800312056547,0.25305185539919284,0.1772110640566794,0.6508608017156411,0.024536599694549244,0.899234735214535,0.9837289327245653,0.30950372962770567,0.9060948247059932,0.3336041662712198,0.7152947005087025,0.3291194648716903,0.2837732841090773,0.2909393167967512,0.10691898259020716,0.9405503993952308,0.6573561933713344,0.8581348219379044,0.34978539478329596,0.1375195555785922,0.8555188432763692,0.9127605551593373,0.6551403638575023,0.6900565705678313,0.046836952964748546,0.14439558706344946,0.41699677518117884,0.019729533289692514,0.044218191416359076,0.9288538993386384,0.9312280902386415,0.8268876039724011,0.1506988550327123,0.5515626719033087,0.5843529069523786,0.6787704149174025,0.5626492379539466,0.3106151335693126,0.8721437322874971,0.3064880343465508,0.9387207076295014,0.6259448745619229,0.19673243323215328,0.7631894713824234,0.9340087328328771,0.056968637059481186,0.447193256273955,0.4887583214989595,0.7032208719051447,0.9240880798360712,0.9870634045547302,0.5022471337492032,0.9726848650516281,0.15422936571331225,0.7988219399487853,0.7529779725599025,0.6931225452597554,0.8313988852135734,0.7258841366341273,0.3893347763319902,0.8211897189585922,0.37801343615940375,0.887326146389867,0.2429216576550116,0.7073616720068577,0.3827490322250443,0.3108811238914273,0.539964582933628,0.9225677173670422,0.19670476556307204,0.7684261982048062,0.1220200465087764,0.9138872485784695,0.3593725146784509,0.438741109216505,0.30924743449803616,0.026003636801251062,0.11086905017689874,0.36441562644908554,0.16459147095437854,0.3328660717558459,0.3242850722925332,0.06231394288733305,0.32000796259094766,0.21884322292837444,0.6242049416406248,0.02289218874324883];
	    let y = vec![0.16983253330244363,0.9536540375025776,0.1544797438950043,0.9163820133817117,0.5784378061334328,0.7069451570286202,0.8907545120993184,0.2650796516079802,0.23468559016843626,0.06882574851683154,0.7114608355911125,0.27291712815803104,0.040630629247226824,0.4168645609029963,0.33780530786895446,0.10720261473288972,0.8696858007385208,0.23696318988404508,0.28690138800160814,0.46007177599119276,0.5328597754682594,0.20564180212534888,0.8639944306304022,0.2052789072581822,0.05118339182318632,0.3591383920137655,0.9493507005607174,0.6168020478296121,0.11822170393304665,0.9028868115977677,0.24657228181821544,0.05738529941360637,0.6604554574181587,0.6252022634646529,0.7315627158934581,0.509897727171049,0.03249625936069622,0.9070534346372913,0.8626715159761043,0.29806754281215264,0.168849294096159,0.6822770369058135,0.7088707591757007,0.30271729925830726,0.7317359936237154,0.6851981322132115,0.9173106384096564,0.10817799897821101,0.3907241352860904,0.22455826297947845,0.161138737901531,0.15388903242120733,0.40339977581998077,0.3633069768572772,0.8398922541722985,0.8144440060146081,0.14052775890567726,0.33884747754788835,0.8387580613314384,0.5272566525457011,0.1667592513545032,0.8790031221295688,0.4580070625402376,0.3282013710165105,0.8051525587638108,0.9813347093769422,0.6442172134389766,0.07087402440084223,0.012089282660140088,0.1939792728837091,0.22295838176311733,0.05647992854137163,0.9529907506335171,0.7584425818474331,0.5337064806612767,0.027888498517749327,0.16800685212205402,0.17343240702071328,0.3127858537551502,0.3766854734289665,0.10671184719685656,0.5175714827320335,0.244715656375167,0.9891562415450991,0.9751279008788221,0.7298396491760648,0.24843530958465188,0.6396174266321054,0.3201300728683425,0.9853348877162394,0.8674551009182445,0.5348575572079135,0.5704381550426461,0.8925234092375409,0.54941797681569,0.8971878187531842,0.42741504529987784,0.5445073090827469,0.0679068234044562,0.7999731516376724,0.5931572617957506,0.35188268164391556,0.8025896466193622,0.2665684197355599,0.9108153254125158,0.15171040175508244,0.47082255399272255,0.5423390953192608,0.2260093851787751,0.8362077175842815,0.4439574054668175,0.939799105602517,0.20030126900275047,0.3799139957183335,0.8861719634165783,0.7045186465538507,0.4061053278784681,0.24111500751509973,0.23841176472555514,0.7043010342567869,0.9690982726855166,0.9944972529801991,0.3419354996405978,0.17989284274825879,0.14159791985349168,0.2811204058378699,0.4327056141428136,0.2594078856128884,0.5496274219451952,0.6672597174159864,0.3676113352612653,0.8498983520092805,0.7357180557473139,0.8164415459631018,0.7392764108032494,0.5885527136166705,0.21416063722160528,0.04635198880120228,0.4523296374927085,0.8341112339478306,0.7875251637786629,0.3859172652301258,0.5769278172440505,0.5700743207214507,0.03487553894411888,0.259377320229478,0.7901034642508896,0.3642202747402743,0.40995928556688843,0.4789093355078955,0.2735118981940672,0.04368463857819049,0.6063920114111246,0.887684284642863,0.03809987121668823,0.37097901819166657,0.017108329098005748,0.9914255051056701,0.7518113173219502,0.9224040531945069,0.6764095321852795,0.1829719736944091,0.10601875284239093,0.16810361044894007,0.5975412267940634,0.7123908325563771,0.7946268320475804,0.07275713469202683,0.5688052865418461,0.2702315783972197,0.732888355331811,0.0651010508976857,0.7566126983026055,0.3472889859757827,0.16571737332635472,0.685992765527769,0.37057716064237556,0.3540542676958027,0.5772876360960235,0.9448171466075447,0.6169415689991641,0.3443062295422723,0.057172433121569166,0.4504211352627072,0.4849295142708656,0.7444860003265672,0.4688646379459124,0.941691112716827,0.7604540270172079,0.21598073087894942,0.39799812182009753,0.01924641361877799,0.6077052927425651,0.10825678437163133,0.897031368223325,0.2144057760355984,0.32227326185496585,0.11348018939195059,0.5740014884532406,0.7710255997924251];
	    let r : f64 = -0.018894472361809047;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_10() {
	let x = vec![0.0754389512111503,0.3999622756807457,0.33246517024353184,0.319102030427048,0.3498549057471777,0.5348576813056602,0.3129928948091364,0.8563626132356572,0.1362257840874701,0.3883599635037517,0.026627145671335617,0.628141473853273,0.9063929692986792,0.1029896283572338,0.7591784366237236,0.8863783076448809,0.9090647787315749,0.45700513538834286,0.8702691761201958,0.7479949638069839,0.15726405008239763,0.3749985940080305,0.8459569371589958,0.0292540111514894,0.86580511389194,0.4992586676331011,0.17366520656030282,0.974740010230245,0.7925888473588071,0.7520388609419302,0.3955383554750469,0.5304303613729833,0.06001524517379542,0.7246247067083005,0.006959399957217616,0.4245098379083194,0.022927723140302114,0.5763158376929661,0.9980224155477894,0.42860593786626155,0.740658024745879,0.33242434506945406,0.8523714201491042,0.12287996255198652,0.6037405487280199,0.6253908675290005,0.5576040516821454,0.6166926429931266,0.01916023106342324,0.4102292848072433,0.5086512431427831,0.585026086643211,0.7400640993122787,0.3705612957598112,0.6190314775307442,0.06652616852369331,0.16913838042256713,0.08802585964366438,0.3615274074194099,0.16871680727442262,0.23139250986150772,0.40760279490792095,0.10179388419119395,0.8415403282142334,0.6350276761309942,0.029480657260068543,0.9913832047181167,0.0302406505063475,0.22111835799391133,0.5514799259488471,0.47461791205274273,0.7877674362482721,0.6542872059651506,0.6689612783924656,0.2250660636469276,0.9540737817762512,0.816855732631908,0.13842329909826778,0.6463412126832376,0.7573655097669593,0.5366260415822973,0.9100867328953802,0.9155654583837378,0.6239242812958297,0.9430982773944421,0.8223406810960244,0.8337063518456407,0.35711731489168086,0.784217047775768,0.884894484759294,0.6223177230663833,0.03485349772774193,0.6451327872169808,0.7719968056334757,0.6563067798227691,0.6167208746362641,0.24273608013604564,0.6753193885038276,0.027834878868790325,0.19453206897196595,0.7508045352767746,0.03227911233004843,0.8888271173648843,0.08538392939505246,0.6953213738804604,0.43942260125409416,0.9899510549398713,0.1342303922633521,0.5271992167672265,0.5527307650526916,0.1031615945583082,0.7530593806705292,0.33722461671922477,0.8420252528614709,0.2927617379810713,0.9182549469763052,0.0048229503057954926,0.5829552169710336,0.23565610578233065,0.1008009377938941,0.36764893184146885,0.09914901060813341,0.3078637446024306,0.36179422371111636,0.9867924065379269,0.07250427025815265,0.5096461717393883,0.7624340508107385,0.6885479740803737,0.17618864265323064,0.12193622752659361,0.884631278495567,0.3085126169073207,0.762941841367948,0.9435093475864416,0.911454641979142,0.6469377804966105,0.4336806664892554,0.6227470722982562,0.45314374235286936,0.3916822046597238,0.7585714258347236,0.04743104858013736,0.6101939142185637,0.72803265691679,0.01035540121229539,0.6074934278097429,0.510497260945039,0.43731794358771614,0.9312967930297934,0.08064466320131836,0.15312029312835462,0.3896061485048794,0.32619570818375776,0.5317530883598363,0.835955801246834,0.26361755450959434,0.9119931262979628,0.6869618837294029,0.6695759565885634,0.04471476113408257,0.035602083628654246,0.34637314299999733,0.8346908685628451,0.6615439126138347,0.6877508791777391,0.613707371563552,0.6652003591192401,0.3318780666775637,0.8411398321277408,0.14494096858649064,0.9046155506145132,0.8439496116306465,0.5248226608895986,0.7948997519143808,0.8253780318887662,0.5029383757635911,0.4303139688323171,0.8734560548172843,0.07182069942832359,0.2795579184200263,0.06892907878650423,0.13623139844496224,0.03272841294441231,0.11848211476420534,0.24758039919515862,0.5739417184693,0.8984497111353319,0.08246608978899261,0.6809788511393003,0.11075080490659472,0.08536613500719636,0.5745307882766383,0.1731838582483639,0.8563999655751855,0.2732843970021741,0.018787196271463413,0.6065630143325293,0.024615090208655266,0.9160161506607216];
	    let y = vec![0.45733776997188125,0.43108795837899516,0.6100260858668863,0.8423968572576706,0.22737072877836706,0.09574006147196312,0.5387896937628998,0.7289931807418233,0.641473264490851,0.9548208738014726,0.3068404608790749,0.15155506380205164,0.8031580193822947,0.31093863893634865,0.2916162245823526,0.5787924859557616,0.41547033023631896,0.45897735410211216,0.07029650325018388,0.12117417249797868,0.5027570065817332,0.2765017009426568,0.4896105145511893,0.2214092919018773,0.08601009055507225,0.3017308772701556,0.6474291546568931,0.5162703521820794,0.5087068639431543,0.5033332517258062,0.4387641017005637,0.684967059612855,0.05636204908588327,0.19849835709788177,0.9391033184147624,0.4412338365162134,0.5652204727107735,0.6572415627552481,0.32648629548045105,0.8849449086227695,0.5868012557432536,0.045621278650612496,0.913107845086091,0.3587177048538652,0.6022046051481211,0.528647126055976,0.6579491987134964,0.7397674364292017,0.4636979048284112,0.1605694271613224,0.25554984258158253,0.2520479182882531,0.7230352407793874,0.40516914492460443,0.7928198279856319,0.14424510908993415,0.34288660184430475,0.1576346823898831,0.010352402927206183,0.22136845675985561,0.12767977023585486,0.014704925172517758,0.945882335074681,0.14977226928227827,0.9652455800066552,0.5406401687736332,0.23852977236053252,0.011248799289979905,0.7868535621403412,0.2918315803060778,0.46362767554941164,0.8685392517404953,0.5438374151401115,0.6413674342686436,0.9118076583249008,0.6582221699155796,0.4353458066137189,0.5297681333659613,0.7223023183658727,0.846596291166193,0.9865167268512254,0.5001371363084173,0.9374797992452604,0.23691322284508576,0.5654951486532376,0.8317620554589668,0.5249578987300343,0.8742110854547768,0.7289104901388357,0.3553424469145472,0.4761761328035792,0.42770044498092075,0.915531804051897,0.2973896891355725,0.5349664304346512,0.6414296305810948,0.2569128549359886,0.03287465087972308,0.4894407889225201,0.41565656312164334,0.5051625147214678,0.8734140182461164,0.914298604546061,0.10695297739467491,0.2735718238623971,0.6246350609722612,0.6481837687475953,0.27317460723821196,0.6710965367036256,0.0944673309812587,0.4171053303956179,0.8198763015464858,0.22878727169072122,0.26798578117356475,0.5798868950609092,0.6307589369077011,0.11845231454736849,0.0057502637473928475,0.065143677922061,0.34640206380021776,0.819999733155836,0.743286674323832,0.8911945989669537,0.41078267586870676,0.6894250881591937,0.2120131084169702,0.1990251525537169,0.6493865170598758,0.9283209886544561,0.7345858603038598,0.3913841148847519,0.11420110175631937,0.027280727136601568,0.21807999053488902,0.48485756688407966,0.977737033510417,0.06348815673260677,0.19269260179227787,0.017577873375201558,0.8694162478754656,0.744021744680879,0.2378264648460553,0.7714292526702472,0.42149275725273216,0.8025425845049611,0.7700316327919626,0.38403274078613536,0.5505377009166441,0.5092146071425239,0.6771834332345883,0.41974373924527986,0.9023329555154411,0.7590422356210439,0.03874069112525458,0.6319064228990363,0.8668212873813281,0.45226497422385836,0.17305166366631053,0.8070057074990619,0.11399110581211391,0.8706329817022482,0.3121970236775541,0.7049333371310443,0.4475355919762285,0.12934237850641295,0.10239694220446294,0.1394823067804114,0.8582284600290608,0.45565059720023815,0.3452817596645591,0.6620666259026357,0.20667708656263906,0.20464366170926285,0.3073698763530024,0.8005807586953231,0.010496676070719135,0.36124163345456806,0.6928014631758129,0.9969233339743668,0.6298414945357474,0.9138058251913036,0.19085804487314495,0.2934807254898608,0.6953484905249203,0.4432566851806251,0.6347339656106595,0.041975071515511386,0.4536844455424359,0.6148215013268552,0.40301666748416975,0.8388735919203775,0.10477138426669086,0.7268203601633667,0.3791071619584748,0.8990317560911085,0.05300862395510675,0.7777816974390511,0.18547953732119438,0.3878464120852432,0.5136958828202832];
	    let r : f64 = 0.04432160804020101;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_11() {
	let x = vec![0.2967188147391445,0.4230816812893905,0.1145572817744942,0.8423860358203062,0.9726356674890385,0.3072423537938207,0.29242320555364076,0.4018425845369663,0.2596547574206236,0.4124853576738653,0.6044357620138447,0.7032699890993559,0.7277698025916749,0.7744327076016703,0.20432534231744537,0.41979313868748136,0.9832811753249044,0.8213367387095057,0.2529092494376384,0.550321820542206,0.906153339491866,0.5254085903048065,0.7490288896139277,0.7394181878074834,0.9925734035887019,0.9259133164300906,0.26530359305607487,0.4264211418057787,0.6818335559573709,0.5239898657237164,0.724552444772094,0.18607707169573073,0.48205693763780544,0.8670811983837482,0.19744905230148524,0.6303087471312202,0.4637030828907375,0.7518714837292814,0.38548566218152913,0.3355380128750822,0.7582458893994113,0.25367508350934154,0.26398565766652493,0.2633906562882339,0.7469721794546517,0.30048860368245167,0.1219185663281881,0.7345917644636054,0.1494337992724699,0.6263059792694823,0.8237052863004802,0.10588826009040408,0.6749791950336681,0.5461918741600118,0.9788504519896103,0.5103369716929094,0.9852857117750261,0.42619990496994686,0.7760921725582707,0.005191822004673496,0.3292767730446785,0.9075966866918229,0.4060971450178654,0.5564836253369039,0.9314970584680481,0.9081385759395619,0.9013748339494378,0.32137893144621843,0.12650339000283506,0.5255281853490196,0.19206240685328002,0.09517492171556119,0.592470043223748,0.7691511004988546,0.023965321135125506,0.7903519736118392,0.5133107497999583,0.06895442077705038,0.935993876332397,0.2267207940581436,0.9762572690800451,0.18748017483392931,0.9207739452948215,0.2960854086013145,0.35609709149904334,0.0926556552429888,0.21562672381590464,0.4081614384634754,0.3472531013780049,0.4899177014098398,0.8231801668712857,0.4331349307518375,0.9911172776690895,0.532292337834008,0.9172873344909709,0.9963752866348983,0.6352746851916722,0.5266276792056549,0.38332880949813397,0.008695383394730527,0.003628166931664123,0.40967935764017094,0.0015649752641554437,0.5909295115410703,0.6483362517809453,0.021526684196843116,0.09358863191525968,0.16060391448754474,0.614797328592335,0.23789666223394168,0.09615254292972009,0.06761519329192478,0.07713426099060783,0.5104685588985745,0.6573996872004919,0.08616338438599935,0.13553985983958772,0.9215494204550181,0.17643389020157085,0.003611633521265478,0.9240514679882085,0.2934339120955095,0.13177638354829135,0.018769195314951914,0.764438569820522,0.24047105137974112,0.7456205356146107,0.31933921591884795,0.06832469303467259,0.675698934167413,0.7543373935547528,0.1541746568165303,0.7077772711902287,0.1488745078678232,0.08772178722546142,0.5414403894608565,0.863074291541705,0.9819110294065698,0.766376385104144,0.6551934442475686,0.4435623733707845,0.7755180182223443,0.8828616422444531,0.36589961385616776,0.7545501284013653,0.20430489982707167,0.2511254480606614,0.047916987153450497,0.6467463877120218,0.031826746749196944,0.5381286005751885,0.4082725195876764,0.3977446398604342,0.3506611514840766,0.715646729128737,0.31145646432714613,0.6587231952134887,0.33663110329953916,0.9449305662796087,0.471997633889909,0.7801974333035802,0.7301961832176153,0.18927938492785068,0.9133666311528527,0.840074539734664,0.023705014740472374,0.997026392882988,0.30564092513350183,0.7886229275535162,0.05086322043526037,0.14626411174474807,0.8997603409905401,0.27335013119025364,0.1091743717663416,0.8764722740884338,0.02529017584915716,0.8274725323287967,0.2761071678329893,0.22025929713321146,0.6050390368750318,0.5303843810530785,0.1397990712408158,0.7770617684456173,0.519815225018635,0.5231841518426443,0.6348377411643363,0.1560018647942515,0.8510947182630024,0.47017217668331657,0.05276520240204796,0.2950540347712366,0.22134037555325592,0.4615680187865544,0.8995857553757425,0.41884924320731587,0.8765783094574098,0.13964088630853888,0.13767330710851755,0.9727171438395514,0.5452681707569623];
	    let y = vec![0.8415630036585694,0.6751105521486093,0.22952450405938862,0.9935849916227957,0.2688868902421194,0.1208651274262541,0.14174303279174105,0.41237354355586,0.10593315835831218,0.3282160108365916,0.17540506709286618,0.8373861830666542,0.48132276955370146,0.39158240824518,0.1960026629514552,0.09729233788073888,0.6033979491774123,0.4181440505353652,0.17734562679328136,0.8999493855514767,0.41833020758761374,0.4080073122647704,0.894736192325138,0.5587175159684062,0.5110397391148744,0.36700706526397464,0.20264224521729435,0.8548810752083986,0.4831047780614619,0.2746305164872149,0.08658257252291646,0.02777797340988941,0.578665838881362,0.7756086035325955,0.1746112888837773,0.44143940393294734,0.46338336787177736,0.44346771993981704,0.3211569552005884,0.047660257532603834,0.4223712349126837,0.7037651748377975,0.42942681319301623,0.9446690369036463,0.08593820627551763,0.18711616364482964,0.17495434812648003,0.2441447746121409,0.4393930234653398,0.8510248031255486,0.14317357790981045,0.027937933380689395,0.3830638899287193,0.46875681086996057,0.8713354932081905,0.32704219483082975,0.4524661873907605,0.060428195343111724,0.8094847272252975,0.05683856256398356,0.315176245747368,0.5982125151599872,0.5119199577045329,0.8205217190579862,0.5958759025489971,0.41686239683328585,0.40205120958639273,0.7065217668091308,0.3869194254587943,0.2852366302883035,0.6403660429889164,0.03605662961899647,0.699288968724133,0.9734551049276841,0.8696310161819475,0.28533522758680196,0.38991406716293,0.8584363943976414,0.6992781024238026,0.3840321836788203,0.2574110889889505,0.4890870089794186,0.13661590177996685,0.42201536468995926,0.326459502922927,0.304979221930058,0.6526738271103681,0.4713971705338128,0.9369249033837174,0.936482156094767,0.8041579101636144,0.7985423587351667,0.7144538613110847,0.07410934964422877,0.7051486935625486,0.28117535943710437,0.46024252922555753,0.49336226233650493,0.18312747917254757,0.4581020988186848,0.7693324358470669,0.35598566985597013,0.39379166314952396,0.5152133467944138,0.177310592415153,0.4967333366390826,0.27731962653078,0.7312672676152961,0.639797172940584,0.9324104478878447,0.11235911148406486,0.4878072064780541,0.41626072624348565,0.8332631411068417,0.7298924755923316,0.6451069956376935,0.4641738206240724,0.12343495346767874,0.9313894658508555,0.7251813433413931,0.9548146230460554,0.5620081596982545,0.3274605958816148,0.13918788431936968,0.4350735157928669,0.9452395632304079,0.9308489719625781,0.3642981060464987,0.7144422772049807,0.934775923615064,0.3411858338749887,0.8478468396134529,0.27651028165875635,0.2688799047271623,0.009885366419306374,0.895824495600285,0.3014487373465472,0.43700407067426306,0.9250279055256747,0.4686090000209887,0.7238987289434329,0.09957946847659027,0.5294300857222602,0.6564346604353497,0.2107574514452185,0.5687560640324197,0.24022684890635415,0.14269818513691856,0.1218568009003923,0.7285537596696893,0.2559876812441775,0.8259064307729843,0.5956690803087057,0.7624807311341574,0.5557571434002869,0.7635378058407473,0.35183671837237585,0.7191757568484208,0.7254984508287438,0.38643925696063897,0.16969718860984973,0.36876943932322337,0.2635567889793272,0.9398448119368886,0.49062146011920715,0.7282547201632265,0.4613585290215576,0.7911131561179702,0.7245403179056512,0.69828440281068,0.990749675324517,0.022922741406775415,0.42980266379465304,0.21240636628471388,0.9385721292033502,0.5424678079422611,0.9618469379794171,0.37922013328019133,0.45925630540987605,0.021915602974286075,0.08262115741135412,0.7998032884214129,0.1273095157777112,0.4702970657724843,0.8282826531169312,0.9079598882630138,0.3980116048079112,0.6120974633589125,0.5167271379454771,0.7275673940944122,0.5716719455689383,0.9721305285017438,0.27519977470291,0.4250196841227485,0.34111833470056896,0.08929517387017694,0.5232092846281453,0.7187433176785455,0.5058110667840378,0.5838527313338139];
	    let r : f64 = 0.030251256281407034;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_12() {
	let x = vec![0.7223161788509923,0.995946203744299,0.15527045295413333,0.5547025731963057,0.5728619102655957,0.14867992071431824,0.9031485927288052,0.7809163089191526,0.7475885718924066,0.5293951445943901,0.7215069770566275,0.9861173687701738,0.02325047163402394,0.0006362653152962583,0.22080617579708406,0.1111362985746025,0.7484825064952522,0.13701243337129188,0.6521129246330478,0.1633968177045576,0.653009632304725,0.8361287653457915,0.9326649077397574,0.23339141558110255,0.47447024986655284,0.792526883221597,0.8433072694227924,0.8704921229769753,0.3844640000500581,0.4206053424253854,0.6656419831450047,0.0744347543404692,0.7422895998685666,0.09103510495660272,0.37729293747775927,0.7652473186373031,0.5644905508150421,0.48633310861512613,0.8967370701728202,0.42537905113057717,0.7971457721990328,0.4774170338629615,0.17190440763311843,0.7957983579301721,0.2620890366443034,0.7381969627284558,0.1423869001086313,0.8947671394796824,0.9508558757950192,0.5509039762073662,0.2044561085175276,0.7927161269174919,0.9145483082558988,0.44083253242502707,0.030759405279159546,0.4032058129334495,0.5653792901420346,0.5780744081309309,0.9807580465061572,0.630102656871935,0.15678833762626943,0.7410280488710199,0.2747353759896012,0.32588531453586467,0.6314556692340725,0.1772021760490725,0.4910211183807537,0.5857945605104534,0.5544951702456942,0.5545212222433988,0.6145254593222347,0.7025767336861602,0.2464067236711407,0.3421205338000499,0.7310246455400434,0.42558238972155016,0.5562455561532761,0.6013627978868656,0.3029232735780074,0.35459063522868994,0.7646712871287428,0.4165748208259856,0.22499751056710304,0.6649819776527777,0.07493661954470132,0.004255041832791906,0.33614333641940886,0.07947775158421433,0.09110687077878554,0.4849097979835839,0.003967323558906721,0.38900305082989717,0.2990832527418624,0.909694595430616,0.17353153319744363,0.8510278501202145,0.39621565505631007,0.5615578758022176,0.1812414285430043,0.764059998321112,0.649629908853591,0.13687059015796255,0.19508804113100908,0.5104411563196383,0.8864916795909344,0.8166742613821886,0.3018026923842734,0.3513749374781098,0.15139522029274133,0.49173936316590106,0.5198099104194772,0.766254440285024,0.8381245076564859,0.6796545582602217,0.2702448996161475,0.14966913897582768,0.09235482422230168,0.3306964601757343,0.6619708665255835,0.1303905807833411,0.551802553636406,0.9946322339376125,0.24351172872576776,0.6739011704767859,0.5062752660493469,0.9611564979360847,0.012846095528031287,0.881322792516758,0.07647184997134138,0.1836413046082468,0.3803867445618083,0.6174998539626035,0.3061929148130863,0.2871011837995311,0.18695685335038015,0.17486779481135606,0.4748916121438763,0.5071019778262132,0.6571545488761317,0.19505568771105275,0.2519492505844704,0.3234105828576752,0.28643392341688034,0.7398267505924149,0.795572089189343,0.361613478755185,0.47897069464739295,0.6847523812345926,0.21031771058298832,0.5609034453232982,0.8382896691333137,0.827782233426785,0.38594265064204825,0.0908587030077469,0.11931487961202403,0.17380873984391865,0.05902919788110372,0.5679496272848694,0.13869351681176467,0.3238724339522677,0.07716073602737006,0.4400287212462656,0.38947528592498215,0.538335017992346,0.5592250442687678,0.5317442388154914,0.7405673521598805,0.6687460542458791,0.013204821379896092,0.3048083419079225,0.8628930253346894,0.8241496927060756,0.5956701160874538,0.16701509448359653,0.0312808771772084,0.4987944104916001,0.859508762901602,0.4230702266402676,0.5171278285058418,0.31823751531729183,0.8980937694012565,0.9244724032220417,0.4317275136716088,0.7691418162029209,0.7214797328405479,0.4652308992045283,0.4942908185697553,0.5008401942044465,0.39239912488230355,0.7764491300406118,0.6568455690421839,0.19312908739207413,0.9641783324967426,0.5197088070785785,0.6057587148277777,0.08531822382786236,0.5570938398454394,0.6675567088495715,0.6531413391525962,0.9351117982587654];
	    let y = vec![0.5911629392790939,0.8193218368120169,0.4268121866552185,0.4458723463593043,0.6063982893467454,0.28070022346447543,0.4921798748507863,0.34302849324241014,0.3692281375624249,0.10856842336706629,0.23956340550926059,0.9425351813092955,0.542073731190098,0.6308700565251696,0.2139323981584742,0.6689884917247753,0.19494452765240422,0.7667030909786703,0.15334461876155314,0.6438406669255493,0.7312245508734965,0.4330513646667514,0.3009777239454191,0.42501104325306327,0.48671574407646856,0.7848729565588651,0.009221810797287011,0.12440771554195273,0.7085319360226879,0.6567870978050377,0.2844276899457092,0.16390673985578363,0.4001849006032414,0.06164968151443262,0.024303173863657546,0.2516750316911993,0.3292399849935317,0.35959992623975434,0.2946349295617161,0.4085692089416032,0.4134899220074706,0.14340425116654587,0.012233869606836811,0.8138872659480886,0.26638658618998656,0.5990303537623032,0.6124165132757721,0.5115542186130075,0.7075113683936569,0.13671425432968154,0.7417839414770766,0.11279768179151084,0.09575201435175995,0.627383527398443,0.8832168564991,0.2974573377476555,0.36936999849571717,0.5418897280426848,0.48590610015330793,0.8689684535495531,0.15400265123258638,0.854911146125086,0.3399840179120188,0.24752176036801843,0.3545174768462591,0.8576083667776397,0.9575000939985544,0.2094148894148663,0.20569040993937704,0.2949826346892387,0.24184896579797377,0.30796518291114716,0.8837257046173173,0.8782587126511886,0.9658796629092911,0.5372447457384942,0.9135906951804559,0.7918875407795297,0.08335520614030345,0.8886290099731059,0.35689150984528395,0.4336153350397214,0.6966832827613302,0.768396806790417,0.24944847691054683,0.46416056725919186,0.5970322124312893,0.48330571655956067,0.5931889692959978,0.3325715484504286,0.8093855178654152,0.1562196242528261,0.9000955769338962,0.9299278166794914,0.6542430411288025,0.22583800821202304,0.18868242607403762,0.23136572628941632,0.20634187464765352,0.563556368216668,0.7238296331080937,0.12283470531175211,0.8403062233619273,0.7977048714502375,0.6802372881377297,0.09137873010440878,0.05917192364038926,0.8960705879483507,0.46881410901116094,0.3181598838905726,0.3216044758818931,0.6988079751334352,0.698450552336666,0.3671080625856248,0.24314996659390442,0.2007782700802727,0.4403167075697072,0.6655296350414005,0.577359676578926,0.6818089840300053,0.8359099353271211,0.5375562183821697,0.11697992629293108,0.6067791018505693,0.9106092519465605,0.7107904634914556,0.8412997613937642,0.41713500046618046,0.5693683845430478,0.2660499417646123,0.7622033215027639,0.6472516917758311,0.7662077131357903,0.5053066851859748,0.508924190458107,0.6106031819191436,0.5813988006405001,0.7046206916912369,0.04028794150050752,0.7857267003339594,0.4603658453267573,0.01844713282785959,0.3536418214835595,0.4495730752065935,0.7184973822595496,0.500323547958955,0.3559124567828532,0.8211460292161344,0.8423206435554873,0.19713126095319644,0.4357094236653437,0.12122831239563647,0.2890641311057669,0.7520384664864432,0.9085415111241448,0.8636963188507955,0.955219362594093,0.16237078596823273,0.6571924920275124,0.809132052486324,0.3154147863281178,0.9610638218418238,0.8470179706868821,0.20051129596110173,0.5339006224514445,0.15233099459112542,0.7342673441374806,0.6950722364093731,0.9475658821489704,0.48672496440664925,0.6439295627157743,0.7646494990651096,0.9157932070544933,0.9682924912277074,0.664440503119292,0.7953514121125386,0.8030691149293558,0.03312911008791397,0.8562728961157681,0.6759011821892392,0.0380184878064167,0.04039426334744378,0.1346134424206522,0.09751136436088759,0.22911919219768573,0.23161350758414845,0.7241434886308211,0.5182858920810434,0.13056723413741256,0.8384453886681063,0.9043428957906443,0.4209434855947878,0.812869341908508,0.9137906221414881,0.6750189737065871,0.9851273327839142,0.563320078697235,0.9774706004678445,0.03634718743733656,0.9183127704910383];
	    let r : f64 = -0.03889447236180904;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_13() {
	let x = vec![0.266372005874159,0.27395894402343623,0.581775212397539,0.9218760770165624,0.5604142485932557,0.6821187306551959,0.576965725507982,0.5646388848310143,0.794815230785566,0.8738623801989216,0.6630663190003194,0.5746337430635807,0.9971000750600344,0.809247663862109,0.501589714373455,0.23323564123303653,0.7373891646366718,0.07438790012429664,0.8650135132678354,0.2309109372315239,0.01753507264535692,0.5764527017333022,0.7529164011273004,0.4019694725590153,0.8364326270791543,0.030338112524398775,0.5739179667095571,0.4113653251998878,0.18664904682983263,0.0534834886608726,0.2285485838928648,0.34595631680622485,0.7562403298514739,0.534765496048768,0.7862202054859408,0.7317299275872012,0.8365657381706786,0.6749752373093776,0.13916026101791212,0.7116821381113575,0.3600250499877985,0.5381857348797107,0.9674536183793272,0.4165964471556248,0.11084922526584917,0.6676212387058181,0.8565285313037192,0.7578459267050957,0.8674787060699939,0.5099263254650935,0.2182515295210362,0.6298432485530454,0.134758736768669,0.4486701132837039,0.5646524902930896,0.7622698716055324,0.0039041499604310914,0.7107115064579101,0.31108541028126413,0.7328872649024469,0.7682134974999864,0.9986116581314917,0.04278748511744235,0.7547319659359228,0.06592191547506276,0.7990906565769931,0.37640862014465026,0.03451748284403133,0.1251734645154562,0.7212947013169447,0.4381184330768467,0.18003411174181638,0.5500592690290563,0.5559786496836957,0.09688532861085841,0.1456913850163738,0.3505317857997209,0.63219673492916,0.5431699518704883,0.1829540102528997,0.8638251642400274,0.04108880799123871,0.8812705347688535,0.7796044636939633,0.3762130670846767,0.3221327450807344,0.5890430091099843,0.2634034100462731,0.7694992419141895,0.7655280195320832,0.05440783650472536,0.8602801627348727,0.983484790663176,0.26286811760811435,0.196094121652306,0.6316630617811924,0.2696831532164008,0.5774077092807416,0.8922433794015912,0.12144403936461756,0.5819327233794411,0.39196228026536395,0.17469077202907357,0.8672737268970387,0.302486269670151,0.41538680288276164,0.39621503625871046,0.21901448384243716,0.9755913458882041,0.7017729260555068,0.706129922539201,0.05042447181173082,0.9518298811093004,0.6780252852029696,0.6978195928250702,0.5331672948449518,0.01969324269844752,0.30912714593944335,0.9253036491980134,0.5667681509705405,0.25099467949555354,0.15437375784615126,0.8691580715382844,0.7469590644516295,0.19492615692173187,0.7017036626382023,0.7599627188050636,0.44151830060968833,0.5475655142916129,0.04220840140706894,0.8686817619159811,0.1589402095684468,0.4505434355176581,0.47965720007212154,0.9367602975935301,0.2239529909115111,0.19970403699840733,0.5325172788417867,0.796095759113963,0.4636512491295589,0.6354085456261885,0.8551035286451523,0.547562429434172,0.04521431943705412,0.4810821462631282,0.5026186969102594,0.12946005642762537,0.6859295655217788,0.06668821135202174,0.2172645092231109,0.7696762529981915,0.2107106699450395,0.901928037665652,0.49424252014223,0.5047029896981076,0.3218474702550794,0.1423725729378389,0.09867597535893524,0.2765516329618274,0.6189431931059218,0.24884786800535574,0.0493662774344964,0.673024291519322,0.6309291686798216,0.5117304803285806,0.10183993670656866,0.38831353375491706,0.24210756875185224,0.5780293617890336,0.1364475886572467,0.1840210868783292,0.5540495108141655,0.1699037840144174,0.2130973186368943,0.3915359436442233,0.024637025696510495,0.6187930176068019,0.01646296317413387,0.257805323894411,0.30825625836188775,0.29936024352610036,0.7087728911939108,0.8246732249858734,0.22430634185491072,0.4488945881482457,0.07925648998997947,0.8790193441085131,0.8409214657432624,0.37775094716099766,0.21127186115182028,0.7369881382512521,0.8640168653693037,0.6648698487738508,0.22868935115380162,0.09397402653779463,0.5158209232924574,0.9201452037234773,0.3913497738587054,0.8075535159067235,0.020851113892016104];
	    let y = vec![0.848876334453334,0.4922111461801305,0.8586676658576228,0.2239783431905631,0.504904898709164,0.420045789665775,0.06414626064403395,0.10623586645512262,0.04354145700494694,0.8733998964767002,0.7163461098562439,0.8068385103168152,0.16578593520573448,0.026330392847110473,0.6779026618313819,0.4028675554065526,0.4389030219050042,0.9285984752681123,0.5754409958020384,0.8191291681162103,0.9167523267778314,0.3197521316328993,0.41300162545485875,0.8582425892903647,0.8128679775146608,0.2356894972000757,0.70041876087794,0.9722456644079571,0.5721126229510056,0.28713811647996235,0.48060985807924217,0.535785326301299,0.6668030482020354,0.35386793675431305,0.5587561246329666,0.9197718231000653,0.6156555255882592,0.8129775739018638,0.3422090424029992,0.15528009551710786,0.975994315286782,0.6897321441819931,0.07742417598749662,0.11743621663441184,0.9763349481792124,0.4603307343902435,0.8953953215879924,0.6544636361295584,0.274738924069302,0.01982092703116589,0.5950299437309488,0.9476806572235474,0.9727391861376492,0.6128140321839722,0.9878666000930182,0.8581728327050906,0.7731197286655356,0.49300969981487974,0.3766914741121523,0.2180907315790369,0.4537967868945082,0.7682190838321413,0.6517183307851151,0.06657333223770079,0.7096551888226176,0.01548003252917829,0.6564573883713154,0.3439904819851698,0.6650010517642568,0.25872732045646674,0.6205785704639433,0.9828214297366241,0.285207011893041,0.17379929555534035,0.8460883664672925,0.5532519960311801,0.09316994550840985,0.05526548260969444,0.17322721431188615,0.9820299285978266,0.7722949170931742,0.05000865221393269,0.7412546463843457,0.4125763459312183,0.8704713480116624,0.6079510800940405,0.046647660496494936,0.13718960430607696,0.38138093521194805,0.8398256263523043,0.6513212405716041,0.07427406297274408,0.9841863733720531,0.8372955433901772,0.04300206369137438,0.07710871180543466,0.11382539078613141,0.32655362465187043,0.5524588054619745,0.5294057682836094,0.7498202642802273,0.505845409622611,0.6244115834861257,0.28455209534259973,0.041353409090099325,0.9353245990576932,0.180184438701266,0.7015333510952843,0.021856618754162338,0.13413746917063052,0.8880213887323902,0.8766499625763963,0.09747504388313277,0.9955501430802073,0.3052344834027446,0.5232331916613902,0.5139098379138348,0.45525746199173633,0.25113327472990665,0.8451030230443684,0.11324479913239349,0.8345560893547008,0.08883734769748897,0.1957473168110636,0.1575314768844127,0.3393503531519835,0.6442802472642768,0.49549681232313936,0.8634859935825147,0.3743694406000969,0.038276025101818045,0.06402237068714056,0.9549102785327735,0.4863025981358635,0.49207310050151454,0.47420458883400085,0.3028171651443706,0.8118220377424743,0.21341302236423576,0.7244109014596174,0.0620014505457116,0.7404053177076535,0.4816074267087964,0.9045150814340567,0.007499614326420989,0.8214928624937895,0.5197490290806667,0.2214506188729083,0.6546542019352142,0.0373000117199459,0.2748606244259143,0.19933870147191002,0.5947965701346735,0.1035653931663697,0.28466175309058483,0.4137894364116933,0.9766897355715713,0.05897163010982731,0.40410748758813597,0.808490600581664,0.0803757851775071,0.8680882455379237,0.3594656489462529,0.4161109122349853,0.1367711079736379,0.6312719630699322,0.8145167259499895,0.4411376424690079,0.3309949410398697,0.9339738101732891,0.30198721452139143,0.8592199953775196,0.46736051837793846,0.5753475339692805,0.3135802371368277,0.2861234706846465,0.8376921118591824,0.2996552245517834,0.40208192773614115,0.2972720888242152,0.332926370137437,0.7475274214221428,0.9561340346957229,0.8969082586799579,0.9664465927592599,0.11389810819570101,0.16832332480988987,0.4335132542796015,0.07203361502357875,0.18438494781171455,0.22813920597417503,0.7395190558648548,0.31195499576452435,0.10833568731524279,0.08402722792210049,0.43529705527225704,0.9272943605172047,0.8224740401214966,0.7931646661048952,0.23462542768626315];
	    let r : f64 = -0.05949748743718593;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_14() {
	let x = vec![0.6006952778003372,0.28680701692761257,0.9838204774056233,0.6452285483658218,0.5700609607099019,0.5050822818605291,0.1987261678376696,0.18451131728565284,0.34956782867532366,0.5743635699817093,0.6479013868421178,0.476113154373772,0.6982514079692346,0.5710929103709951,0.7451413295672924,0.10438936673888577,0.6056119339106073,0.26160787002038666,0.2859805137331647,0.043710963579472906,0.8719311458274072,0.3784506359686125,0.5285877708163398,0.7640487084354967,0.6599660963211086,0.9021061234410823,0.7869452987052205,0.6904276914861657,0.890107872993828,0.3731952876941217,0.3141748103375557,0.2075253834704529,0.25725208253722054,0.4685471406409687,0.516979679429931,0.6360771124879356,0.9894348184525765,0.6308282286467624,0.5398495666080857,0.6642599234264237,0.5464830611327373,0.8845047544905795,0.9529627196788646,0.48138515849392227,0.7073778513617128,0.2732326732141016,0.5713770564063188,0.7383194336808789,0.8048503922912784,0.5409024104472852,0.4344852216914491,0.7948119493535096,0.24128656127412695,0.5864293073994985,0.7051113517221095,0.3725199864025983,0.5390779757197388,0.7181466047009282,0.7451947443911725,0.3999392450329362,0.19100554015457383,0.7481644559046406,0.08045172562429304,0.37026070628370433,0.5020258593484065,0.17971361461469548,0.7879635328889725,0.7559507358758003,0.8746270177914947,0.9021553933947731,0.6863052257303219,0.2165971708125235,0.5341703245529799,0.8612567248142203,0.9724907888790695,0.057317281287114,0.2839847145461504,0.9128414402216284,0.5629615191056716,0.5106996560566894,0.4438402538727778,0.5302814427904945,0.6077477998524591,0.808202067037258,0.3025918676023506,0.5235823378392491,0.141704418675337,0.38976616037144374,0.3839480586008911,0.004502481892327159,0.8023684812115105,0.6547311610955051,0.4108738222215401,0.7274841210914215,0.5302591171942234,0.7619961950300391,0.2924318648404969,0.7451301791434153,0.6634371596476419,0.8316641928419437,0.2696472009276306,0.9255459537861681,0.4841735056329587,0.37414774815757,0.46591463486032936,0.4427814566670534,0.5372764987713838,0.9363469958397802,0.04821179680689125,0.6207936470603713,0.5957847631027203,0.3374958010873199,0.03813332208553044,0.817459883884229,0.9639010661815963,0.6263677952480211,0.8504098623418186,0.6876706472060068,0.6540609577467492,0.9844923232105407,0.6886022960966169,0.736636505774704,0.410318965782245,0.33354743641352813,0.11537733207888556,0.20053644918764713,0.2894151829800572,0.28961339840944744,0.07159444041089891,0.944851435041434,0.8536779408410274,0.03566238440256231,0.30503741644463767,0.06076245616561338,0.07982783859036291,0.1702843258438851,0.729585568103347,0.1925794844628559,0.3435108925162187,0.4413247876102867,0.5611885803160583,0.9186752801671476,0.2893395082730823,0.7494865600847345,0.16107701261082352,0.8479329367207454,0.5522168771954854,0.3358339882258582,0.9893793172982819,0.7878410700264851,0.9745449202630608,0.6697013461495721,0.06113588952784077,0.19983812754045138,0.9951910110446968,0.9737964601818102,0.6799811259274632,0.5337968262776516,0.014244204585321607,0.4772006462767697,0.4371457115064403,0.9065163434762502,0.013106485625088427,0.23130556461301743,0.6210811867501168,0.6974147017179225,0.36143636869344165,0.6292987654195554,0.2688297720018227,0.99080530554245,0.09238585477405215,0.07682688384097613,0.8571296174449492,0.46216288642289727,0.43248556736185273,0.5902238582325564,0.7316317393313916,0.9832451625324576,0.04535350373369762,0.8440110464201992,0.2569399655412976,0.41801323819584324,0.41362436730060725,0.49672925014016156,0.7523724351441015,0.6202805913466564,0.38209509186151613,0.9229707459465437,0.9461953918088126,0.593478826104184,0.1953453125805631,0.2542730831482759,0.5073666395233597,0.34018684477994576,0.8359800498200063,0.6751403330022291,0.7112494276092194,0.2308217472383861,0.6780869172216052,0.5531602118961207];
	    let y = vec![0.47995855250475916,0.7178895766925442,0.6508749562739767,0.3422528910120233,0.386234031082225,0.6064817989163007,0.20529513605941896,0.5925250738313504,0.4133035176887965,0.4306871205896623,0.016894229892931545,0.9156605474836733,0.33573528709953837,0.12920378118114995,0.5755264291858344,0.9505384117748638,0.9966568197991372,0.9463038905538902,0.8047071835735506,0.834602855963448,0.4356924016398668,0.9080426991126734,0.42333766451202337,0.324102861656798,0.2509849655192259,0.36544004319837464,0.821651659217658,0.39199533006025455,0.15245281928559162,0.21297251888121715,0.7420071645368381,0.21692199568222315,0.5030634092596616,0.2885361693738403,0.874951722563134,0.9524362833365292,0.9945727097525877,0.22663394482185484,0.8927596831454372,0.04604012168025151,0.9007514502127295,0.43078698359650724,0.4732428367784032,0.15467122309117887,0.5765544016075809,0.7449097455720187,0.11928900025195566,0.23431503865256798,0.541803301275895,0.5687492819475441,0.2259157180484016,0.5867281919002972,0.013936217991023181,0.6787717156979807,0.5135634773382637,0.4972743771824746,0.7285784830604187,0.3558597794487385,0.595313187625107,0.04943133267953059,0.1175787341623038,0.7986192137546038,0.6722003934828542,0.8182396648784626,0.08478157793249641,0.39639939767495147,0.25102715387568353,0.5601025065056734,0.772406673617428,0.8679013931180701,0.7038217996658453,0.8942897251441004,0.21275966102414667,0.8373844630688755,0.8380785423395791,0.8136912948068024,0.5628098943839966,0.45077362347027483,0.2889206759870937,0.4839255522807707,0.7930526394777224,0.22737903480630894,0.7832774941947394,0.716670133390666,0.9566604830819836,0.9883316337129868,0.13053384363133402,0.21785325380745713,0.597284848417828,0.8084835218732606,0.20209784249839013,0.15633983507214222,0.835150786709525,0.8511658466124702,0.9150932647111156,0.5475762518150425,0.6462562575530201,0.3335888226754251,0.5015041534643517,0.780773051428555,0.42992197116219566,0.9311518135685333,0.7036575591904269,0.5680984624075863,0.6306732942782188,0.04239582022646404,0.6365804237372086,0.9724180502746204,0.13821677846589642,0.33614011338559135,0.7791720018583154,0.5423381363429696,0.24002723901916279,0.1456429744508264,0.11708440344399973,0.545099379363343,0.13194382699390594,0.12185654268679502,0.7903572916383227,0.3299780354894075,0.11893726590353793,0.11909326859815172,0.7758719132768589,0.22496785800585617,0.5404541970090899,0.22239838706804183,0.8882231987762347,0.4304690428598278,0.4991804392857724,0.5406860258609756,0.11082392047209633,0.6123900052627962,0.5270133315747875,0.6013963795103706,0.19140851365865874,0.33195527176570716,0.6243264505439251,0.4140318862261384,0.36120520751268925,0.7065211879755628,0.47403433154760666,0.3979401226663518,0.5572750818425939,0.616545855502633,0.20052501189876515,0.6676638026009841,0.6062853118386078,0.05620086269561542,0.6479080820169651,0.38365237792896256,0.6821426258618405,0.36579664047405436,0.31582712584001627,0.8799682623735472,0.42331065856276073,0.3131289598702295,0.9331916622535505,0.8428818400051138,0.64085386189032,0.8807172676807041,0.17304162046598515,0.9585700767888733,0.10113761867495297,0.9434242443572323,0.9812217767855551,0.4553312727323978,0.674958029952991,0.41157894143362095,0.8047705073757045,0.6606956242766812,0.26995701369177705,0.8874470556600321,0.7848601398607071,0.1869091061079824,0.8384440848993739,0.593007899897871,0.798714859299998,0.7076128695191327,0.3862857407422482,0.8646559678663807,0.554589117716657,0.2892070037484551,0.8110604544851098,0.8288794981272959,0.7193486570919102,0.46424613038356544,0.3562192563736456,0.25467198612490594,0.46589745387256454,0.4556164273972356,0.23976825976769556,0.9654330612955867,0.7222270058809519,0.6805597263268285,0.15987820021201682,0.8864643964572758,0.5802465504813349,0.5248224125773773,0.8533955675428558,0.33976985681601457];
	    let r : f64 = 0.013969849246231155;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_15() {
	let x = vec![0.6143507649129386,0.55169058332224,0.6981860059920276,0.032305808079394205,0.8076853290766776,0.8208631618409503,0.27376835044425996,0.6744999639197607,0.22376823927780565,0.8544716596878094,0.14253254503537738,0.7445135722904719,0.7721574102750548,0.6250689914141456,0.06440995762898993,0.9110282054604711,0.5936119593398932,0.15649856260732842,0.3289973375304214,0.9815139294547445,0.023974531756069006,0.5089897978983807,0.8301568563602199,0.7675669752990512,0.8580275285050533,0.04097893216136339,0.8216912682370034,0.9993628518879748,0.9752283073587193,0.9016583183342121,0.1298810546154857,0.23901875640575854,0.9589298789727019,0.848202492567035,0.494003281341604,0.8124519288273062,0.36683153412300595,0.3805915016975133,0.9125540860084363,0.004974633490048008,0.13631896315289016,0.8386303997044011,0.36195786114767436,0.26184928959096565,0.5580695870459184,0.823399831324564,0.40347763445141616,0.8532367798395515,0.7704733237341126,0.8648385966460633,0.821983412991903,0.3892274224744384,0.8349214249056981,0.6910254011519222,0.6371594895167153,0.9151760136763978,0.6590875928040054,0.5497369448220897,0.3448445004189038,0.9507291735864329,0.10251286584779151,0.6886302067641412,0.6552893654243516,0.8938596652340136,0.3326830829801364,0.46292686448724796,0.018914500687451374,0.7390398890115615,0.3494044678432542,0.6895513567568906,0.06518370392880257,0.6827410118411137,0.018214559737445013,0.5027066911898266,0.17356966835970533,0.2533969948111042,0.19460501718355716,0.8314982109200888,0.6636243014863566,0.9082357280346689,0.39035378600786097,0.14867254041803757,0.8146722392540882,0.9768230089856204,0.08745188459729081,0.47002493679996027,0.45092991504796354,0.40566370237550464,0.36667222970804836,0.15613582204811172,0.6472513183344776,0.3946271418441907,0.4357084008824458,0.07384951137052109,0.12248374329416312,0.9146371587487588,0.664456594182845,0.3930895778549883,0.7974336568064253,0.13227566631994547,0.9426405472601853,0.1960649424309887,0.6908877747113779,0.5435258184027784,0.8737915492982824,0.9398871773157247,0.8480543160317339,0.8846996631489302,0.028860141351862212,0.5067753918608334,0.8867381292211132,0.6113836834734284,0.2392891265846787,0.9688833036382392,0.15711722210212342,0.5678724120622474,0.672795384381048,0.2104299841058579,0.4378644207879495,0.22294134793283082,0.7699708894254716,0.9254018570101078,0.44722013589366927,0.24794726887004748,0.3834696427636882,0.9994896529560152,0.1571893620724344,0.27662465844409234,0.9451279705232876,0.22628350636114514,0.10498245107573434,0.2132103393403264,0.47714310814138117,0.3190699165105608,0.7083657719189994,0.6500249933502052,0.9258421191216718,0.9186972602555853,0.9309509540239324,0.915485006269927,0.9952444283273406,0.45331873127010636,0.37033342323061025,0.4004121179377994,0.5330217252721775,0.20336127514164204,0.9915285248224353,0.8378392611369868,0.11707804240353659,0.8940847583518194,0.6277031070851948,0.2599315204548658,0.21027639806841192,0.32189939072751883,0.5994436678407009,0.09560038940656279,0.8254162497783301,0.8325138887464323,0.6485877429171736,0.845147321721578,0.8748847555755411,0.039610623440424875,0.2525551614244297,0.6137405299796483,0.26985912894595443,0.5460113462043744,0.21845457122427292,0.8232757080000009,0.23353185576128133,0.7602275397413752,0.09765956229487582,0.9853206549851973,0.8457947010758776,0.24022271056266975,0.5225552733182407,0.28677119740012436,0.957281397725353,0.2892913507932877,0.5771738635324358,0.8302634668213655,0.8355903280799861,0.8825852510350511,0.18198654098562084,0.13167505222006182,0.3921043966230129,0.10922916480829192,0.30788893903590075,0.675149249826894,0.93792912080887,0.03197712771909467,0.4494922148243352,0.5665016893844392,0.6266911608047989,0.9146576555985094,0.8393629242012348,0.46004780803894496,0.9943001298759641,0.8459270756772791,0.15292881333186437,0.09523060589097443];
	    let y = vec![0.1086769538899619,0.29259943061457927,0.4482951427518399,0.11517122553306347,0.4273876935295864,0.47082268244310643,0.559130132301579,0.7895677471773173,0.1626226215569906,0.7356900759902938,0.47933953558453835,0.2853948521649493,0.29776578965323164,0.7655497992536848,0.7634060560166115,0.3598103213668278,0.7109886738122662,0.3697441056656475,0.6054938062687958,0.240218588346801,0.6289789620150061,0.6655902047197034,0.18457642921869966,0.04634376991010092,0.9092911952796799,0.16807764614280596,0.03205575511077974,0.787142961500361,0.3247822956136347,0.5166465116098895,0.5994395432363318,0.37531305230119405,0.1543868974165712,0.5487157753795607,0.9355039926868715,0.8891706088262027,0.6057467549540512,0.30517086679999406,0.7061343096546928,0.5797243924446406,0.20515625689758066,0.5930672434223048,0.1653587305765578,0.8531963166368831,0.33769315065052274,0.637130621044722,0.3745748260567753,0.6252997403795073,0.7856579507406488,0.11565565757247498,0.7205650311897789,0.6711607775263311,0.8877223202696821,0.3227056689532023,0.7615610810943451,0.45936094858136134,0.7274917772591404,0.03431497990170673,0.486041865430072,0.37204678869140473,0.39671090856811675,0.9410131206714313,0.758769687798572,0.9308372559460706,0.3447463133993146,0.8426773474410553,0.6115287509641716,0.9913218072846754,0.6474437060200534,0.6769830826473056,0.8569539619916846,0.9848026368003311,0.5674896121424748,0.030186209397383812,0.9011355272778071,0.11999823930540865,0.06225077360173936,0.6861614527820257,0.7230536010349788,0.8896206533811987,0.8005230721545186,0.7361977067112614,0.9478831853529548,0.5106218820032703,0.30248000773699424,0.15618872393738192,0.8474833037109075,0.35231355716353974,0.8216002755529842,0.9620808610987995,0.6523410411135492,0.6633978378475242,0.1464494033978797,0.8961536419354358,0.5629659422771669,0.004105445438694955,0.09804165994582204,0.3134149049150232,0.7519233197406938,0.41336820555543097,0.6265802289361684,0.22964558218796483,0.14428997132814347,0.7988117759382553,0.7669333703911175,0.955506985326967,0.21479167464845617,0.6873611397331933,0.15497112889006104,0.7147125633759039,0.45008230631543356,0.04884631599540412,0.8391108383226833,0.17550276693226907,0.37796048359328094,0.7064558138242144,0.5088332293209937,0.33764961070326505,0.2003839013600307,0.17484635722170638,0.19314394154516412,0.2360394586379465,0.7491925779682067,0.420776399298329,0.9790667761317853,0.2714891686386701,0.5687141036199,0.22439729568131284,0.6034087343362365,0.5392073755589194,0.008982916498906035,0.4304446701161023,0.8464195597994288,0.6575371247737597,0.7427136767787575,0.08061797522064984,0.21141273352689038,0.6017472194216439,0.21345458030095188,0.10792307158115344,0.511847355266332,0.14450316507840444,0.06911102283984416,0.8507315776273527,0.4787696437974174,0.4916420495607554,0.518688828024782,0.0291087102669505,0.9492522938783079,0.24322586520507983,0.8035511057898618,0.9154572329384669,0.5101459998073903,0.9040237959428017,0.9733715602709457,0.37986996808857776,0.7443508279250276,0.6274170301896893,0.8534681633105391,0.9276580734964349,0.9737815894568187,0.2414446773186102,0.004830304478292691,0.7399776481949604,0.37439507156506324,0.2356143279551437,0.6231136750681113,0.45524494447246544,0.6421906086979208,0.3773193202891725,0.5531861148881856,0.7117635811332651,0.8947481815843903,0.8052094891717646,0.19505295865562233,0.529415710207568,0.3758794679699443,0.35967519861830877,0.596749418253515,0.37343812112674746,0.22497682319243995,0.8114739985574755,0.24327467776493816,0.6154498997188161,0.9784345310752481,0.5656419783266051,0.2615027221154602,0.07917114638873202,0.10773610648216081,0.3215170028871577,0.30323824848464676,0.9446121997519564,0.9896805561246235,0.7269120122986256,0.9203227326986606,0.2961395192099644,0.8713776885211555,0.4430030798056974,0.9853189602070894,0.1949145317879929];
	    let r : f64 = 0.02673366834170854;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_16() {
	let x = vec![0.6788894596112308,0.11808521719722687,0.35503092853450735,0.6341528439374249,0.09189619257699844,0.2698451932443152,0.8925753432988317,0.9793493800453976,0.6405404579861013,0.35813151126345577,0.5847003151470795,0.4708652070894054,0.6047943833281815,0.7645795386865478,0.6451472366411112,0.3540535375588637,0.640103799421008,0.08829579774765506,0.20891611705045554,0.8633356159189673,0.4178383269021225,0.447530405196511,0.2435854627861057,0.6509895678333982,0.6479587218465716,0.7113167318999423,0.9923562552149453,0.5668067179393721,0.0726052451955076,0.4118613775879475,0.9338727991160779,0.6682300671609394,0.5570610225510834,0.3304597673057448,0.9659803711204038,0.698618803366349,0.06933351947844912,0.026059231457515764,0.19631856405147186,0.4676934264513468,0.7206408877151896,0.03884855443864177,0.2602673321289155,0.5770146229650137,0.2361112325134198,0.12712419114398954,0.3508338620003473,0.4842929120444217,0.7088754068316183,0.9742807273051595,0.5973114735958344,0.8739412694726942,0.8428122866351972,0.9671438503038704,0.6170717949609288,0.29637197880623556,0.8709843810465167,0.6000326416484115,0.8340267781300669,0.11200561508283702,0.6981089497556693,0.6384286671642102,0.7554615107148733,0.37818729467136536,0.3949429341988705,0.14287601345348655,0.5828726356804155,0.592805954674195,0.19242413111705192,0.2691896514870349,0.8898292523459913,0.31968630772488194,0.030161387441639764,0.5490988005260181,0.9239657744793246,0.5009146143952109,0.8216036105120221,0.3765521508411178,0.5277846967733485,0.030555587588550037,0.7665526126982611,0.5642387487182755,0.13913735394285576,0.5855833169731947,0.42146441957729186,0.8199472914865829,0.9724923694007119,0.5443372023454922,0.3032304832103998,0.33964676932945237,0.4967436969015617,0.17255497624693783,0.8512008679449979,0.7082490501992824,0.951778483257076,0.4084506548535045,0.9815514248572731,0.41757777377659866,0.821980069606732,0.015220678294863732,0.7909564209750002,0.533717083545547,0.5155888248805973,0.016540119694627542,0.5670928023604087,0.5772701931160297,0.2952761400117401,0.17039511378865824,0.48798095039058065,0.5967831207684209,0.6214226827975109,0.420935070094158,0.7073925549020159,0.08045179933853541,0.05629369738930756,0.8731412761451391,0.6790193577142529,0.7642317671044321,0.9833309525816786,0.6422085904920527,0.06792721529364854,0.6862410004936735,0.3724011749015108,0.8659508792046088,0.2201251746307722,0.37300988263287227,0.6369424435789816,0.5329238156034924,0.7162237495799767,0.7455215268376967,0.03979296394619092,0.8921265102384858,0.910359450983655,0.1794191533863302,0.7047775174673261,0.3763415991596717,0.5429057310683423,0.7718341760359174,0.8658511635172274,0.24132715363377844,0.9017889894341735,0.674584709375512,0.5544216269795731,0.2348126848410086,0.13990833999056906,0.9572695659859982,0.4580756662926341,0.6526883160398361,0.32084389671721236,0.554477548123101,0.3162128829059475,0.7464613472524451,0.1150872042981822,0.06279725442559159,0.9659899234196221,0.6294362233040904,0.8919334295824839,0.33817981695331345,0.619539835164942,0.6923383867024354,0.9731662859320132,0.27270756994292045,0.055271825080324466,0.8873686820388718,0.9852718607957169,0.15917235923853257,0.8067527121779483,0.6961676211288857,0.025630168285836752,0.4351940263249352,0.9206403737252106,0.37742949237486156,0.2346093485920724,0.17741954430242957,0.20439269860337372,0.2493908089634348,0.027053021139661237,0.9509661238916608,0.8761083854736105,0.2992536805099695,0.9950875084794409,0.9473015702596302,0.3946242425116744,0.8906987393329705,0.6029133653800399,0.7263517487999654,0.02145786429697194,0.20922726109990875,0.7392122926217565,0.31043001434890116,0.6460072245521209,0.10083536113803959,0.865364760316401,0.13867028350044108,0.24023478092553263,0.3563892904315392,0.96297883772694,0.5330853210681925,0.2941185735083668,0.2667689280919183];
	    let y = vec![0.8335825861355126,0.6492456238387317,0.7158288148327584,0.17630552458904247,0.23903619009145638,0.324161922584553,0.014888081808540177,0.05671872663385935,0.9747771094368614,0.5715882593681676,0.7811793727784022,0.7882983042736419,0.6167434198972884,0.2822237508008436,0.4608329720579085,0.5267731469383369,0.895321378949803,0.24793926920583964,0.4601613211966662,0.27312920368266214,0.7075785354053028,0.3475224479915304,0.3846758461312998,0.5787256078787663,0.8281512351797556,0.64249808705374,0.7401286207494566,0.8182742150348874,0.05545954084701843,0.4103386613490353,0.21061664488489018,0.6312420523346448,0.2524101820509723,0.760471385670943,0.18969860347468448,0.4398021522228639,0.5486117429382467,0.22048738645514077,0.4261784134430402,0.28353202086893914,0.4395417728640164,0.9232992657089335,0.040875042847056786,0.8654257483762225,0.20729558948501614,0.5902404435999767,0.12168730412347406,0.7308797944520844,0.11400899223829764,0.42135791626848385,0.7315424890294588,0.7600546563170435,0.21262970158694428,0.07297301184699956,0.7779723423149294,0.46487962907459224,0.9563590192561756,0.5653326463042471,0.1435845379962165,0.7774961575659612,0.7233982533262807,0.3112386196839577,0.1621264899894187,0.6879966398444742,0.7850215219251252,0.5669753224843568,0.8535170273219134,0.42712014410559196,0.015798799523632723,0.8783465983803205,0.9497001509117186,0.4788318119328625,0.15966298033590443,0.7971757310169274,0.4486734570623594,0.5932177661326383,0.07096976198508231,0.7963044182070832,0.8362155963299865,0.4628380719337096,0.1967223926450572,0.5026555674079426,0.6647202453475798,0.07480191085985866,0.12418546731523761,0.07075372013656012,0.6635502613574493,0.9932273519505592,0.4410194347412265,0.21208121493965515,0.4449350549250781,0.2180687325727031,0.5138466853230779,0.5184519257385666,0.5736371267840462,0.6557838324558561,0.22994674095283607,0.946766870999591,0.8300235389097667,0.8765064156209951,0.48580738694481507,0.6082742122753811,0.21909026989846747,0.9890184432773598,0.4933807626580038,0.9733345618416257,0.49639424150234623,0.9963130844988972,0.05454562989755163,0.9586469555704419,0.21990285109905805,0.7223685903521003,0.9347786870642529,0.490275211757511,0.6937176421497916,0.46252392444964063,0.650196111027207,0.45937458454836444,0.3923141715625834,0.20960668484340395,0.5814204585100028,0.3380026734298247,0.6278448720321097,0.6559234824963726,0.6843924160623726,0.2925558122313644,0.1398913893121333,0.27299585209193344,0.6398500021075496,0.17691887833049402,0.8789431764836818,0.4526982896329522,0.14515472797446083,0.5461326833958791,0.2219542529175158,0.7304479474762811,0.09090466491642735,0.4958344770102646,0.27471746715437273,0.2588478647124216,0.0743184173682111,0.653892572312046,0.6965183121631876,0.47647400329060685,0.7262908502155059,0.052298648926710434,0.694660745873319,0.4140930024215639,0.6081813591321446,0.519881096209713,0.38802211071783343,0.5571803950920549,0.32595369691223763,0.5000597721883587,0.5094693964236992,0.07735499246053656,0.7647644394636682,0.3927317623011729,0.39289599462251745,0.02688755740593385,0.33372660123712905,0.15075839397303925,0.004477390207234255,0.09685866194922743,0.34704934563679335,0.09126021128571327,0.6213936028943965,0.7379064704387479,0.2077893216832255,0.1766626554636208,0.687689263845323,0.8438806058867672,0.12470737573102497,0.6340526402806709,0.19318855786280986,0.15878525790674292,0.5811936727682938,0.7437627470474375,0.07625508484837462,0.647628700063939,0.4073304839224383,0.14643643861324107,0.47200386201073896,0.030198801361705274,0.9352059567652763,0.002587952863330245,0.07842502339469326,0.9515485693177321,0.6621832076916631,0.5604758466177676,0.8857476566233233,0.9083401891341436,0.017599094126113157,0.19081417420312652,0.7539665442979482,0.8519747844215817,0.8699418117443071,0.32904333232763605,0.6827566289538314,0.857878504646375];
	    let r : f64 = -0.07678391959798994;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_17() {
	let x = vec![0.15733262474558785,0.8862012663000116,0.2987803669860588,0.19350341884087008,0.47991525125288315,0.4520565971124827,0.8731895901320653,0.203442610921153,0.8379296633587179,0.058096026501983866,0.6526221265120713,0.07887533547360004,0.7475318981779825,0.14310650774796407,0.8803944307886512,0.35513817776210255,0.5524773633921477,0.5215665438962805,0.8221939655032591,0.18045021861582056,0.6439624192362712,0.31347715960272293,0.33056727800737584,0.9430085420104177,0.13629166084557465,0.8884001462485105,0.2520219690581572,0.6813122692253923,0.14378961066440465,0.26379758466882675,0.6317137960520532,0.7713771869851799,0.16356789785796977,0.3817382210564315,0.4727771830673012,0.3054062380581244,0.681717421497495,0.2605450378492552,0.841173057554385,0.747440307843855,0.07972620125783647,0.5662298834898201,0.05368492659618329,0.14759087094824797,0.26212573063696054,0.7345965726996452,0.35237172823809193,0.11835395143351535,0.32174609562840484,0.836343420552072,0.24217045224403932,0.8060010281874724,0.34264407632631544,0.6746545344369426,0.1058792568078486,0.7442978255377817,0.29366036823519714,0.18187621101488405,0.8923222499672359,0.6992075159601375,0.1387800134416486,0.4255769349739652,0.9128206392248212,0.0776238336799453,0.06656285745404189,0.6088877283186573,0.9678069206620675,0.27159604980618246,0.24384778237424765,0.062405657316239704,0.5619070989321989,0.029192610591208923,0.5037737568762849,0.1274881374080098,0.787689089885287,0.9827686555799323,0.34411593850859923,0.2728008905208046,0.3326603044189168,0.3097773065451168,0.8931437525404182,0.07944956348715804,0.18913055647754606,0.33257968298709684,0.16734082177542342,0.15198601206816875,0.6889057924368558,0.5778539290337366,0.6129494799193107,0.4235421588721412,0.8870242971097305,0.8732038964578951,0.38665846574399654,0.3087499306494148,0.19655101716742318,0.015713501853172995,0.511558696511633,0.6230427577500651,0.6619651916908961,0.0739485930711602,0.5141066295919557,0.252480241904681,0.7002605619544053,0.78558994350511,0.7606553099812569,0.0073859107573323035,0.5416513879592706,0.8659108163027514,0.363465269052619,0.8246937040322508,0.9907200101332246,0.5973306195547756,0.8104730131904954,0.12216798944701868,0.5998823751573495,0.5978569061794949,0.7189804920981828,0.03607906708354769,0.45450013347874885,0.22114971670723338,0.8687541559067434,0.2940420983801515,0.2698763760174073,0.5500236821356391,0.040907032793390696,0.4463968387473922,0.47827900319490924,0.7095719732973194,0.7926757046933028,0.8497737721897213,0.8517059089545355,0.7725529335870824,0.8845196629194951,0.5272999709988052,0.15932701493124757,0.9334134430271879,0.9986772307574343,0.9581090303676673,0.14027428389196117,0.6612559603575628,0.74974577522626,0.3825241493596575,0.4406829635510574,0.7840138348127509,0.5660686939940882,0.46186795834493477,0.4903314711374738,0.2460610281335882,0.3612487128367736,0.38607832702345535,0.35704397685716005,0.825908626062819,0.07073434234728682,0.7120498592284108,0.9792182559946652,0.45268234192389945,0.09051233853953322,0.5818852435281134,0.2778911471848331,0.6547387030377881,0.5607315954318436,0.8078071629960252,0.3867371969687675,0.49216619928754024,0.7943408248334822,0.3667974430359956,0.7173366492692407,0.3802937919581598,0.3953124232242433,0.8897005090861789,0.9299848227070475,0.7323172830697752,0.4974850897263219,0.06571327061886312,0.0641743503516683,0.8272960179377069,0.20029106847538725,0.8932517946684514,0.4915226119074363,0.21778908584307066,0.9452922220101638,0.3573121950979654,0.10799608022675011,0.1267908983004391,0.14205178556878717,0.7748379343986543,0.9902533077987383,0.1987613274718305,0.553507841970455,0.3863548659504824,0.2805064872736125,0.7954886989451981,0.06095738607180423,0.9861605337957735,0.10491948171074283,0.39316514229848565,0.24293182903435717,0.4121846112888341,0.9746778847556222,0.9808736899146093];
	    let y = vec![0.8269908634779264,0.1341245632257153,0.36817560369462443,0.37327386206842383,0.13114419288183143,0.7941590267644744,0.6465186587678836,0.8183916994808218,0.3299092674087136,0.07101189562136301,0.2660964255684892,0.5224038893122126,0.7511641040790384,0.0023612039710234622,0.8616060190308653,0.5117898943977103,0.4751182844498122,0.17741729612744273,0.17688627442714433,0.00013683920542606476,0.18725706769130002,0.8043066961891622,0.5852604162573906,0.1488470479765791,0.5867307360823736,0.10521822871084052,0.8066445078165491,0.3058603040987884,0.23151145406514406,0.31978171528299504,0.11933632368860081,0.11590084963614522,0.7891349256401294,0.7309677508444682,0.8781671822670462,0.7138737432298208,0.10278915078956452,0.9644693654802139,0.9283991559778848,0.6608807661427184,0.11462169062694394,0.06877660243817207,0.8436285930482854,0.48962493400693274,0.47038292763284506,0.023664441189085728,0.8620503599212896,0.7721069685272418,0.5479096382589506,0.971790252792998,0.24360175751218993,0.26807471406113026,0.804895196032964,0.1547176253634368,0.564181967466268,0.42506599249126187,0.7416170008709008,0.3896494478545687,0.9758645574408376,0.7687772470903496,0.5347647531262492,0.4237986810944332,0.7923981060158103,0.6334592698308662,0.5238611428985351,0.26796060523270504,0.8423604601895602,0.8575740244491566,0.5360257507657179,0.9339021421880151,0.29072466484389525,0.6107620262948346,0.8170702216372809,0.3989845785212556,0.011135554324898989,0.5571733142283533,0.1276095808454497,0.34888370774417343,0.7739720969784181,0.5248876455471095,0.5298316106280736,0.7053182610600685,0.4752996667221474,0.7958944556164012,0.9901590007483091,0.14553442288965013,0.030769756892211064,0.5649354170573991,0.16517569971659163,0.6230637485774386,0.5420661218963805,0.32985296267582365,0.11771834410210813,0.532867435471418,0.8937196071480589,0.12260398803662642,0.4411047153178712,0.5163832515320017,0.859889251361455,0.5908187230243589,0.1721111570781334,0.22666038289253088,0.7545648611329578,0.25880580251782204,0.8111082175132114,0.7198933642584259,0.18706422907377374,0.9229357558336163,0.566271271474388,0.758738276759511,0.8223365251944003,0.4030339212003585,0.39373045030711906,0.3995008322478565,0.7806182803247516,0.6216166901528236,0.3508905488343621,0.011895748915819904,0.8794531875177103,0.9261821608150578,0.0754009085848586,0.1779692307349584,0.3239167213113473,0.5062985396443465,0.19201960135869756,0.12431340353166831,0.4989492557325569,0.3221648919984631,0.4110443859313645,0.22387897638708354,0.7577274135515305,0.7178967565038648,0.26916053166235476,0.0809469785037471,0.9963647991963609,0.5669409105730997,0.39576006119836526,0.9228412831758741,0.5052640930361719,0.7068197827967209,0.0907914760238635,0.20979531240433458,0.47351824171216317,0.36690252404302226,0.14287049549484054,0.9471912179598799,0.5502709755458655,0.10057968471441481,0.2901104927504058,0.4860941623430385,0.33246420748727445,0.22030849569399347,0.3610625714096699,0.8282467132489473,0.75422395414173,0.7549939948560773,0.6378571362337919,0.778516828391784,0.8613502733900344,0.93733019086879,0.8416190059064032,0.8462578556696229,0.4936595659924259,0.47003991806994994,0.22131575580260587,0.6963404945817562,0.7937229315254419,0.8519821229790269,0.4694741919440891,0.6713367616526028,0.36489719016137545,0.5704310872870387,0.3502003213666749,0.5610990777602832,0.8759186741665309,0.4494058727799245,0.5854401200200203,0.7937973202705483,0.4996819706912544,0.8902233734976411,0.756936784992401,0.957334050778313,0.5587631304783778,0.01606770159039783,0.6569043253427237,0.08895612202749603,0.611625982322751,0.2564316234701798,0.8248875613283128,0.16432102520905068,0.4685335601975611,0.7317162504786711,0.8498673131113975,0.31880125495017775,0.18594680684108367,0.34619133259708945,0.805853053958839,0.6507529660623583,0.9002941689424903,0.045666982470530915];
	    let r : f64 = -0.02381909547738693;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_18() {
	let x = vec![0.726956429424981,0.09022210312048373,0.04625915833146366,0.8496879475533334,0.5686259322624786,0.19226440092807362,0.10306441870264704,0.8469168541706975,0.17063215655643915,0.7896661827149708,0.08175185200744284,0.15060975707874802,0.922028275104153,0.9145212307982573,0.8671440165938138,0.823387651678312,0.6748613770674293,0.2523845651128096,0.5324541552368521,0.0527504848716579,0.9284746373712295,0.12710979823818402,0.1407630331605294,0.45134271661590597,0.16795781228002493,0.03032901926662912,0.7776606443018172,0.6752544843495086,0.8401467594800923,0.04884603276226818,0.9361474562580041,0.24930597774378394,0.5028366701004792,0.2347616278625887,0.740081781484819,0.7171005192603351,0.8970197476189085,0.9517826444408838,0.24522174217336223,0.9840374026960124,0.1299715382268446,0.8317890465631911,0.7133833578234311,0.4076597377747785,0.42145813531174625,0.6663904414761851,0.3470037346378081,0.37496049086117167,0.5172380252736403,0.8632277084660015,0.17253126712936306,0.5469824965463294,0.9601759059096936,0.9110637387619991,0.3354501389953982,0.6980934319375665,0.4165870835070393,0.8965750280996225,0.003922877812988723,0.1021531599383505,0.23520143162011198,0.36285993347625156,0.7333457082143577,0.9225386897988913,0.22333256804588142,0.9079471396859855,0.9731954602597166,0.9190092516687596,0.43430691862679305,0.6128383514796433,0.9248942465321567,0.437163550762791,0.22281834718102211,0.04966976586042815,0.2923433889301005,0.8699945456011435,0.7811074465605082,0.03495679602664825,0.2742736703665124,0.29524777181710926,0.7762048711373891,0.7141510849211792,0.26076414172775586,0.593046306576667,0.769114520189628,0.8244832356027367,0.38947842331704263,0.9913071874261877,0.9765615209329312,0.9049353382054847,0.12221127816500732,0.08143527517765481,0.2919321184857162,0.3870846057534175,0.2200454691892748,0.6745390964730584,0.95380442935014,0.11228061320598792,0.425548723112265,0.19922556458955165,0.6004730213371797,0.7926516640305252,0.08160696624713237,0.9559745401241351,0.346490950794324,0.05731029587834857,0.34161299304829196,0.41842803968514575,0.31713018053079467,0.8424993825921068,0.6163704931880724,0.215286684097048,0.9632983999253206,0.1296894668214008,0.4842065415729363,0.000324169813652353,0.2265777386118577,0.5617546323942032,0.05221023661239255,0.9462905490260884,0.34136140775568147,0.1707179217511129,0.18352981369469046,0.8166601828738118,0.3157002376524465,0.1340151572237961,0.1250080542784101,0.7502268159642541,0.35888622307315443,0.8967672065382863,0.8461950840145027,0.04361045744944414,0.7370736467125358,0.6304046357154033,0.6349495160980175,0.301080899359767,0.10051210867130567,0.7563051471887949,0.7355710408951747,0.6733724619818671,0.14154998541335284,0.19336848640561155,0.08467494635397455,0.19051111287892986,0.1135421877473044,0.054793268357246516,0.03767115872945648,0.5366219511593712,0.26587732975795353,0.7472484869433863,0.47315198861634933,0.31347606168018183,0.5149999405066397,0.881332662213815,0.9119110425758492,0.01703038536647894,0.3370360256326391,0.3781492627356049,0.42492388139011883,0.6659069601674226,0.436518769162355,0.6989422691426502,0.5964985616917721,0.15122152954624002,0.9506637230113126,0.6968601828878265,0.2539067784937552,0.10540526055728106,0.03276026668223564,0.89149930986805,0.7234043385160991,0.30289509676589077,0.10304646296845676,0.018966507773748198,0.3189590858299135,0.16758454882122842,0.016195278150750503,0.2675579159390743,0.3038119740166507,0.40642783532390725,0.9553515175308734,0.47554409426914346,0.7696159781095518,0.6466268472749483,0.8792638000936123,0.4027409766071244,0.9091675191713556,0.9727684272644372,0.14688519876157125,0.3977671915582801,0.35795730955468563,0.21505104117609142,0.722696515407418,0.5480838056733223,0.8434711867400775,0.9919236722017771,0.26852956797013516,0.32920619989154754,0.4830991989739363,0.696758479724886];
	    let y = vec![0.5418186513763649,0.5253698868623826,0.5853820070648043,0.1649169191549853,0.16650513536194844,0.6600725628266916,0.8060406198593039,0.24659511241631515,0.7354764256548013,0.9200995659980878,0.4169601152741056,0.5626643113110725,0.2382477994888904,0.048053376429756045,0.7620358816871792,0.8189556901592782,0.5391999826233627,0.9157450244915265,0.5555460068439164,0.8267573815278344,0.38944891020105876,0.705510164663627,0.32240102769181544,0.33609718088482265,0.554140359637572,0.3371840102363408,0.017849423852632107,0.11871820142871448,0.41921055200205704,0.8094196272468286,0.35740583536377735,0.04565423539366342,0.9229856883176677,0.5894474642191576,0.38993729834031776,0.21684761515609274,0.7312759247189936,0.4117014261848795,0.7633701793372338,0.3024127790426634,0.23968080951608772,0.5715093649265359,0.28373514115709586,0.19934401060576357,0.3846477224264201,0.8328420014288291,0.7328563233365432,0.6560611140831807,0.32319731229314486,0.4993504718378814,0.15458132579495376,0.6423744891254538,0.8592376820065128,0.11745554918455314,0.5639806942230378,0.18043900629427545,0.9782739351623627,0.44784976911963514,0.3179439423547227,0.7241052103864383,0.46832076784800303,0.8942217254514703,0.5201054373746808,0.43583307221937884,0.7779966634579154,0.7388533202285399,0.46590248613606566,0.68004795833786,0.7934506536934245,0.11317700170874267,0.3662032021512712,0.7050114946970051,0.3055623136104013,0.19278750605414086,0.16492831508989603,0.16297037486877664,0.9693712759571954,0.1483938507779503,0.6233109700677208,0.9799274252347873,0.29450354561086034,0.8919736528426278,0.18496958596539304,0.35480309197948723,0.36968149604192446,0.316370359121233,0.28919959336629486,0.5384077179485364,0.7782032446946859,0.9820177343989737,0.37922408265707963,0.499815507026103,0.5366642893334024,0.6877825778372324,0.2921604081848015,0.5179839955544987,0.496930179117824,0.2438050370167889,0.3688968410800728,0.15690585318543504,0.3494207968414592,0.6722712651711871,0.10672631221727158,0.655776526964252,0.3883303030909879,0.16384434826223437,0.562562513392412,0.35340208103357673,0.5398930312844341,0.8172696223324942,0.5107213108901066,0.42947471861784636,0.9311385180980466,0.7070346154690818,0.6522006791856236,0.8808346464596635,0.6572011943618876,0.7594120894693551,0.884722791651984,0.5171172139565546,0.33331344257621887,0.260228967229687,0.9981547345149971,0.40909784866617227,0.046249434140905765,0.15641502555374798,0.6396942634135993,0.0884246322408162,0.09924848811974263,0.004106130394887719,0.1695986616460443,0.04244857964547788,0.8188335225291185,0.273492119531892,0.34005311412024763,0.27352130483988735,0.4237235385553386,0.9012883447177132,0.31493783691238497,0.7119856720221277,0.23260499523832345,0.5568673815126599,0.1677614564209673,0.20107737100152245,0.7694953919127829,0.8709783823138517,0.3611482972521075,0.8984523213111969,0.42694363378222244,0.1587946204923838,0.6591039315468766,0.2423610069993386,0.5849777477171056,0.7284729879283802,0.7835431171607746,0.7757895979821869,0.8717286850692887,0.9743967110979503,0.3805545947241491,0.3235763624572886,0.06591749450245754,0.22036725904629062,0.9170155340327746,0.24427794485576926,0.1204352366031246,0.3750972777279631,0.7192646972075025,0.022910906157545763,0.5800454747061458,0.22777340803650514,0.11638125460335424,0.5103419815045372,0.3311194846068154,0.7606990174746111,0.8442899080122819,0.16424153137943742,0.2009277093003481,0.4935104466990603,0.491169365778359,0.25488059841707467,0.43021282878519496,0.03901391291401879,0.23371713835060903,0.30267667013666766,0.8903552398610962,0.9271606642110076,0.4727359323973107,0.406654925348644,0.7081680042049876,0.233909615034402,0.2913860642001035,0.02304494716489547,0.9903218759984347,0.35413852152655745,0.7805400819808607,0.07484662008561915,0.07226309293486044,0.07285387689050782,0.0008773070359344715,0.647181265506614];
	    let r : f64 = 0.013768844221105527;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}


#[test]
fn kendall_float_200_19() {
	let x = vec![0.11501910775769908,0.832972182418854,0.9208483958762144,0.8314477732169261,0.6362261329090948,0.3803701637877367,0.43158648208574757,0.7249006051294834,0.6077275142392777,0.7649926956468304,0.3935469731022473,0.024866578029207553,0.609220593882892,0.3739184410425974,0.9356195751796942,0.41031964535237064,0.6233856702136527,0.5126071769764414,0.6498132854523148,0.7505316261568884,0.05216090005320251,0.3225748729524668,0.7549795682939513,0.12782579546002482,0.5983354252652351,0.8290442137532357,0.029245351767434924,0.6477433310729438,0.5353493778328923,0.6742216595645047,0.19059989277071787,0.6203313245329087,0.6566990806991745,0.41162069220090536,0.8098020677920393,0.8924293270839171,0.1568256247569032,0.6023041361964957,0.6892080231017289,0.9529637130187549,0.25699539018554374,0.6239247920255193,0.13340540154295977,0.09760942908638748,0.7683602975172423,0.5806273424811215,0.6197003448589522,0.5504169952116078,0.5067858116202509,0.779807277540421,0.6456852436324397,0.8552191569698229,0.5622520873296206,0.6879014972052261,0.3353987032742889,0.41990040382436,0.3827101575353673,0.7242462726165566,0.3748837133833033,0.18023627581104662,0.9875121413266605,0.4763656678121031,0.4472632978619613,0.6209655725315252,0.09825936503661858,0.23378548513887853,0.7240647337710752,0.9494674459238206,0.44388120449892254,0.8295123893625982,0.09985819533797513,0.6721166956136577,0.016185763902438755,0.9904569519002842,0.21230869597190194,0.36924227546944455,0.02921066471016598,0.5977073428481572,0.30106003103188717,0.2787867315618946,0.49857005295344603,0.8111543364305251,0.382529644375465,0.8632276553903897,0.4107589948243471,0.10288105560468375,0.4544806126381845,0.0207476977983424,0.14463534328237115,0.7201362696848015,0.6499223564546676,0.0660137585343541,0.22932503633024592,0.6687644821053663,0.15355423732271212,0.32379939954631953,0.17686548501118382,0.6126466257355332,0.11822086584390912,0.41916828031077547,0.3487910955721918,0.6575701246750342,0.18012087307926328,0.3536011488841557,0.6716716216110856,0.6272708180184717,0.464101686596867,0.7337860222591954,0.10327526116742425,0.07343317115390768,0.10830747786501704,0.7425341884888808,0.5642822144736306,0.5871883103244814,0.6161245580176884,0.675937239239879,0.7951171201903051,0.6997119609753827,0.8824341074825381,0.23912345502107757,0.4904078986880598,0.7320336356691856,0.47716264991356205,0.5218606462228667,0.7357807458057707,0.09339635945269942,0.7082575085376763,0.7085980838907443,0.7704027762090959,0.47072538998169733,0.22221281725077124,0.07768708955207448,0.8937715825198499,0.3085827020694968,0.566747665751288,0.863396216681372,0.9571640064645467,0.6351597840251467,0.25879697289365866,0.8695705596112874,0.7065928983594721,0.9319871446888496,0.2996872584886897,0.15500238799788468,0.4220070136663232,0.45929020255368735,0.8801100381674912,0.38786804597800606,0.29353130145909345,0.23224570565701708,0.2804479335773614,0.7979000625007621,0.9148521213349254,0.4081062173092346,0.20157438065915267,0.8202224259731259,0.6455247095328747,0.05643080508693177,0.3200170899301503,0.8661672956675978,0.8376984826544219,0.12607671932805786,0.9977779139472743,0.28608554569108435,0.9735313614474643,0.45380145024580343,0.6210783405237547,0.6199749042167244,0.4086864076913024,0.512385584315871,0.8630313492270619,0.47414304921185446,0.13472324271254843,0.6524965355335682,0.5671489382329594,0.14431437620463516,0.3894724104416185,0.5854592693531996,0.5921426936791552,0.6240864662927608,0.9738925294047045,0.7653275789690683,0.2661921045442214,0.12173292772325617,0.32390564751050366,0.7557926360774283,0.46953753285970223,0.4377388070997682,0.6485988773513214,0.14927641903185296,0.577501521858622,0.3634547548156839,0.7945652437717646,0.06619609253150205,0.12731261174905528,0.8629594822868335,0.05567962979933072,0.08169028525744004,0.03058910853065766,0.5408136151993593];
	    let y = vec![0.432710550291284,0.7614051548926389,0.20763863716313768,0.8414790832421242,0.6318038189338208,0.3675346865544027,0.5276323469953063,0.4099239180275631,0.5138026110165028,0.24657108146881834,0.059952663315646415,0.615533882024845,0.5518241297029284,0.4768955425709629,0.4098498613857797,0.05603714303131746,0.9450728250840997,0.7157853987523112,0.5103499726439169,0.2015953748909054,0.8625800997400471,0.146617826067442,0.5905290665078624,0.5859882609045137,0.867607245356199,0.40266944209546507,0.1136711429709889,0.7100805015410663,0.9605733621740112,0.20237117383145142,0.09690920435645567,0.8036736323483624,0.04025035411103961,0.1727486719282727,0.27615261188966633,0.468206797735756,0.1762186861256042,0.8885740940154825,0.8008716994573042,0.8997701171528157,0.5249511604478589,0.9175872495709664,0.9450687970258566,0.9351199302490735,0.9223580345031821,0.860170456135313,0.7699894347054687,0.6680607110228097,0.18018627423067068,0.20134052304618955,0.7494558744353421,0.5037452521644766,0.6740264463029563,0.07925436278954479,0.5308058924896953,0.5029190045735393,0.9883657381635252,0.9456165741147345,0.7126067892146692,0.6640993798318077,0.8462333684969148,0.33058133393794553,0.021694176922602115,0.16984940672780913,0.9678311348679478,0.2771509860246296,0.16187730019730173,0.9986028977608788,0.006703179453777297,0.26279176296079787,0.7608877414369138,0.8401631793887265,0.9386972715558921,0.0009776122086646577,0.41669516208489366,0.8500089701824426,0.0639129009925955,0.5913236459898531,0.7125154141421111,0.6543658711653669,0.7932806715640858,0.7776964754801649,0.717793967656228,0.53791400743052,0.787757612937463,0.31622867742972727,0.4070427536771162,0.24314732727154553,0.22916481008990974,0.7855061296952824,0.4480927795069143,0.13528778573160305,0.9157950415158733,0.6627524173679132,0.17870486221742432,0.547111435833942,0.9297318091410703,0.5268918540258674,0.6311452462825087,0.9891289044673492,0.5921232244855119,0.7678993225514894,0.5402617414592067,0.5809440573423739,0.32772089365664414,0.44994533162686723,0.5734978408777275,0.076433768228508,0.5198839131457846,0.7039321377215447,0.2189421071004286,0.3917649604633272,0.10124393968356538,0.04841331995936016,0.809038932560398,0.20281237951148634,0.7713418691263235,0.0747034166298336,0.32892499681580356,0.06721324928676897,0.2106483129816653,0.3348875578922973,0.5755224494944822,0.555248665081923,0.017204403694299097,0.42141200660793854,0.6887027815866048,0.07995814187715322,0.8514736871423124,0.4590269196931619,0.5540028413775583,0.38787986382430273,0.4897873003618701,0.5576169105690231,0.3461970062673785,0.5542012698059082,0.15166971193438117,0.3773672280737107,0.4428752661326494,0.10729269735451807,0.7767431592426817,0.45855752363150226,0.8874463549486934,0.3284092476993399,0.33831741053937125,0.58979475501407,0.516192303162436,0.8240144982128912,0.9086453090712006,0.6721624728281752,0.5693182162119493,0.9400489233857204,0.6995125131753126,0.9545570496667531,0.8685672424806637,0.8931341452355365,0.8141633208817138,0.6170475129751642,0.5477720773847387,0.26959322159849064,0.6442068593945117,0.1403482529797071,0.6185318265795616,0.8241900473521873,0.9909963847887526,0.25161139497699325,0.29556686011584554,0.23577327735217846,0.23234461996031386,0.5202348342966566,0.8393839330936685,0.9298650251208885,0.30564336470883213,0.8102183018404535,0.39850224194982664,0.4623573043232504,0.9180108839969289,0.35603566353201854,0.4457988221479967,0.47887769367934796,0.040671595367435254,0.5723215230128128,0.7473447569365309,0.5120648745333279,0.42496492867019575,0.16922665582419072,0.7674473841651213,0.3103100608938426,0.834430654696224,0.028777986242469522,0.25505495254977506,0.775957767212196,0.12173578011247121,0.733543164706337,0.3616505457129554,0.38789586156581435,0.9123814844425452,0.5775993300629761,0.7124700121078322,0.41412349562826867];
	    let r : f64 = -0.023115577889447233;
	    let result = kendalltau(&x,&y);
	    assert!((result.is_nan() && r.is_nan()) || (result - r).abs() <= 1e-7);
}





